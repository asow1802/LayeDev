(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[186],{2080:function(e,t,n){"use strict";n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"r",function(){return _}),n.d(t,"e",function(){return h});var a=n(3),i=n(2215),r=n(2283),o=n(2238),s=n(2176),c=(null===r.e||void 0===r.e?void 0:r.e.mpcDomain)||"https://my.microsoftpersonalcontent.com",d="UnAuth"===(null===r.e||void 0===r.e?void 0:r.e.hcid),l=!d&&(null===r.e||void 0===r.e?void 0:r.e.hcid)||"";function u(e){var t=e.apiVersion,n=e.driveId,r=e.includeViewerId,o=void 0!==r&&r,s=e.migrationState,c=void 0!==s&&s;return Object(a.lo)(a.V)&&(n&&"me"!==n||(n=l),Object(i.e)(n)||c)?("v1.0"===t&&(t="v2.0"),o?m(t):p(t)):f(t)}function f(e){void 0===e&&(e="v1.0");var t=_(),n=1===Object(o.e)()?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function p(e){return void 0===e&&(e="v2.0"),"".concat(c,"/_api/").concat(e)}function m(e){return void 0===e&&(e="v2.0"),"".concat(c,"/personal/").concat(l,"/_api/").concat(e)}function _(){switch(Object(o.e)()){case 2:return"soak2.test.";case 3:return"soak3.test.";case 1:return"newapi.dev.";default:return""}}function h(e){var t,n,r,o=null!==(r=null!==(n=null!==(t=null==e?void 0:e.driveId)&&void 0!==t?t:Object(s.e)(null==e?void 0:e.cid))&&void 0!==n?n:Object(s.e)(l||void 0))&&void 0!==r?r:"me";return Object(a.lo)(a.V)&&!Object(a.lo)(a.z)&&(!Object(i.e)(l)||o&&0===o.indexOf("b!")||(o="me")),o}},2114:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},2156:function(e,t,n){"use strict";var a=n(2390);t.e=a.e},2165:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(11),i=n(954),r=n(2114),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},2176:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=!n(13).e.isActivated("682BEBB8-F1C8-486D-8B3F-0C75B53F6DC3","12/01/2022","Skip convert if driveId/cid is from sharepoint");function i(e){return a&&new RegExp("^b!").test(e)?e:e?e.replace(/^0+/,"").toLowerCase():void 0}},2215:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n(157),i=n(88),r=n(2176),o=new a.e("migrationStore",i.e.local);function s(e){if(e.indexOf("b!")>=0)return!0;e=Object(r.e)(e);var t=o.getValue(e);if(t){if(1===t.version)return t.isMigrated;o.remove(e)}return!1}function c(e,t){if(void 0===t&&(t=!0),e=Object(r.e)(e),t){var n={version:1,isMigrated:t};o.setValue(e,n)}else o.remove(e)}},2238:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=window.FilesConfig&&window.FilesConfig.env;function i(){switch(a&&a.toLowerCase()){case"soak3":return 3;case"soak2":return 2;case"dev":return 1;default:return 0}}},2283:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return c});var a=n(71),i=n(11),r=window&&window.FilesConfig||{};r.skyDrivePickerOAuth||(r.skyDrivePickerOAuth="oauth"),!r.oauthToken&&window&&(r.oauthToken=new a.t(window.location.href).getQueryParameter("access_token"));var o=r,s=window&&window.$Config||{},c=(new i.t({name:"".concat("Config",".files"),factory:new i.e(o)}),new i.t({name:"".concat("Config",".config"),factory:new i.e(s)}))},2390:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Owner:0,View:1,Edit:2,Submitter:3,CoOwner:4,None:5,Review:6,Custom:7}},2609:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(33),r=n(2034),o=n(201),s=n(157),c=n(88),d=n(134),l=n(356),u=n(2165),f=n(2114),p=n(206),m="CoachmarkTearDropSeen",_={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._dataStore=new s.e("CoachmarkProvider",c.e.session),a._currentCampaign=a.createObservable(_),a._isVisible=a.createObservable(!1),a._navigation=n.navigation,a._firstRunExperienceStatus=n.firstRunExperienceStatus,a._currentTeachingBubble=a.createObservable({campaign:a._currentCampaign,isVisible:a._isVisible}),a._navigation.viewParams.resetAllBubbles&&a._dataStore.remove(m);var i=a.resources.consume(p.e);return a._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return a.resources.consume(l.I)}),a}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0}),t.prototype.hideCampaign=function(){this._isVisible(!1),this._currentCampaign(_)},t.prototype.setCampaign=function(e){var t=this;if(!e)return this._currentCampaign(_),void this._isVisible(!1);if(this._firstRunExperienceStatus.get()!==f.e.visible){var n="".concat(e.name).concat(m);this._dataStore.getValue(m)||this._teachingBubbleProviderPromise.then(function(a){a&&a.shouldBubbleBeAdded(e,!1).then(function(a){a&&(t._currentCampaign(e),t._isVisible(!0),t._dataStore.setValue(n,!0))})})}},t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{navigation:d.e,firstRunExperienceStatus:u.e}),t}(r.n),b=Object(o.r)("CoachmarkProvider",h)},3776:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(11).t)("imageEditorDataSource")},4971:function(e,t,n){"use strict";n.r(t),n.d(t,"OpenInImageEditorHandler",function(){return E});var a=n(0),i=n(186),r=n(2402),o=n(2034),s=n(109),c=n(105),d=n(2056),l=n(2140),u=n(32),f=n(158),p=n(142),m=n(3776),_=n(2389),h=n(33),b=n(1308),g=n(708),v=n(2609),y=n(236),S=n(2156),D=n(2215),I=n(2080),x={jpg:"image/jpg",jpeg:"image/jpeg"},C={png:"image/png"},O={heic:"image/heic",heif:"image/heif"},w={bmp:"image/bmp",emf:"image/emf",gif:"image/gif",tiff:"image/tiff",tif:"image/tif",webp:"image/webp",wmf:"image/wmf"},E=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(d.e))({allowMultiSelect:!1,canFallback:!0}),n._isOneDriveWinApp=Object(f.e)(),n._urlDataSource=n.resources.consume(c.he),n._itemCommandHelper=n.resources.consume(l.t),n._platformDetection=n.resources.consume(i.e),n._identityDataSource=n.resources.consume(c.D),n._coachmarkProvider=n.resources.consume(v.e.optional),n._imageEditorDataSource=n.resources.consume(m.e.optional),n.state=n.createPureComputed(n._computeState),n}return Object(a.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){if(!Object(h.isFeatureEnabled)(h.HideEditPhoto)&&!0===Object(D.e)(I.s))return!1;if(!this._imageEditorDataSource)return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,_.s),n=this._isSupportedFileType(e),a=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(a.key),r=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(h.isFeatureEnabled)(h.EnableEditUtilityControlMobile))&&!!e&&e.sharingRole===S.e.Owner&&r!==u.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&e.itemStatus!==p.t.ConditionalAccessViewOnly&&e.itemStatus!==p.t.ConditionalAccessBlocked&&this._imageEditorDataSource.canSave({item:e});return o&&Object(h.isFeatureEnabled)(h.EnableEditControlTeachingBubble)&&!Object(h.isFeatureEnabled)(h.MentionTeachingUIAA)&&!Object(h.isFeatureEnabled)(h.EnableExpirationSectionForTMR)&&this._coachmarkProvider.setCampaign(g.PHOTO_EDIT),o},t.prototype._shouldEnableImageEditor=function(){if(Object(h.isFeatureEnabled)(h.EnableEditUtilityControl))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&b.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:b.e.v2};return new b.t(t,h.EnableEditControlExperimentAB).isOn()}return!1},t.prototype._isSupportedFileType=function(e){if(!function(e){return Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&k.forEach(function(e){L.push(e),L.push(e.toUpperCase())}),Object(h.isFeatureEnabled)(h.EnableEditPNG)&&(L.push(".png"),L.push(".PNG")),Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&(L.push(".heic"),L.push(".heif"),L.push(".HEIC"),L.push(".HEIF")),L.some(function(t){return e.toLowerCase()===t})}(e.extension||""))return!1;if(e&&e.extension&&(e.type===y.e.File||e.type===y.e.Media)){var t=e.extension;if(t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase(),x.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditPNG)&&C.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditHEIC)&&O.hasOwnProperty(t))return!0;if(Object(h.isFeatureEnabled)(h.EnableEditAllImageFormats)&&w.hasOwnProperty(t))return!0}return!1},t}(o.n),A=Object(r.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return s.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e(187)]).then(n.bind(null,4751)))}}},handlerType:E}),L=[".jpg",".jpeg",".JPG",".JPEG"],k=[".bmp",".emf",".gif",".tiff",".tif",".webp",".wmf"];t.default=A}}]);