(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[120],{2413:function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(109),r=n(11),o=n(2034),s=n(356),c=n(1327),d=n(13),l=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a._getModule=t.getModule,a._path=t.path,a._getExecutorParams=t.getExecutorParams,d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")&&(a._bundleLoader=a.resources.consume(s.e),a._bundleLoader.queueLoad(a._path,a._getModule).done()),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(a){return"function"!=typeof a?i.n.wrapError(new Error("Cannot create action from ".concat(a,": ").concat(n._path))):i.n.as(n._getExecutorParams()).then(function(r){var o=new(n.resources.injected(a))(r);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: ".concat(this._path)))},t.prototype._loadExecutorType=function(){if(d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")){var e=this._bundleLoader.loadNow(this._path,this._getModule);return this._loadExecutorType=function(){return e},e}return this._getModule().then(function(e){return Object(c.e)(e)})},t.dependencies=Object(a.__assign)({},o.n.dependencies),t}(o.n);t.e=l;var u=new r.t({name:"ExecutorLoader",factory:{dependencies:l.dependencies,create:function(e){return{instance:function(t){function n(n){return t.call(this,n,e)||this}return Object(a.__extends)(n,t),n}(l)}}}})},2421:function(e,t,n){"use strict";var a=n(0),i=n(2413),r=function(e){function t(t){void 0===t&&(t={});var n,a=e.call(this,t)||this;return n=a.useGlobalResources()?a.resources.consume(i.t):a.managed(i.e),a._loader=new n({path:a.getExecutorPath(),getModule:a.getModuleFactory(),getExecutorParams:function(){return a.selectionHelper.resolveSelection().then(function(e){return a.getExecutorParameters({selection:e})})}}),a}return Object(a.__extends)(t,e),t.prototype.useGlobalResources=function(){return!1},t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)},t}(n(2539).e);t.e=r},2539:function(e,t,n){"use strict";var a=n(0),i=n(2047),r=n(2140),o=n(2056),s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.itemCommandHelper=new(n.managed(r.e)),n.selectionHelper=new(n.child(o.e))(Object(a.__assign)(Object(a.__assign)({},n.getSelectionOptions(t)),{overrideItem:t.item})),n}return Object(a.__extends)(t,e),t.prototype.getSelectionOptions=function(e){return void 0===e&&(e={}),{}},t}(i.e);t.e=s},2806:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(2241),i=new a.e("upload"),r=new a.e("download"),o=new a.e("sync")},3584:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(830),i=n(177),r=n(306),o=n(14);function s(e,t,n){return!(e.type===i.t.OneNote||e.list||e.subsite||(!r.e.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||n||!e.urls[a.e.downloadAsZip]||!e.urls[a.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)&&(e.isRootFolder||!t||t&&t.list&&t.list.templateType===o.n.webPageLibrary||e.type!==i.t.File&&e.type!==i.t.Media&&e.type!==i.t.Unknown))}},4279:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(109),r=n(2421),o=n(334),s=n(33),c=n(2054),d=n(236),l=n(830),u=n(105),f=n(142),p=n(3584),m=n(2140),_=n(2806),h=n(2319),b=n(31),g=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Download",n._urlDataSource=n.resources.consume(u.he),n._currentItem=n.resources.consume(o.r),n._itemParentHelper=n.resources.consume(c.e),n._itemCommandHelper=n.resources.consume(m.t),n}return Object(a.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DownloadExecutor"},t.prototype.getModuleFactory=function(){return function(){return i.n.resolve(n.e(121).then(n.bind(null,4389)))}},t.prototype.getSelectionOptions=function(){var e=Object(s.isFeatureEnabled)(s.DownloadAsZip);return{allowMultiSelect:e,canFallback:e}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}},t.prototype.onIsAvailable=function(){var e=this,t=this._currentItem();if(!t)return!1;var n=this._urlDataSource.getKeyParams(t.key),a=this._urlDataSource.getQueryType(n);if(this._urlDataSource.isRecycleBin(a))return!1;var i=this.selectionHelper.selection(),r=i&&i.length>1;if(r&&(!Object(s.isFeatureEnabled)(s.DownloadAsZip)||i[0]&&i[0]&&i[0].peek()&&!i[0].peek().urls[l.t.itemUrl]||!i[0].peek().urls[l.t.downloadAsZip]))return!1;var o=i.filter(function(t){return t&&e._canDownloadItem(t)}),c=o.length,u=o.filter(function(e){return e&&e.peek().urls[l.t.itemUrl]&&e.peek().urls[l.t.itemUrl]});return!(r&&u&&c>u.length)&&(c>1||c&&(!!this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(o[0].peek(),"list"))||o[0].peek().type===d.e.Folder))},t.prototype._canDownloadItem=function(e){var t=e();if(t.itemStatus===f.t.ConditionalAccessBlocked||t.itemStatus===f.t.ConditionalAccessViewOnly)return!1;if(t.type===d.e.OneNote)return!1;if(!b.e.hasItemPermission(t,b.e.openItems))return!1;var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return this._itemCommandHelper.isCommandSupported(t,_.e)&&p.e(Object(h.n)(t),Object(h.n)(n),!1)},t}(r.e);t.default=g}}]);