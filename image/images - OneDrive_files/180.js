(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[180],{4396:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(109),r=n(2074),o=n(2107),s=n(1172),c=n(2191),d=n(625),l=n(2121),u=n(54),f=n(185);Object(f.n)([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}html[dir=ltr] input.od-isSpam{margin-right:5px}html[dir=rtl] input.od-isSpam{margin-left:5px}"}]);var p=n(2036),m=n(3843),_=n(236),h=function(e){function t(t){var n=e.call(this,{})||this;n.allowSpam=!!t.isSpam,n.isSpam=t.isSpam,n.status=t.status,n.hasError=t.hasError;var a=t.selection;return t.hasError()?n.subText="":t.removeAccess?n.subText=a.length>1?m.f:a[0].type===_.e.Folder?m.c:m.i:n.subText=a.length>1?m.p:a[0].type===_.e.Folder?m.d:m.r,n.spamText=a.length>1?m.u:a[0].type===_.e.Folder?m.s:m.a,n}return Object(a.__extends)(t,e),t}(p.e),b=n(2037).e({tagName:"ms-remove-from-sharedlist",template:'<div class="od-RemoveFromSharedList"><div class="od-RemoveFromSharedList-SubText" data-bind="text:subText"></div><span data-bind="if:allowSpam"><input id="RemoveFromSharedList-isSpam" type="checkbox" name="isSpam" class="od-isSpam" data-bind="checked:isSpam"><label for="RemoveFromSharedList-isSpam" class="spamText" data-bind="text:spamText"></label></span><div class="od-RemoveFromSharedList-Status" data-bind="text:status,css:{\'od-RemoveFromSharedList-Status--error\':hasError}"></div></div>',viewModel:h,synchronous:!0}),g=n(17),v=n(32),y=n(33),S=n(2052),D=n(623),I=n(1836),x=n(105),C=n(2056),O=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n.resources;return n.name="RemoveFromSharedList",n._operationProvider=a.consume(o.resourceKey),n._urlDataSource=a.consume(x.he),n._dialogProvider=a.consume(r.e),n._itemProvider=a.consume(I.resourceKey),n._engagement=a.consume(D.e),n._itemSelectionHelper=new(n.child(C.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Object(y.isFeatureEnabled)(y.RemoveFromSharedList))return!1;var e=this._itemSelectionHelper.currentItem();if(!this._urlDataSource.isCurrentQuery(v.e.SharedWithMe,this._urlDataSource.getKeyParams(e.key)))return!1;var t=this._itemSelectionHelper.firstItem();return!(!t||t.queryType!==v.e.SharedWithMe)},t.prototype.onExecute=function(){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t,n,r,o,c,d,f=this;return Object(a.__generator)(this,function(p){switch(p.label){case 0:return e=this.observables,[4,this._itemSelectionHelper.resolveSelection()];case 1:return t=p.sent(),n=e.create(""),r=e.create(!1),o=e.create(!0),c=function(e){return Object(a.__awaiter)(f,void 0,i.n,function(){return Object(a.__generator)(this,function(t){return r(!0),n(e),[2,1]})})},t.length>14&&(c(g.format(m.n,14)),o(!1),this._engagement.logData({name:"RemoveFromSharedList.TooManyItems",extraData:{itemCount:t.length}})),d=this._dialogProvider.requestDialog({title:t.length>1?m.m:t[0].type===_.e.File||t[0].type===_.e.Media?m.o:m.l,component:{name:b.tagName,params:{isSpam:null,selection:t,removeAccess:!1,hasError:r,status:n}},actions:[{name:m.e,execute:function(){return Object(a.__awaiter)(f,void 0,i.n,function(){var e,n,i,r,o=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e=new l.e,n=t.map(function(t){return o._operationProvider.register({name:t.displayName,type:s.e.removeFromSharedList,batch:e})}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._itemProvider.removeFromSharedList({items:t,markAsSpam:!1,parentKey:this._urlDataSource.getRootItemKey(v.e.SharedWithMe)})];case 2:if(i=a.sent())for(r=0;r<i.length;r++)w(i[r],n[r]);return[3,4];case 3:for(a.sent(),r=0;r<n.length;r++)w(m.t,n[r]);return[3,4];case 4:return[2,2]}})})},isAvailable:o,isDefault:!0,icon:new S.e("Cancel"),automationId:"removeFromSharedListConfirm"}]}),[4,d.wait()];case 2:return p.sent(),[2,{resultType:u.e.Success}]}})})},t}(n(2047).e);function w(e,t){e?(t.error(new c.e({message:e})),t.state(d.e.failed)):t.state(d.e.completed)}t.default=O}}]);