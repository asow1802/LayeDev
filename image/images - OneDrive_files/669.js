(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[669],{2051:function(e,t,n){"use strict";var a,i,r;n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(a||(a={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(i||(i={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(r||(r={}))},2157:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(2051),i=[a.e.lightBlue,a.e.blue,a.e.darkBlue,a.e.teal,a.e.green,a.e.darkGreen,a.e.lightPink,a.e.pink,a.e.magenta,a.e.purple,a.e.orange,a.e.lightRed,a.e.darkRed,a.e.violet,a.e.gold,a.e.burgundy,a.e.warmGray,a.e.cyan,a.e.rust,a.e.coolGray],r=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case a.e.lightBlue:return"#4F6BED";case a.e.blue:return"#0078D4";case a.e.darkBlue:return"#004E8C";case a.e.teal:return"#038387";case a.e.lightGreen:case a.e.green:return"#498205";case a.e.darkGreen:return"#0B6A0B";case a.e.lightPink:return"#C239B3";case a.e.pink:return"#E3008C";case a.e.magenta:return"#881798";case a.e.purple:return"#5C2E91";case a.e.orange:return"#CA5010";case a.e.red:return"#EE1111";case a.e.lightRed:return"#D13438";case a.e.darkRed:return"#A4262C";case a.e.transparent:return"transparent";case a.e.violet:return"#8764B8";case a.e.gold:return"#986F0B";case a.e.burgundy:return"#750B1C";case a.e.warmGray:return"#7A7574";case a.e.cyan:return"#005B70";case a.e.rust:return"#8E562E";case a.e.coolGray:return"#69797E";case a.e.black:return"#1D1D1D";case a.e.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=a.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var s=e.charCodeAt(o),c=o%8;n^=(s<<c)+(s>>8-c)}return i[n%r]}(n||t))}},2178:function(e,t,n){"use strict";var a,i=n(0),r=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(a||(a={}));var o=function(e){function t(n,a){var i=e.call(this,a.message)||this;return i.__proto__=t.prototype,i._type=n,i._httpResponseStatus=a.httpResponseStatus,i._cultureName=a.cultureName,i._message=a.message,i._serverErrorCode=a.serverErrorCode,i._correlationId=a.correlationId,i._redirectUrl=a.redirectUrl,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==a.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0}),t}(Error),s=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var a=this._getCachedTokenData(e);if(a&&!this._isExpiring(a)){var i={token:a.accessToken,isGuest:!1,expirationTimeMs:a.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:a.correlationId,spRequestTimestamp:a.requestTimestamp})}return this._retriableFetchWithDigest(e,r.retries,t).then(function(t){return n._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!1,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,n,i){var r=this,s=this._context.qosMonitor(),c=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(d){if(200!==d.status){r._context.logger.logError("fetchWithDigest failed. Server responded with "+d.statusText);var l=new o(a.unknownError,{httpResponseStatus:d.status,message:d.statusText,correlationId:e._getCorrelationId(d)});return 400!==d.status?(s.writeUnexpectedFailure("UnknownError",l),Promise.reject(l)):d.json().then(function(a){var o=e._extractRealError(a),c=r._getErrorCodeFromResponseCode(o);if(!r._isRetriableError(c)||0===n){var d=r._buildErrorFromResponse(o);return s.writeUnexpectedFailure("SharepointServerError",d),Promise.reject(d)}return r._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n),r._retriableFetchWithDigest(t,n-1,i)})}return r._instrumentedParseResponseData(d,s,c)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",r.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<r.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==r.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8"),n.append("Odata-Version","4.0"),n.append("Accept","application/json;odata.metadata=minimal");var a={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;return i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1)),new Request(i+r.apiUrl,a)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(a.malformedResponseBody,{httpResponseStatus:400,message:r.unexpectedErrorCodeFormat,correlationId:e.correlationId});e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,n=e.message.lang));var s="error.redirectUrl";return new o(a.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e[s]||e["@".concat(s)]})},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var a=t.indexOf(",");-1!==a&&(n=Number(t.substr(0,a)))}return n},e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(a){return n.writeSuccess(),{accessToken:a.access_token,expiresOn:Number(a.expires_on),notBefore:Number(a.not_before),resource:a.resource,tokenType:a.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){return n.writeUnexpectedFailure("ResponseParseError",i),Promise.reject(new o(a.malformedResponseBody,{httpResponseStatus:200,message:r.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var a=n[t];window.sessionStorage.removeItem(a)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),c=n(1288),d=n(109),l=n(260),u=n(145),f=n(54),p=function(){function e(){this._qos=new u.e({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:f.e.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:f.e.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:f.e.ExpectedFailure,error:JSON.stringify(t)})},e}(),m=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),_=function(e){function t(t,n){var a=e.call(this,{},{pageContext:t})||this;return a.logger=new m,n&&(n.logger&&(a.logger=n.logger),n.useAbsoluteUrlForOAuth&&(a._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)),a._oAuthUtility=new s(a),a}return Object(i.__extends)(t,e),t.prototype.qosMonitor=function(){return new p},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.o)(this._pageContext)},enumerable:!1,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var a=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),a,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};return t.forEach(function(e,t){n[t]=e}),n},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new d.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t}(c.t);t.e=_},2258:function(e,t,n){"use strict";var a,i=n(109),r=n(145),o=n(54);!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var s=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new r.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:o.e.Success}),e},function(e){return n.end({resultType:o.e.Failure}),i.n.reject(e)})},e}();t.e=s},3575:function(e,t,n){window,e.exports=function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+({0:"feed-bootstrapper",2:"topic-card-bootstrapper",3:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{0:"4fd00bd2c530dea78b23",2:"8a6b7f2870b8978a311c",3:"98116dba6251f48431a2"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://lpcres.delve.office.com/lpc/versionless/",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return i(i.s=11)}([function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=function(e,t,n,a,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=a,this.numberOfRetries=i}},function(e,t,n){"use strict";var a;n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"}(a||(a={}));var i=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),a=!1;-1!==n.indexOf("authtoken/loki")||-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",a=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",a=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",a=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",a=!0),a&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";var a=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},i=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},r=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return a(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return a(this,void 0,void 0,function(){var n;return i(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=a.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw a.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return a(this,void 0,void 0,function(){var t,n,a;return i(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:a=i.sent(),(t=n.initialize(e,{collectorUri:a}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20200108.3.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return a(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlAsync=function(){return a(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:switch(e=t.sent(),this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,e.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,e.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,e.AWT_COLLECTOR_URL_USGOV_DOD];case"Gallatin":throw new Error("Gallatin not supported by Aria");default:return[2,void 0]}return[2]}})})},e.prototype.noOp=function(){},e}();n.d(t,"b",function(){return c}),n.d(t,"a",function(){return d});var o=[];function s(e){return o.filter(function(t){return t.targetWindow===e})[0]}function c(e){var t=e.targetWindow||window,n=s(t);return n||(n={targetWindow:t,bootstrapperConfig:e,ariaLogger:new r(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1}),function(e){var t=s(e.targetWindow);if(t){var n=o.indexOf(t);o[n]=e}else o.push(e)}(n),n}function d(e){var t=s(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.OfficeFeed,delete n.OfficeFeedFull,delete n.OfficeFeedStrings,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig}!function(e){var t=s(e);if(t){var n=o.indexOf(t);o.splice(n,1)}}(e)}},function(e,t,n){"use strict";var a=n(0);function i(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}n.d(t,"a",function(){return o});var r="LokiAuthToken";function o(e,t,n){return new Promise(function(o,s){e?(i(r,e,n),o(e)):t(function(e,t){e?(i(r,e,n),o(e)):s(new a.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){var n=function(e){return/^AADSTS\d+?:/.test(e)}(e)?e:"";s(new a.a("GetAuthTokenError",n,t))})})}},function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(0);function i(e,t){var n=this,a=0,i=function(e,t){return function(e,t,n,a){return new(n||(n=Promise))(function(t,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())})}(n,0,void 0,function(){var n;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,r(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),a<2?(a++,[4,i(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=a,n;case 5:return[3,6];case 6:return[2]}})})};return i(e,t)}function r(e,t){return new Promise(function(n,i){var r=t.document.createElement("script");r.type="text/javascript",r.charset="utf-8",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",function(){n()}),r.addEventListener("error",function(){i(new a.a("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(r)})}},function(e,t,n){"use strict";function a(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}n.d(t,"a",function(){return a})},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=3e5},function(e,t,n){"use strict";function a(e){switch(e.complianceEnvironment){case"Blackforest":return"e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193";case"GccHigh":return"e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057";case"DoD":return"e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359";case"Gallatin":return"";default:return"e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"}}n.d(t,"a",function(){return a})},function(e,t,n){"use strict";function a(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}n.d(t,"a",function(){return a})},function(e,t,n){"use strict";function a(e){return"ppe"===e.region||"df"===e.region||"msit"===e.region?"https://{0}.loki.delve.office.com".replace("{0}",e.region):function(e){switch(e){case"Blackforest":return"https://loki.delve.office.de";case"GccModerate":return"https://gcc.loki.delve.office.com";case"GccHigh":return"https://gcchigh.loki.office365.us";case"DoD":return"https://dod.loki.office365.us";case"Gallatin":return"https://loki.office365.cn";case"Prod":return"https://loki.delve.office.com";default:return e}}(e.complianceEnvironment)}var i=n(0);function r(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search);return null===n?"":t.decodeURIComponent&&t.decodeURIComponent(n[1].replace(/\+/g," "))||""}n.d(t,"a",function(){return u}),n.d(t,"b",function(){return f});var o=function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s="LivePersonaCardVersionOverride",c="LivePersonaCardCultureOverride",d="MidgardVersion",l="MidgardBranch";function u(e,t,n){return p(function(e,t){var n=t||e.culture,i=a(e);return"{0}/api/v1/configuration/{1}/{2}".replace("{0}",i).replace("{1}",e.clientType).replace("{2}",n)}(t,r(c,n)),e,o(o({},t),{clientFeature:"LivePersonaCard"}),n)}function f(e,t,n){return p(function(e,t){var n=t||e.culture,i=a(e);return"{0}/api/v1/officefeed/configuration?cultureName={1}&returnResources=true".replace("{0}",i).replace("{1}",n)}(t,r(c,n)),e,o(o({},t),{clientFeature:"OfficeFeed"}),n)}function p(e,t,n,a){return new Promise(function(o,c){var u=new XMLHttpRequest;u.open("GET",e,!0),u.setRequestHeader("authToken",t),u.setRequestHeader("Accept","application/json");var f="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});u.setRequestHeader("X-RootCorrelationId",f),u.setRequestHeader("X-CorrelationId",f),u.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),u.setRequestHeader("X-ClientType",n.clientType),u.setRequestHeader("X-ClientFeature",n.clientFeature),n.hostAppRing&&u.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&u.setRequestHeader("X-HostAppVersion",n.hostAppVersion);var p=r(d,a)||r(s,a);p&&(u.setRequestHeader(s,p),u.setRequestHeader(d,p));var m=r(l,a);m&&u.setRequestHeader(l,m),u.addEventListener("load",function(){if(200===u.status)try{var e=JSON.parse(u.response);e.RootCorrelationId=f,e.LokiVersion=u.getResponseHeader("x-serverversion")||"",o(e)}catch(e){c(new i.a("GetLokiConfigError","Failed to parse initialization config.",f))}else c(new i.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+u.status,f,u.status))}),u.addEventListener("error",function(){c(new i.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",f))}),u.addEventListener("timeout",function(){c(new i.a("GetLokiConfigError","Loki config request timed out after 60000 ms.",f))}),u.timeout=6e4,u.send()})}},function(e,t,n){"use strict";var a=n(0);function i(e){return void 0===e||"string"!=typeof e||""===e||null===e}function r(e){return void 0===e||"function"!=typeof e}n.d(t,"a",function(){return c});var o=["msit","df","ppe"],s=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin"];function c(e){var t="";if(e){var n=[];i(e.culture)&&n.push("culture"),i(e.clientType)&&n.push("clientType"),i(e.clientContextType)&&n.push("clientContextType"),i(e.clientCorrelationId)&&n.push("clientCorrelationId"),r(e.logMessage)&&n.push("logMessage"),r(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===o.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+o.join(", ")+" for pre-production environments. "),-1===s.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+s.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new a.a("ValidateBootstrapperConfigError",t)}},function(e,t,n){"use strict";n.r(t);var a=n(6),i=n(3),r=n(9),o=0;function s(e,t,n){return function(e,t,n,a){return new(n||(n=Promise))(function(t,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?t(e.value):(a=e.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())})}(this,0,void 0,function(){var a,c;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,8]),[4,Object(r.a)(e,t,n)];case 1:return a=d.sent(),[3,8];case 2:return(c=d.sent()).statusCode&&401===c.statusCode?[4,Object(i.a)(void 0,t.getAuthToken,n)]:[3,4];case 3:e=d.sent(),d.label=4;case 4:return o<2?(o++,[4,s(e,t,n)]):[3,6];case 5:return a=d.sent(),[3,7];case 6:throw c.numberOfRetries=o,c;case 7:return[3,8];case 8:return[2,a]}})})}var c=n(4),d=n(0),l=n(2);function u(e,t){var n=Object(l.b)(t).targetWindow;return new Promise(function(a,i){setTimeout(function(){try{n.LPC||i(new d.a("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new d.a("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var r=function(e,t){var n=Object(l.b)(t).targetWindow;return{refreshAuthToken:f(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(r),a()}catch(e){i(new d.a("StartLivePersonaCardError",e.name))}},0)})}function f(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}var p=n(7),m=n(8),_=n(5),h=n(1),b=n(10);n.d(t,"initializeLivePersonaCardAsync",function(){return I}),n.d(t,"freeBootstrapperMemory",function(){return x}),n.d(t,"fetchLokiConfigAsync",function(){return C}),n.d(t,"lazyInitializeTopicCardAsync",function(){return O}),n.d(t,"lazyInitializeOfficeFeedAsync",function(){return w});var g=function(){return(g=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},v=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},y=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};try{var S=window.document.createElement("link"),D=Boolean("onmscontentzoom"in window.document);S.rel=D?"dns-prefetch":"preconnect",S.href="https://lpcres.delve.office.com/",window.document.head.appendChild(S)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}function I(e){return v(this,void 0,void 0,function(){var t,n,r=this;return y(this,function(o){return!(t=Object(l.b)(e)).forceRefreshInitializationPromise&&t.initializationPromise||(n=new h.a(t.targetWindow),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(a,o){return v(r,void 0,void 0,function(){var r,d,l,f,v,S;return y(this,function(y){switch(y.label){case 0:r=Object(p.a)(e),y.label=1;case 1:return y.trys.push([1,7,,8]),Object(b.a)(e),n.startCustomTiming(h.b.getAuthToken),[4,Object(i.a)(e.authToken,e.getAuthToken,t.targetWindow)];case 2:return d=y.sent(),n.endCustomTiming(h.b.getAuthToken),n.measureFromStart(h.b.getAuthTokenFromStart),n.startCustomTiming(h.b.getLokiConfig),[4,s(d,e,t.targetWindow)];case 3:return l=y.sent(),n.endCustomTiming(h.b.getLokiConfig),n.measureFromStart(h.b.getLokiConfigFromStart),n.startCustomTiming(h.b.getLpcBundles),[4,(D=l,I=t.targetWindow,C="MiniOwaMail"===D.Workload?D.Resources.livepersonacardstringslpcmini:D.Resources.livepersonacardstrings,x="MiniOwaMail"===D.Workload?D.Resources["livepersonacard_lpc-mini"]:"OwaPeopleHub"===D.Workload?D.Resources.livepersonacard_global:D.Resources.livepersonacard_full,Promise.all([Object(c.a)(C,I),Object(c.a)(x,I)]))];case 4:return y.sent(),n.endCustomTiming(h.b.getLpcBundles),n.measureFromStart(h.b.getLpcBundlesFromStart),n.startCustomTiming(h.b.startLpc),[4,u(l,e)];case 5:return y.sent(),n.endCustomTiming(h.b.startLpc),n.measureFromStart(h.b.startLpcFromStart),[4,t.ariaLogger.updateContextWithLokiDataAsync(l,r).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return y.sent(),(f=Object(_.a)(n.getAllTimings())).RootCorrelationId=l.RootCorrelationId,f.isConsumer=e.isConsumer,t.ariaLogger.logEventAsync({name:"initializeLivePersonaCard_success",properties:f},r),a(),[3,8];case 7:return v=y.sent(),S=Object(_.a)(n.getAllTimings()),t.ariaLogger.logEventAsync({name:"initializeLivePersonaCard_failure",properties:g(g(g({},Object(m.a)(v)),S),{isConsumer:e.isConsumer})},r),o("Failed to initialize Live Persona Card: "+v.name+" "+v.message),[3,8];case 8:return[2]}var D,I,x,C})})}),t.initializationPromise.catch(function(){setTimeout(function(){t.forceRefreshInitializationPromise=!0},a.a)})),[2,t.initializationPromise]})})}function x(e){Object(l.a)(e)}function C(e){return v(this,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return t=Object(l.b)(e),[4,Object(i.a)(e.authToken,e.getAuthToken,t.targetWindow)];case 1:return[2,s(n.sent(),e,t.targetWindow)]}})})}function O(e){return v(this,void 0,void 0,function(){return y(this,function(t){return[2,n.e(2).then(n.bind(null,45)).then(function(t){return(0,t.initializeTopicCardAsync)(e)})]})})}function w(e){return v(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,n.e(0).then(n.bind(null,44))];case 1:return[2,(0,t.sent().initializeOfficeFeedAsync)(e)]}})})}}])},4432:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n("react-lib"),r=n(185);Object(r.n)([{rawString:".livePersonaCardAdapterRoot_1e006338{display:inline-block}"}]);var o=n(3575),s=n(4434),c=n(2157),d=n(1818),l=n(146),u=n(13),f=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};return i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback),{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks,clientType:i.props.lpcClientType}},i.state={isReady:!1},i.hasCalledOnReady=!1,t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})}),i}return Object(a.__extends)(t,e),t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if((e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)&&(t.disableLPCForNativeIdentity||!e.pageContext.isNativeFederatedUser))return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer)return t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),Promise.resolve();var n=new s.e(e.pageContext),a=n.getAadAuthTokenGetter(),i=Object(s.t)(e.pageContext),r={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:a,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:"Msit"===i||"Df"===i?"Prod":i};return Object(o.initializeLivePersonaCardAsync)(r).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),e.onSuccess&&e.onSuccess()}).catch(function(t){e.onFailure&&e.onFailure(t)})},t._buildHostAppPersonaId=function(e,n){if(!t.disableLPCForNativeIdentity&&e&&n)return e=e.replace(/[{}]/g,""),n=n.replace(/[{}]/g,""),"".concat(e,"@").concat(n)},t.prototype.render=function(){var e=this,n=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var r=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(a.__assign)({personaInfo:{identifiers:{HostAppPersonaId:t._buildHostAppPersonaId(this.props.organizationId,this.props.tenantId),DisplayName:this.props.displayName,Smtp:this.props.legacyEmail||this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.legacyEmail:void 0),PersonaType:this.props.personaType,TopicId:this.props.topicId,LocationId:this.props.locationId},displayName:n?this.props.displayName:void 0,personaCoinColor:n?Object(c.e)({text:this.props.displayName}):void 0},behavior:Object(a.__assign)(Object(a.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return i.createElement(t.LivePersonaCardHoverTargetV2,Object(a.__assign)({},r),this.props.children)}return t.LivePersonaCardHoverTarget?(r=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({upn:this.props.legacyEmail,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&l.e.logData(e.props.loggingData),e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}}),i.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},r),this.props.children)):i.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)},t.prototype.componentDidUpdate=function(){this.state.isReady&&!this.hasCalledOnReady&&this.props.onPersonaCardReady&&(this.hasCalledOnReady=!0,this.props.onPersonaCardReady())},t.LivePersonaCardHoverTarget=void 0,t.LivePersonaCardHoverTargetV2=void 0,t.disableLPCForNativeIdentity=u.t.isActivated("4447C532-D4A2-4162-9C89-56324A4F7E52","08/03/2021","enable LPC for native identity users"),t._logResult=function(e,t,n){},t}(d.e)},4434:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return f});var a=n(0),i=n(145),r=n(54),o=["us_2_","us_86_","us_96_","us_105_","us_265_","us_266_","us_267_","us_268_","us_269_","us_270_"],s=n(2258),c=n(1288),d=n(2178),l=function(e){function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;return n._oAuthTokenProvider=new s.e(null,{oAuthTokenDataSource:new d.e(t)}),n}return Object(a.__extends)(t,e),t.prototype.getRegion=function(){var e=new i.e({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n)return e.end({resultType:r.e.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"}),"";var a=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[a]}catch(t){return e.end({resultType:r.e.Failure,resultCode:"LokiGetRegionError",error:t}),""}},t.prototype.getAuthTokenGetter=function(e){return void 0===e&&(e=""),this.getAadAuthTokenGetter()},t.prototype.getAadAuthTokenGetter=function(){var e,t,n,a=this,i=this._pageContext.CorrelationId,r=(e=(t=this._pageContext.farmSettings)&&("ag08"===(n=t.ExternalService_searchcloudenvironment)||"ag09"===n)&&t.ExternalService_searchcloudurl?JSON.parse(t.ExternalService_searchcloudurl):void 0)&&e.Loki||"https://loki.delve.office.com";return function(e,t){a._oAuthTokenProvider.getInstrumentedToken(r).then(function(t){return e(t.tokenInfo.token,t.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};t(JSON.stringify(n),i)})}},t.prototype.getBootstrapperConfig=function(){return{culture:this._pageContext.currentUICultureName,region:this.getRegion(),clientType:"ODSP",clientCorrelationId:this._pageContext.CorrelationId,complianceEnvironment:(e=this._pageContext,u(e)?"Blackforest":p(e)?"GccModerate":"Prod"),getAuthToken:this.getAuthTokenGetter()};var e},t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"},t}(c.t);function u(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function f(e){switch(function(e){var t=e.webAbsoluteUrl,n=e.farmLabel,a=e.env2,i=e.farmSettings;if("o365test"===a||"onebox"===a||"edog"===a)return a;if("string"==typeof t&&t.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1)return"spdf";if(null==i?void 0:i.ExternalService_searchcloudenvironment){var r=i.ExternalService_searchcloudenvironment;return"spdf"===r?"prodbubble":r}return function(e){return Boolean(e)&&o.some(function(t){return 0===e.toLowerCase().indexOf(t)})}(n)?"gcc":a}(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";default:return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09"}}function p(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}},4908:function(e,t,n){"use strict";n.r(t),n.d(t,"SpLivePersonaCard",function(){return c});var a=n(0),i=n("react-lib"),r=n(1818),o=n(1291),s=n(4432),c=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,i.props.pageContext,i.props.lpcCallbacks)},i}return Object(a.__extends)(t,e),t.makeSpLpcCallbacks=function(e,t,n){return Object(a.__assign)(Object(a.__assign)({},n||{}),{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp&&t?t(Object(o.getUserPhotoUrl)(e.Smtp,o.UserPhotoSize.Large)):t()},addGroupMembers:e})},t.prototype.render=function(){return i.createElement(s.e,{personaType:this.props.personaType,displayName:this.props.displayName,legacyEmail:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex,lpcClientType:this.props.lpcClientType,topicId:this.props.topicId,organizationId:this.props.organizationId,tenantId:this.props.tenantId,onPersonaCardReady:this.props.onPersonaCardReady},this.props.children)},t}(r.e)}}]);