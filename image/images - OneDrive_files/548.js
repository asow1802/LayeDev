(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[548,15,16,92],{1853:function(e,t,n){"use strict";n.r(t),n.d(t,"ConfirmationDialog",function(){return _});var a=n(2122),i=n(1746),r=n(2208),o=n(2062),s=n(2092),c=n(2393),d=n(251),l=n(2020),u=n("react-lib"),f=n(2329),p=n(2769),m=d.n.isFeatureEnabled({ODC:"DialogNextEnabled",ODB:60768})?c.e:{},_=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,d=void 0!==c&&c,_=e.defaultFocusToYes,h=void 0!==_&&_,b=e.yesText,g=void 0===b?p.t:b,v=e.noText,y=void 0===v?p.e:v,S=e.yesClassName,D=e.noClassName,I=function(e){e&&e.focus()},x=d?a.e:i.e,C=d?i.e:a.e,O=h?void 0:I,w=h?I:void 0;return u.createElement(f.e,null,u.createElement(l.e,{scopedSettings:m},u.createElement(r.e,{styles:e.styles,dialogContentProps:{type:o.e.close,styles:e.contentStyles,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth,closeButtonAriaLabel:e.closeButtonAriaLabel},e.children,u.createElement(s.e,null,u.createElement(x,{className:S,"data-automationid":"confirmbutton",onClick:t,componentRef:w},g),u.createElement(C,{className:D,"data-automationid":"cancelbutton",onClick:n,componentRef:O},y)))))}},2062:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(a||(a={}))},2092:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(1735),i=n(6),r=n("react-lib"),o=n(620),s=n(945),c=Object(o.e)(),d=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.e)(n),n}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,a=e.theme;return this._classNames=c(n,{theme:a,className:t}),r.createElement("div",{className:this._classNames.actions},r.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return r.Children.map(this.props.children,function(t){return t?r.createElement("span",{className:e._classNames.action},t):null})},t}(r.Component),l=n(553),u={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},f=Object(a.e)(d,function(e){var t=e.className,n=e.theme,a=Object(l.e)(u,n);return{actions:[a.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[a.action,{margin:"0 4px"}],actionsRight:[a.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}},void 0,{scope:"DialogFooter"})},2122:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(6),i=n("react-lib"),r=n(1818),o=n(1816),s=n(1746),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.a)(t,e),t.prototype.render=function(){return i.createElement(s.e,Object(a.e)({},this.props,{primary:!0,onRenderDescription:r.t}))},Object(a.n)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)}(i.Component)},2159:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(1735),i=n(6),r=n("react-lib"),o=n(620),s=n(945),c=n(934),d=n(114),l=Object(o.e)(),u=function(e){function t(t){var n=e.call(this,t)||this;Object(s.e)(n);var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,n}return Object(i.a)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(c.n)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(c.a)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,a=e.theme,o=e.styles,s=Object(d.s)(this.props,d.r),c=l(o,{theme:a,className:n,isDark:t});return r.createElement("div",Object(i.e)({},s,{className:c.root}))},t}(r.Component),f=n(553),p=n(65),m={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},_=Object(a.e)(u,function(e){var t,n=e.className,a=e.theme,i=e.isNone,r=e.isDark,o=a.palette,s=Object(f.e)(m,a);return{root:[s.root,a.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[p.e]={border:"1px solid WindowText",opacity:0},t)},i&&{visibility:"hidden"},r&&[s.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},2183:function(e,t,n){"use strict";n.d(t,"e",function(){return N});var a=n(1735),i=n(6),r=n("react-lib"),o=n(620),s=n(1814),c=n(934),d=n(125),l=n(822),u=n(616),f=n(214),p=n(1673),m=n(1102),_=n(202),h=n(2032),b=n(1093),g=n(553),v=n(1038),y=b.t.durationValue2,S={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},D=n(2159),I=n(1831),x=n(1998),C=n(308),O=n(163),w=n(521),E=n(132),A=n(818),L=Object(E.t)(function(e,t){return{root:Object(A.t)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),k=n(1282),M={start:"touchstart",move:"touchmove",stop:"touchend"},P={start:"mousedown",move:"mousemove",stop:"mouseup"},T=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=P,n._events=[],n._onMouseDown=function(e){var t=r.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=P,n._onDragStart(e)},n._onMouseUp=function(e){var t=r.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=P,n._onDragStop(e)},n._onTouchStart=function(e){var t=r.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=M,n._onDragStart(e)},n._onTouchEnd=function(e){var t=r.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=M,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(k.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(k.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(i.a)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=r.Children.only(this.props.children),t=e.props,n=this.props.position,a=this.state,o=a.position,s=a.isDragging,c=o.x,d=o.y;return n&&!s&&(c=n.x,d=n.y),r.cloneElement(e,{style:Object(i.e)(Object(i.e)({},t.style),{transform:"translate("+c+"px, "+d+"px)"}),className:L(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(r.Component),U=n(945),F={eventBubblingEnabled:!1},H=Object(o.e)(),R=function(e){function t(t){var n=e.call(this,t)||this;n._focusTrapZone=r.createRef(),n._focusTrapZoneMergedRef=Object(s.e)(),n._registerInitialModalPosition=function(){var e,t=document.querySelector("[data-id="+n.state.id+"]");if(t){var a=t.getBoundingClientRect();!(null===(e=n.props.dragOptions)||void 0===e?void 0:e.keepInBounds)||n._minClampedPosition||n._maxClampedPosition||(n._minClampedPosition={x:-a.x,y:-a.y},n._maxClampedPosition={x:a.x,y:a.y}),n.setState({modalRectangleTop:a.top})}},n._allowScrollOnModal=function(e){e?n._allowTouchBodyScroll?Object(c.e)(e,n._events):Object(c.t)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onModalContextMenuClose=function(){n.setState({isModalMenuOpen:!1})},n._onModalClose=function(){n._lastSetX=0,n._lastSetY=0,n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1,isOpen:!1,x:0,y:0}),n.props.dragOptions&&n._hasRegisteredKeyUp&&n._events.off(window,"keyup",n._onKeyUp,!0),n.props.onDismissed&&n.props.onDismissed()},n._onDragStart=function(){n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1})},n._onDrag=function(e,t){var a=n.state,i=a.x,r=a.y;n.setState(n._getClampedPosition({x:i+t.delta.x,y:r+t.delta.y}))},n._onDragStop=function(){n.focus()},n._onKeyUp=function(e){e.altKey&&e.ctrlKey&&e.keyCode===d.e.space&&Object(l.e)(n._scrollableContent,e.target)&&(n.setState({isModalMenuOpen:!n.state.isModalMenuOpen}),e.preventDefault(),e.stopPropagation())},n._onKeyDown=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===d.e.space)return e.preventDefault(),void e.stopPropagation();if(n.state.isModalMenuOpen&&(e.altKey||e.keyCode===d.e.escape)&&n.setState({isModalMenuOpen:!1}),!n.state.isInKeyboardMoveMode||e.keyCode!==d.e.escape&&e.keyCode!==d.e.enter||(n.setState({isInKeyboardMoveMode:!1}),e.preventDefault(),e.stopPropagation()),n.state.isInKeyboardMoveMode){var t=!0,a=n._getMoveDelta(e);switch(e.keyCode){case d.e.escape:n.setState({x:n._lastSetX,y:n._lastSetY});case d.e.enter:n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1});break;case d.e.up:n.setState({y:n._getClampedPositionY(n.state.y-a)});break;case d.e.down:n.setState({y:n._getClampedPositionY(n.state.y+a)});break;case d.e.left:n.setState({x:n._getClampedPositionX(n.state.x-a)});break;case d.e.right:n.setState({x:n._getClampedPositionX(n.state.x+a)});break;default:t=!1}t&&(e.preventDefault(),e.stopPropagation())}},n._onEnterKeyboardMoveMode=function(){n._lastSetX=n.state.x,n._lastSetY=n.state.y,n.setState({isInKeyboardMoveMode:!0,isModalMenuOpen:!1}),n._events.on(window,"keydown",n._onKeyDown,!0)},n._onExitKeyboardMoveMode=function(e){var t,a,i;null===(i=null===(t=n.props.focusTrapZoneProps)||void 0===t?void 0:(a=t).onBlur)||void 0===i||i.call(a,e),n._lastSetX=0,n._lastSetY=0,n.setState({isInKeyboardMoveMode:!1}),n._events.off(window,"keydown",n._onKeyDown,!0)},n._registerForKeyUp=function(){n._hasRegisteredKeyUp||(n._events.on(window,"keyup",n._onKeyUp,!0),n._hasRegisteredKeyUp=!0)},n._async=new u.e(n),n._events=new f.e(n),Object(U.e)(n),Object(p.e)("Modal",t,{onLayerDidMount:"layerProps.onLayerDidMount"}),n.state={id:Object(m.e)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen,hasBeenOpened:t.isOpen,x:0,y:0},n._lastSetX=0,n._lastSetY=0;var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,n}return Object(i.a)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer),e.isOpen&&(this.state.isOpen?this.setState({hasBeenOpened:!0,isVisible:!0}):(this.setState({isOpen:!0}),e.dragOptions&&this._registerForKeyUp())),!e.isOpen&&this.state.isOpen&&(this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(y)),this.setState({isVisible:!1}))},t.prototype.componentDidMount=function(){var e=this;this.state.isOpen&&this.state.isVisible&&(this._registerForKeyUp(),requestAnimationFrame(function(){return setTimeout(e._registerInitialModalPosition,0)}))},t.prototype.componentDidUpdate=function(e,t){var n=this;e.isOpen||t.isVisible||this.setState({isVisible:!0}),!e.isOpen&&this.props.isOpen&&requestAnimationFrame(function(){return setTimeout(n._registerInitialModalPosition,0)})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e,t,n,a,o,s,c,d,l,u,f,p,m,b,g,v=this.props,y=v.className,S=v.containerClassName,E=v.scrollableContentClassName,A=v.elementToFocusOnDismiss,L=v.firstFocusableSelector,k=v.focusTrapZoneProps,M=v.forceFocusInsideTrap,P=v.ignoreExternalFocusing,U=v.isBlocking,R=v.isClickableOutsideFocusTrap,N=v.isDarkOverlay,B=v.onDismiss,j=v.layerProps,V=v.overlay,z=v.responsiveMode,G=v.titleAriaId,K=v.styles,W=v.subtitleAriaId,q=v.theme,Q=v.topOffsetFixed,Y=v.onLayerDidMount,J=v.isModeless,X=v.isAlert,Z=v.dragOptions,$=v.enableAriaHiddenSiblings,ee=this.state,te=ee.isOpen,ne=ee.isVisible,ae=ee.hasBeenOpened,ie=ee.modalRectangleTop,re=ee.x,oe=ee.y,se=ee.isInKeyboardMoveMode;if(!te)return null;var ce=void 0===j?"":j.className,de=null!=X?X:U&&!J,le=H(K,{theme:q,className:y,containerClassName:S,scrollableContentClassName:E,isOpen:te,isVisible:ne,hasBeenOpened:ae,modalRectangleTop:ie,topOffsetFixed:Q,isModeless:J,layerClassName:ce,isDefaultDragHandle:Z&&!Z.dragHandleSelector}),ue=Object(i.e)(Object(i.e)(Object(i.e)({},F),this.props.layerProps),{onLayerDidMount:j&&j.onLayerDidMount?j.onLayerDidMount:Y,insertFirst:J,className:le.layer}),fe=r.createElement(h.e,Object(i.e)({},k,{"data-id":this.state.id,componentRef:this._focusTrapZoneMergedRef(this._focusTrapZone,null===(e=k)||void 0===e?void 0:e.componentRef),className:Object(_.e)(le.main,null===(t=k)||void 0===t?void 0:t.className),elementToFocusOnDismiss:(a=null===(n=k)||void 0===n?void 0:n.elementToFocusOnDismiss,null!=a?a:A),isClickableOutsideFocusTrap:(s=null===(o=k)||void 0===o?void 0:o.isClickableOutsideFocusTrap,null!=s?s:J||R||!U),ignoreExternalFocusing:(d=null===(c=k)||void 0===c?void 0:c.ignoreExternalFocusing,null!=d?d:P),forceFocusInsideTrap:(u=null===(l=k)||void 0===l?void 0:l.forceFocusInsideTrap,(null!=u?u:M)&&!J),firstFocusableSelector:(null===(f=k)||void 0===f?void 0:f.firstFocusableSelector)||L,focusPreviouslyFocusedInnerElement:(m=null===(p=k)||void 0===p?void 0:p.focusPreviouslyFocusedInnerElement,null==m||m),onBlur:se?this._onExitKeyboardMoveMode:void 0,enableAriaHiddenSiblings:(g=null===(b=k)||void 0===b?void 0:b.enableAriaHiddenSiblings,null!=g?g:$)}),Z&&se&&r.createElement("div",{className:le.keyboardMoveIconContainer},Z.keyboardMoveIconProps?r.createElement(w.e,Object(i.e)({},Z.keyboardMoveIconProps)):r.createElement(w.e,{iconName:"move",className:le.keyboardMoveIcon})),r.createElement("div",{ref:this._allowScrollOnModal,className:le.scrollableContent,"data-is-scrollable":!0},Z&&this.state.isModalMenuOpen&&r.createElement(Z.menu,{items:[{key:"move",text:Z.moveMenuItemText,onClick:this._onEnterKeyboardMoveMode},{key:"close",text:Z.closeMenuItemText,onClick:this._onModalClose}],onDismiss:this._onModalContextMenuClose,alignTargetEdge:!0,coverTarget:!0,directionalHint:O.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:this._scrollableContent}),this.props.children));return z>=C.e.small?r.createElement(I.e,Object(i.e)({},ue),r.createElement(x.e,{role:de?"alertdialog":"dialog","aria-modal":!J,ariaLabelledBy:G,ariaDescribedBy:W,onDismiss:B,shouldRestoreFocus:!P},r.createElement("div",{className:le.root,role:J?void 0:"document"},!J&&r.createElement(D.e,Object(i.e)({isDarkThemed:N,onClick:U?void 0:B,allowTouchBodyScroll:this._allowTouchBodyScroll},V)),Z?r.createElement(T,{handleSelector:Z.dragHandleSelector||"."+le.main.split(" ")[0],preventDragSelector:"button",onStart:this._onDragStart,onDragChange:this._onDrag,onStop:this._onDragStop,position:{x:re,y:oe}},fe):fe))):null},t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()},t.prototype._getClampedPosition=function(e){return this.props.dragOptions&&this.props.dragOptions.keepInBounds?{x:this._getClampedPositionX(e.x),y:this._getClampedPositionY(e.y)}:e},t.prototype._getClampedPositionY=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;return t&&(e=Math.max(t.y,e)),n&&(e=Math.min(n.y,e)),e},t.prototype._getClampedPositionX=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;return t&&(e=Math.max(t.x,e)),n&&(e=Math.min(n.x,e)),e},t.prototype._getMoveDelta=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t},t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""},Object(i.n)([C.n],t)}(r.Component),N=Object(a.e)(R,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,u=e.isModeless,f=e.layerClassName,p=e.isDefaultDragHandle,m=d.palette,_=d.effects,h=d.fonts,b=Object(g.e)(S,d);return{root:[b.root,h.medium,{backgroundColor:"transparent",position:u?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+y},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&b.isOpen,o&&{opacity:1,pointerEvents:"auto"},n],main:[b.main,{boxShadow:_.elevation64,borderRadius:_.roundedCorner2,backgroundColor:m.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:u?v.e.Layer:void 0},l&&"number"==typeof c&&s&&{top:c},p&&{cursor:"move"},a],scrollableContent:[b.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:window.innerHeight},t)},i],layer:u&&[f,b.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:h.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]})},2208:function(e,t,n){"use strict";n.d(t,"e",function(){return A});var a=n(1735),i=n(6),r=n("react-lib"),o=n(620),s=n(1102),c=n(2062),d=n(2183),l=n(308),u=n(945),f=n(1673),p=n(202),m=n(1869),_=n(2092),h=Object(o.e)(),b=r.createElement(_.e,null).type,g=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.e)(n),Object(f.e)("DialogContent",t,{titleId:"titleProps.id"}),n}return Object(i.a)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,a=t.className,o=t.closeButtonAriaLabel,s=t.onDismiss,d=t.subTextId,l=t.subText,u=t.titleProps,f=void 0===u?{}:u,_=t.titleId,b=t.title,g=t.type,v=t.styles,y=t.theme,S=t.draggableHeaderClassName,D=h(v,{theme:y,className:a,isLargeHeader:g===c.e.largeHeader,isClose:g===c.e.close,draggableHeaderClassName:S}),I=this._groupChildren();return l&&(e=r.createElement("p",{className:D.subText,id:d},l)),r.createElement("div",{className:D.content},r.createElement("div",{className:D.header},r.createElement("div",Object(i.e)({id:_,role:"heading","aria-level":1},f,{className:Object(p.e)(D.title,f.className)}),b),r.createElement("div",{className:D.topButton},this.props.topButtonsProps.map(function(e,t){return r.createElement(m.e,Object(i.e)({key:e.uniqueId||t},e))}),(g===c.e.close||n&&g!==c.e.largeHeader)&&r.createElement(m.e,{className:D.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:s}))),r.createElement("div",{className:D.inner},r.createElement("div",{className:D.innerContent},e,I.contents),I.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return r.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===b?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},Object(i.n)([l.n],t)}(r.Component),v=n(553),y=n(49),S=n(65),D={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},I=Object(a.e)(g,function(e){var t,n,a,i=e.className,r=e.theme,o=e.isLargeHeader,s=e.isClose,c=e.hidden,d=e.isMultiline,l=e.draggableHeaderClassName,u=r.palette,f=r.fonts,p=r.effects,m=r.semanticColors,_=Object(v.e)(D,r);return{content:[o&&[_.contentLgHeader,{borderTop:"4px solid "+u.themePrimary}],s&&_.close,{flexGrow:1,overflowY:"hidden"},i],subText:[_.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:y.t.regular}],header:[_.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&_.close,l&&[l,{cursor:"move"}]],button:[_.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:y.n.medium}}}],inner:[_.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+S.o+"px) and (max-width: "+S.a+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[_.content,{position:"relative",width:"100%"}],title:[_.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+S.o+"px) and (max-width: "+S.a+"px)"]={padding:"16px 46px 16px 16px"},n)},o&&{color:m.menuHeader},d&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(a={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:p.roundedCorner2}},a["@media (min-width: "+S.o+"px) and (max-width: "+S.a+"px)"]={padding:"15px 8px 0 0"},a)}]}},void 0,{scope:"DialogContent"}),x=Object(o.e)(),C={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},O={type:c.e.normal,className:"",topButtonsProps:[]},w=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,a=e.modalProps,i=e.dialogContentProps,r=e.subText,o=a&&a.subtitleAriaId||t;return o||(o=(i&&i.subText||r)&&n._defaultSubTextId),o},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,a=e.modalProps,i=e.dialogContentProps,r=e.title,o=a&&a.titleAriaId||t;return o||(o=(i&&i.title||r)&&n._defaultTitleTextId),o},n._id=Object(s.e)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(i.a)(t,e),t.prototype.render=function(){var e,t,n,a,o=this.props,s=o.className,c=o.containerClassName,l=o.contentClassName,u=o.elementToFocusOnDismiss,f=o.firstFocusableSelector,p=o.forceFocusInsideTrap,m=o.styles,_=o.hidden,h=o.ignoreExternalFocusing,b=o.isBlocking,g=o.isClickableOutsideFocusTrap,v=o.isDarkOverlay,y=o.isOpen,S=o.onDismiss,D=o.onDismissed,w=o.onLayerDidMount,E=o.responsiveMode,A=o.subText,L=o.theme,k=o.title,M=o.topButtonsProps,P=o.type,T=o.minWidth,U=o.maxWidth,F=o.modalProps,H=Object(i.e)({},F?F.layerProps:{onLayerDidMount:w});w&&!H.onLayerDidMount&&(H.onLayerDidMount=w),F&&F.dragOptions&&!F.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",a=Object(i.e)(Object(i.e)({},F.dragOptions),{dragHandleSelector:"."+n})):a=F&&F.dragOptions;var R=Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({},C),{className:s,containerClassName:c,isBlocking:b,isDarkOverlay:v,onDismissed:D}),F),{layerProps:H,dragOptions:a}),N=Object(i.e)(Object(i.e)(Object(i.e)({className:l,subText:A,title:k,topButtonsProps:M,type:P},O),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(i.e)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),B=x(m,{theme:L,className:R.className,containerClassName:R.containerClassName,hidden:_,dialogDefaultMinWidth:T,dialogDefaultMaxWidth:U});return r.createElement(d.e,Object(i.e)({elementToFocusOnDismiss:u,firstFocusableSelector:f,forceFocusInsideTrap:p,ignoreExternalFocusing:h,isClickableOutsideFocusTrap:g,responsiveMode:E},R,{isOpen:void 0!==y?y:!_,className:B.root,containerClassName:B.main,onDismiss:S||R.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),r.createElement(I,Object(i.e)({subTextId:this._defaultSubTextId,showCloseButton:R.isBlocking,onDismiss:S},N),this.props.children))},t.defaultProps={hidden:!0},Object(i.n)([l.n],t)}(r.Component),E={root:"ms-Dialog"},A=Object(a.e)(w,function(e){var t,n=e.className,a=e.containerClassName,i=e.dialogDefaultMinWidth,r=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,s=void 0===o?"340px":o,c=e.hidden,d=e.theme;return{root:[Object(v.e)(E,d).root,d.fonts.medium,n],main:[{width:r,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+S.r+"px)"]={width:"auto",maxWidth:s,minWidth:r},t)},!c&&{display:"flex"},a]}},void 0,{scope:"Dialog"});A.displayName="Dialog"},2280:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2329:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n("react-lib"),i=n(1319),r=n(183),o=n(214),s=0;function c(e){var t=e.isDefault,n=void 0!==t&&t,o=a.useState("".concat(++s))[0],c=a.useContext(i.e),d=a.useRef(),u=d.current||n&&c.keyboardManager||(d.current=new i.t({isDefault:!1,id:o,parent:c.keyboardManager})),f=l(u),p=f.isActive,m=f.isChildActive;a.useEffect(function(){return function(){n||(u.setIsActive(!1),u.dispose())}},[]);var _=a.useMemo(function(){return{keyboardManager:u}},[u]);return a.createElement("div",{"data-keyboard-zone-id":o},a.createElement(i.e.Provider,{value:_},Object(r.t)(e.children,{isActive:p,isChildActive:m})))}function d(){return l(a.useContext(i.e).keyboardManager)}function l(e){var t=a.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],r=a.useState(function(){return e.hasActiveChildren()}),s=r[0],c=r[1];return a.useEffect(function(){var t=new o.e(null);return t.on(e,"change",function(){i(e.getIsActive()),c(e.hasActiveChildren())}),function(){t.dispose()}},[]),{isActive:n,isChildActive:s}}},2393:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a,i=n(0),r={height:"100%",display:"flex",flexDirection:"column"},o={width:"440px",minWidth:"none",maxWidth:"none"},s={Modal:{styles:{main:Object(i.__assign)({selectors:(a={},a["@media (min-width: 480px)"]=Object(i.__assign)({},o),a),minHeight:"240px"},o)}},DialogContent:{styles:{content:r,inner:r,innerContent:r}},DialogFooter:{styles:{actions:{minHeight:"none"}}}}},2417:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"s",function(){return p}),function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION",e[e.OPEN_IN_EXCEL=1]="OPEN_IN_EXCEL",e[e.OPEN_IN_ONENOTE=2]="OPEN_IN_ONENOTE",e[e.OPEN_IN_POWERPOINT=3]="OPEN_IN_POWERPOINT",e[e.OPEN_IN_WORD=4]="OPEN_IN_WORD",e[e.OPEN_IN_VISIO=5]="OPEN_IN_VISIO",e[e.OPEN_IN_PROJECT=6]="OPEN_IN_PROJECT",e[e.OPEN_IN_PUBLISHER=7]="OPEN_IN_PUBLISHER"}(a||(a={}));var i=["MS-WORD","MS-EXCEL","MS-POWERPOINT"],r="ONENOTE|USEPLAIN",o=a.OPEN_IN_EXCEL,s=a.OPEN_IN_POWERPOINT,c=a.OPEN_IN_WORD,d=a.OPEN_IN_VISIO,l=a.OPEN_IN_ONENOTE,u={"MS-WORD":c,"ONENOTE|USEPLAIN":l,"MS-POWERPOINT":s,"MS-EXCEL":o,"MS-VISIO":d},f=["MS-WORD","MS-EXCEL","MS-POWERPOINT","ONENOTE|USEPLAIN"],p=["ONE","ONETOC2","ONEPKG"]},2602:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("bundle")},2607:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a="root",i="me",r="/drive/root:",o=30},2694:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(17);function i(e){return new Date(e)}function r(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,r=n.getFullYear()+"",o=Object(a.leftPad)(n.getMonth()+1+"",2),s=Object(a.leftPad)(n.getDate()+"",2),c=Object(a.leftPad)(n.getHours()+"",2),d=Object(a.leftPad)(n.getMinutes()+"",2),l=Object(a.leftPad)(n.getSeconds()+"",2),u=(i?"+":"-")+Object(a.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(a.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?r+"-"+o+"-"+s+"T"+c+":"+d+":"+l+u:r+o+s+"T"+c+d+l+u}},2725:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"r",function(){return y}),n.d(t,"o",function(){return S});var a=n(0),i=n(1325),r=n(3304),o=n(3302),s=n(72),c=n(104),d=n(115),l=n(3303),u=n(13),f=!u.e.isActivated("DAF1BE9A-8497-4F4F-8797-73EF984441D3","04/05/2022","Fix logic in hasRequiredRole"),p=!u.e.isActivated("A7214F2C-B4A0-4A90-AB59-4F8E4927261F","04/05/2022","Revises hasPermission `isOwner` logic to be self-contained and available to addon-graph consumers (not just odsp-next)"),m=(new c.e("addToOneDrive",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.e}))}),new c.e("canCreateFolder",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.t}))})),_=(new c.e("canCreateLink",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.n}))}),new c.e("canDelete",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.a}))})),h=new c.e("canDownload",function(e,t){return!e.demandItemFacet(d.i,t.itemKey)&&v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.i}))}),b=(new c.e("canInvite",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.r}))}),new c.e("canMove",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.o}))}),new c.e("canUseOfficeLens",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.s}))}),new c.e("canRename",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.c}))})),g=new c.e("canUpload",function(e,t){return v(e,Object(a.__assign)(Object(a.__assign)({},t),{commandFacet:r.d}))});function v(e,t){var n=t.itemKey,a=t.commandFacet,i=e.demandItemFacet(s.e,n);if(!i)return!1;var r=i.endpoint,c=i.driveId,d=e.demandItemFacet(a,o.e.serialize({endpoint:r,driveId:c}));return!!d&&!!d.roles&&y(e,{itemKey:n,oneOfRequiredRoles:d.roles})}function y(e,t){var n=t.itemKey,a=t.oneOfRequiredRoles,r=function(e,t){if(S(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}(e,n);return function(e,t){var n=t.oneOfRequiredRoles,a=t.effectiveRoles;if(f)for(var i=0,r=a;i<r.length;i++){var o=r[i];if(n.indexOf(o)>=0)return!0}else for(var o in a)if(o in n)return!0;return!1}(0,{oneOfRequiredRoles:a,effectiveRoles:r})}function S(e,t,n){var a,r,o=e.demandItemFacet(i.e,t);if(p){var c=e.demandItemFacet(s.e,t);if(Object(l.e)(e,{driveItemKey:c}))return!0}else{var d=null===(r=null===(a=null==o?void 0:o.owner)||void 0===a?void 0:a.user)||void 0===r?void 0:r.id;if(n&&d)return n.toUpperCase()===d.toUpperCase()}return!o||!o.effectiveRoles||!(o.owner||o.sharedBy)}},2726:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e.AddToOneDrive="AddToOneDrive",e.BrowseFiles="BrowseFiles",e.CloseVault="CloseVault",e.CreateFolder="CreateFolder",e.CreateFile="CreateFile",e.DeleteFile="DeleteFile",e.DeleteFolder="DeleteFolder",e.DownloadFile="DownloadFile",e.DownloadBatch="DownloadBatch",e.RenameFile="RenameFile",e.RenameFolder="RenameFolder",e.OpenVault="OpenVault",e.PopulateRecentFiles="PopulateRecentFiles",e.PopulateSharedWithMe="PopulateSharedWithMe",e.Search="Search",e.UploadFile="UploadFile",e.SaveFile="SaveFile",e.UploadBatch="UploadBatch"}(a||(a={})),function(e){e.ActiveUserOperation="AUO",e.BackgroundOperation="BGO",e.PassiveOperation="PO"}(i||(i={}))},2768:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemsViewSearch",{getSearchItemKey:a.t,query:a.t,isAvailable:a.t})},2814:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(13);function i(e){var t;return a.t.isActivated("70112978-C401-4C01-AC5E-CFB577601CD6","","")?e.parentReference:(null===(t=e.remoteItem)||void 0===t?void 0:t.parentReference)||e.parentReference}},2849:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("driveItemResponse")},2851:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("convergenceConfigurationFacet")},2916:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n("react-lib"),i=n(1366),r=n(851),o=n(4),s=n(21),c=n(562),d=n(182),l=n(199),u=n(13),f=n(2994),p=u.e.isActivated("AB1B9B00-C482-451A-A5DA-500AC7533605","1/31/2022","Require Name to be clickable for parent path to be clickable"),m=[];function _(e,t){var n=t.itemKey,d=t.renderer,u=e.demandItemFacet(o.k,n),_=e.demandItemFacet(o.A,null==u?void 0:u.itemKey)||"",b=e.demandItemFacet(f.e,n),g=f.e.evaluate(b)(e,{itemKey:n,displayPathSegments:_?h(_):m,openUrl:_,action:u&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:u.itemKey})):null}),v=g.displayPathSegments,y=void 0===v?m:v,S=g.action,D=g.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,y.length>0?a.createElement(s.n,{key:"path",action:S},function(t){var n=t.execute,o=t.isAvailable&&(p||e.isInvokable)?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:y,parentLink:o?D:void 0,onClick:o})}):null)}}}function h(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},2979:function(e,t,n){"use strict";var a=n(280);function i(e){return void 0!==e.action}function r(e){return void 0!==e.activityDateTime}function o(e){var t=g(e).comment;return void 0!==t&&!t.isReply}function s(e){var t=g(e).comment;return void 0!==t&&t.isReply}function c(e){return void 0!==g(e).mention}function d(e){return void 0!==g(e).version}function l(e){return void 0!==g(e).pointInTimeRestore}function u(e){return void 0!==g(e).restoreVersion}function f(e){return void 0!==g(e).move}function p(e){return void 0!==g(e).rename}function m(e){return void 0!==g(e).delete}function _(e){return void 0!==g(e).share}function h(e){var t=g(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function b(e){var t=g(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return i(e)?e.action:e}function v(e){return e.driveItem||e.listItem}var y=n(71),S=!n(13).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),D=function(){function e(){}return e.prototype.processResponse=function(e){var t=this,n=e.item,a=e.response;return{isPlaceholder:!1,activities:a.value.map(function(e){if(r(e))if(o(e)||s(e)){var a=g(e).comment;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}else if(c(e)){var i=g(e).mention;(i.contentId||i.navigationId)&&(e.docDetails={contentId:i.contentId,navigationId:i.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(a),success:!0}},e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}},e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}},e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}},e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),a=this._getParentItem(t),i=this._getAction(e,n,a,t);if(r(t)){var o=t.actor&&t.actor.user,s=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:s?[s]:[],item:n,parentItem:a,time:new Date(t.activityDateTime),action:i}}var c=t.actor&&t.actor.user,d=c&&{displayName:c.displayName,email:c.email,self:c.self,userPrincipalName:c.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[d],item:n,parentItem:a,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:i}},e.prototype._getActivityType=function(e){return(t={Comment:function(){return a.e.comment},CommentResponse:function(){return a.e.commentResponse},Create:function(){return a.e.create},Delete:function(){return a.e.delete},Edit:function(){return a.e.edit},Mention:function(){return a.e.mention},Move:function(){return a.e.move},Rename:function(){return a.e.rename},Restore:function(){return a.e.restore},RestoreVersion:function(){return a.e.restoreVersion},PointInTimeRestore:function(){return a.e.pointInTimeRestore},Share:function(){return a.e.share},Version:function(){return a.e.version},Copy:function(){return a.e.copy},AddShortcutToOneDrive:function(){return a.e.addShortcutToOneDrive},RemoveShortcutFromOneDrive:function(){return a.e.removeShortcutFromOneDrive}},function(e){return c(e)?t.Mention(e):o(e)?t.Comment(e):s(e)?t.CommentResponse(e):function(e){return void 0!==g(e).create}(e)?t.Create(e):m(e)?t.Delete(e):function(e){return void 0!==g(e).edit}(e)?t.Edit(e):f(e)?t.Move(e):p(e)?t.Rename(e):function(e){return void 0!==g(e).restore}(e)?t.Restore(e):u(e)?t.RestoreVersion(e):_(e)?t.Share(e):d(e)?t.Version(e):function(e){return void 0!==g(e).copy}(e)?t.Copy(e):l(e)?t.PointInTimeRestore(e):h(e)?t.AddShortcutToOneDrive(e):b(e)?t.RemoveShortcutFromOneDrive(e):void 0})(e);var t},e.prototype._getItem=function(e,t){var n,a,o=v(t);if(f(t)){if(i(t)){var s=g(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(m(t)&&i(t)){var c=g(t).delete;if(c&&c.name){var d=(a=(n=o&&o.parentReference)&&this._getRelativePathFromVroomPath(n.path))&&o&&a+"/"+o.name+"/"+c.name;return{name:c.name,isRoot:this._isRootItem(c.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0,isFolder:"Folder"===c.objectType}}}return o?(t.docDetails&&(o.webUrl=this._getNavLink(o,t.docDetails)),d=(a=(n=o&&(o.parentReference||o.remoteItem&&o.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(n.path))&&a+"/"+o.name,m(t)?{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:d,absolutePath:void 0}:{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:n&&"/drives/".concat(n.driveId,"/items/").concat(o.id),relativePath:d,absolutePath:void 0,driveItem:o,navigationId:this._getNavigationId(t)}):r(t)?void 0:e},e.prototype._getParentItem=function(e){var t=v(e);if(f(e)){var n=g(e).move;if(n&&n.to){var a=this._getDirNameFromPath(n.to),r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:void 0,absolutePath:this._getDirNameFromPath(a),isFolder:!0,driveItem:r&&{id:r.id}}}}else if(m(e)&&t){if(i(e)){var o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(r=t&&t.parentReference){o=this._getRelativePathFromVroomPath(r.path);var s=r.name?r.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===s||void 0===r.id)return;return{name:s,isRoot:this._isRootItem(s),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}else{if(u(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t};var c;if(l(e)&&t)return o=(c=(r=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(r.path))&&c+"/"+name,{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:r&&"/drives/".concat(r.driveId,"/items/").concat(t.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t};if(t&&(r=t.parentReference&&t.parentReference)){o=this._getRelativePathFromVroomPath(r.path);var d=r.name?r.name:o&&this._getFileNameFromPath(o);return{name:d,isRoot:this._isRootItem(d),graphItemUrl:"/drives/".concat(r.driveId,"/items/").concat(r.id),relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:r.id}}}}},e.prototype._getNavLink=function(e,t){var n=e.webUrl,a=n&&new y.t(n),i=t.navigationId;return a&&i&&a.setQueryParameter("nav",i),a.toString()||n},e.prototype._getNavId=function(e){return e&&e.navigationId},e.prototype._getNavigationId=function(e){var t,n,a;if(null==e?void 0:e.docDetails)return this._getNavId(e.docDetails);if(S&&o(e)){var i=g(e);return(null===(t=null==i?void 0:i.comment)||void 0===t?void 0:t.navigationId)?null===(n=null==i?void 0:i.comment)||void 0===n?void 0:n.navigationId:null===(a=null==i?void 0:i.comment)||void 0===a?void 0:a.commentId}},e.prototype._getAction=function(e,t,n,a){var i,l={};if(d(a)&&(l.version={newVersion:g(a).version.newVersion}),f(a)){var u=g(a).move;if(r(a)){var m=void 0,v=void 0;u.from&&(m=this._getDirNameFromPath(u.from)),u.to&&(v=this._getDirNameFromPath(u.to)),l.move={from:{name:this._getFileNameFromPath(m),isRoot:this._isRootItem(m),graphItemUrl:void 0,absolutePath:m},to:{name:this._getFileNameFromPath(v),isRoot:this._isRootItem(v),graphItemUrl:void 0,absolutePath:v}}}else if(u.From){var y=this._getDirNameFromPath(u.From);l.move={from:{name:this._getFileNameFromPath(y),isRoot:this._isRootItem(y),graphItemUrl:void 0,absolutePath:y},to:void 0}}else if(u.to){var S=this._getDirNameFromPath(u.to);l.move={from:void 0,to:{name:this._getFileNameFromPath(S),isRoot:this._isRootItem(S),graphItemUrl:void 0,absolutePath:S}}}}if(p(a)){var D=g(a).rename;l.rename={newItem:{name:D.newName,isRoot:this._isRootItem(D.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:D.oldName,isRoot:this._isRootItem(D.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(s(a)&&(i=g(a).comment).isReply&&(l.commentResponse={commentAuthor:i.parentAuthor&&i.parentAuthor.user}),o(a)&&((i=g(a).comment).isReply||(l.comment={commentId:i.commentId})),c(a)){var I=g(a).mention;l.mention={mentionees:I.mentionees&&I.mentionees.map(function(e){return e.user})||[],commentId:r(a)?I.navigationId:void 0}}if(_(a)){var x=g(a).share;l.share={recipients:x.recipients&&x.recipients.map(function(e){return e.user})||[]}}if(h(a)&&(l.addShortcutToOneDrive={}),b(a)){var C=g(a).addToOneDrive;l.removeShortcutFromOneDrive={mountPointName:C.mountPointName}}return l},e.prototype._getRelativePathFromVroomPath=function(e){if(e)return e.split(":",2)[1]},e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))},e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)},e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e},e}();t.e=D},2994:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},2995:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(228),r=n(2916),o=n(179),s=n(74),c=n(983),d=n(1e3),l=n(998),u=n(999),f=n(730),p=n(180),m=n(13).e.isActivated("A8ABE184-9647-42E8-BBAD-7AC7F51995D6","5/20/2022","Fix signals positioning in nameAndPathColumn")?[f.t,r.e]:[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},3122:function(e,t,n){"use strict";n.d(t,"e",function(){return K}),n.d(t,"t",function(){return q});var a=n(0),i=n(115),r=n(4),o=n(7),s=n(72),c=n(958),d=n(3953),l=n(3137),u=n(2849),f=n(2602),p=n(721),m=n(1325),_=n(2),h=new _.e("deletedDateTime"),b=new _.e("deletedFromLocation"),g=n(3136),v=n(229),y=n(340),S=n(168),D=n(46),I=n(989),x=n(1367),C=n(993),O=n(1330),w=n(4826),E=n(2814),A=n(978),L=n(3535),k=n(3420),M=n(247),P=n(4199),T=n(3787),U=n(729),F=n(3954),H=n(3955),R=n(3956),N=n(1350),B=n(268),j=n(13),V=!j.e.isActivated("9744858D-1FBE-4889-99CD-288F9CB2B2B1","06/01/2022","Actively pack undefined `mountPointFacet` + `shortcutItemFacet` in `getDriveItemFacets`"),z=!j.e.isActivated("1AEC6B12-C1F5-40E0-8D77-DDD9B65B3C25","09/15/2022","Disable overriding document library names"),G=!j.e.isActivated("5EDF71CC-AEE3-4FF3-BFC7-E895EB999F8F5","12/09/2022","Add follow facet if Favorites is enabled");function K(e){var t=e.itemKey,n=e.driveItemKey,_=e.driveItem,j=e.endpoint,Q=e.parentFolderItemKey,Y=e.shouldReturnShareFacets,J=void 0===Y||Y,X=_.coverImage,Z=_.file,$=_.fileSystemInfo,ee=_.name,te=_.remoteItem,ne=_.root,ae=_.size,ie=_.thumbnails,re=_.image,oe=_.video,se=_.eTag,ce=_.tags,de=_.photo,le=_.specialFolder,ue=_.photoStreamItemSource;return function(e){var Y,fe,pe,me,_e,he,be,ge,ve=_.lastModifiedDateTime,ye=void 0===ve?$&&$.lastModifiedDateTime||te&&te.lastModifiedDateTime:ve,Se=_.createdDateTime||$&&$.createdDateTime||te&&te.createdDateTime,De=Object(E.e)(_),Ie=null==De?void 0:De.driveId,xe=null==De?void 0:De.driveType,Ce="personal"===xe,Oe=_.webDavUrl||te&&te.webDavUrl,we=null==De?void 0:De["@oneDrive.displayPath"],Ee=null===(be=null===(he=null==te?void 0:te.owner)||void 0===he?void 0:he.user)||void 0===be?void 0:be.displayName,Ae=we?d.e.serialize({endpoint:j,driveId:Ie,path:we}):void 0,Le=$&&$.lastAccessedDateTime||te&&te.fileSystemInfo&&te.fileSystemInfo.lastAccessedDateTime,ke=(null==de?void 0:de.takenDateTime)||(null==de?void 0:de.alternateTakenDateTime),Me=_.package||(null==te?void 0:te.package),Pe=ie||(null==te?void 0:te.thumbnails),Te=!(null==Pe?void 0:Pe.length)||!Pe[0].needsAuth,Ue=re||te&&te.image,Fe=oe||te&&te.video,He=_.shared||te&&te.shared,Re=_.deletedFromLocation,Ne=_.deletedDateTime,Be={itemId:_.id,driveId:Ie,endpoint:j},je=$&&$.systemPath,Ve=n||te&&te.parentReference&&{itemId:te.id,driveId:te.parentReference.driveId,endpoint:j}||Be,ze=s.e.serialize(Ve),Ge=Oe&&decodeURIComponent(Oe);ge=("business"===xe||!z&&"documentLibrary"===xe||"personal"===xe)&&ne?y.n:ee||te&&te.name||"";var Ke=_.bundle||(null==te?void 0:te.bundle),We=_.folder||(null==te?void 0:te.folder)||Ke,qe=null!=ae?ae:null==te?void 0:te.size,Qe=null==We?void 0:We.childCount,Ye=q(ge,!!We),Je=Ye.extension||(null==Me?void 0:Me.type),Xe=Je&&Object(w.e)(Je),Ze=_.sharepointIds||te&&te.sharepointIds,$e=_.localItem,et=_.webUrl||te&&te.webUrl,tt=new B.e({publisher:K});return Ae&&Q&&tt.mapKeys({mappings:(Y={},Y[Ae]=Q,Y)}),Ae&&tt.resolveItems({items:(fe={},fe[Ae]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},d.e.pack(d.e.deserialize(Ae))),r.u.pack(we?we.substring(we.lastIndexOf("/")+1):void 0)),r.L.pack(Ee)),r._.pack({})),fe)}),tt.resolveItems({items:(pe={},pe[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.e.pack(Ve)),r.u.pack(ge)),r.L.pack(Ee)),void 0!==qe?r.m.pack(qe):{}),r._.pack(We?{}:void 0)),et?r.A.pack(et):{}),C.n.pack(je)),Ge||Ke?r.i.pack(Ge):{}),r.c.pack(ye?new Date(ye).getTime():void 0)),r.s.pack(Se?new Date(Se).getTime():void 0)),S.c.pack(ke?new Date(ke).getTime():void 0)),Le?Object(a.__assign)({},r.o.pack(new Date(Le).getTime())):{}),i.i.pack(Me&&"oneNote"===Me.type?{}:void 0)),Pe?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l.e.pack(Pe)),k.e.pack(Te)),T.e.pack(Object(U.i)(Ye.extension))):{}),Object(M.e)().forFacet(S.h).thenInvalidate(ze,l.e).pack()),u.e.pack(_)),se?r.f.pack(se):{}),Ue&&Ue.width&&Ue.height?S.d.pack({width:Ue.width,height:Ue.height}):{}),Ue&&!Fe?S.m.pack({}):{}),Fe?S.g.pack({}):{}),o.t.pack({itemKey:c.e.serialize({driveItemKey:Ve,sortBy:"",isAscending:!0})})),r.n.pack({itemKey:p.e.serialize({driveItemKey:Ve})})),r.k.pack(Q?{itemKey:Q}:Ae?{itemKey:Ae}:void 0)),!Ce&&Oe?Object(a.__assign)({},r.M.pack(W(Oe))):{}),I.e.pack(xe)),Ce?Object(a.__assign)({},x.e.pack(_.vault)):{}),Ce&&_.restricted?Object(a.__assign)({},F.e.pack(_.restricted)):{}),r.p.pack(Ye)),J?Object(a.__assign)(Object(a.__assign)({},r.D.pack(!!He)),m.e.pack(He)):{}),$e?C.e.pack($e):{}),"number"==typeof Qe?D.e.pack(Qe):{}),P.e.pack(X)),H.e.pack(ce)),R.e.pack(!!ue)),C.t.pack(Z&&Z.mimeType)),Xe?O.e.pack(Xe):{}),Ze?A.e.pack(Ze):{}),le?L.e.pack(le.name):{}),Re?b.pack(Re):{}),Ne?h.pack(Ne):{}),r.d.pack(Ne||Re?{}:void 0)),V?Object(a.__assign)(Object(a.__assign)({},g.e.pack(void 0)),v.e.pack(void 0)):{}),pe)}),tt.resolveItems({items:(me={},me[t]=Object(a.__assign)(Object(a.__assign)({},Ke?f.e.pack(Ke):{}),G?Object(a.__assign)({},r.h.pack({itemKey:N.e.serialize({driveItem:Ve})})):{}),me)}),G&&tt.resolveItems({items:(_e={},_e[t]=Object(a.__assign)({},r.h.pack({itemKey:N.e.serialize({driveItem:Ve})})),_e)}),{itemResolver:tt}}}function W(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function q(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},3136:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("mountPoint")},3137:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("graphThumbnailSet")},3253:function(e,t,n){"use strict";n.d(t,"e",function(){return C}),n.d(t,"t",function(){return O});var a=n(0),i=n("react-lib"),r=n(66),o=n(311),s=n(521),c=n(2029),d=n(1330),l=n(349),u=n(185);Object(u.n)([{rawString:".iconContainer_8aac815c{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8aac815c img{display:block}.menuItemIconContainer_8aac815c{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8aac815c,.logoIcon_8aac815c{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8aac815c[data-icon-name=ExcelLogo16],.logoIcon_8aac815c[data-icon-name=ExcelLogo16]{color:#217346}.logoFillIcon_8aac815c[data-icon-name=OneNoteLogo16],.logoIcon_8aac815c[data-icon-name=OneNoteLogo16]{color:#5c2d91}.logoFillIcon_8aac815c[data-icon-name=PowerPointLogo16],.logoIcon_8aac815c[data-icon-name=PowerPointLogo16]{color:#d24726}.logoFillIcon_8aac815c[data-icon-name=WordLogo16],.logoIcon_8aac815c[data-icon-name=WordLogo16]{color:#2b579a}.logoFillIcon_8aac815c[data-icon-name=VisioLogo16],.logoIcon_8aac815c[data-icon-name=VisioLogo16]{color:#3854a2}.logoFillIcon_8aac815c{color:#fff}.contextualMenuItemLinkContent_8aac815c{white-space:nowrap;height:inherit;display:flex;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8aac815c{margin:0 4px;vertical-align:middle;display:inline-block;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"}]);var f=n(16),p=n(51),m=n(4),_=n(3492),h={key:n(1437).e,automationId:"openInOfficeOnlineCommand",action:i.createElement(_.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},b=n(3495),g={key:n(1438).e,automationId:"openInOfficeClientCommand",action:i.createElement(b.t,null),facets:Object(a.__assign)({},r.t.pack(!0))},v=n(2),y=n(1359),S=new v.e("fileHandlerOpenCommand").id,D=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,a=t.item,i=e.demandItem({appMap:d.e},n).appMap,r=a.name;return a.key===h.key?r=r||(i?Object(l.r)(i,!1):l.e.OpenInBrowser):a.key===g.key&&(r=r||(i?Object(l.o)(i,!0):l.e.Open)),{name:r}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_8aac815c"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8aac815c"},e.name))}))),I=Object(f.r)()(Object(f.a)()(Object(p.e)(function(e,t){var n=t.itemKey,i=t.menuProps,r=e.demandItem({appMap:d.e,fileName:m.p},n),o=r.appMap,s=r.fileName,c={};if(i&&i.items){var u=i.items[0];u&&-1!==u.key.indexOf(S)&&u.iconProps&&(c=u.iconProps)}var f=!!s&&!!s.extension&&".pdf"===s.extension.toLowerCase(),p={iconName:o?Object(l.t)(o):f?"PDF":"OpenFile"},_=void 0;return i&&i.items&&(_=i.items.map(function(e){return e.key===h.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.r)(o,!0)||(f?l.e.OpenInBrowser:l.e.Open),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e.key===g.key?Object(a.__assign)(Object(a.__assign)({},e),{iconProps:p,name:e.name||o&&Object(l.i)(o),onRenderIcon:o?x.bind(void 0,o,!0):void 0}):e})),{iconProps:c||p,onRenderIcon:o?x.bind(void 0,o,!1):void 0,text:l.e.Open,menuProps:_?Object(a.__assign)(Object(a.__assign)({},i),{items:_}):i}})(c.e)));function x(e,t){var n=e&&Object(l.n)(e),a=e&&Object(l.a)(e);return a?i.createElement(y.e,{size:16,extension:"",brand:a.toLowerCase(),className:"brandIcon_8aac815c"}):n?i.createElement("span",{className:t?"menuItemIconContainer_8aac815c":"iconContainer_8aac815c"},i.createElement(s.e,{iconName:n.logoFill16,className:"logoFillIcon_8aac815c"}),i.createElement(s.e,{iconName:n.logo16,className:"logoIcon_8aac815c"})):null}var C={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[h,g]},onRender:function(e){return i.createElement(I,Object(a.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(a.__assign)({},r.t.pack(!0))},O={key:o.e.key,automationId:o.e.automationId,name:o.e.name,subMenuProps:{items:[h,g],contextualMenuItemAs:D},facets:Object(a.__assign)({},r.t.pack(!0))}},3301:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(13).e.isActivated("EB854331-5340-42D0-8893-9E093DC56A47","03/10/2022","Use standard Open command for Office files")},3302:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("commands",{endpoint:i.e,driveId:i.t})},3303:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(72),i=n(2607);function r(e,t){var n,r=null!==(n=t.driveItemKey)&&void 0!==n?n:{};return r.driveId===function(e,t){var n=t.endpoint;if(n){var r=a.e.serialize({endpoint:n,driveId:i.n,itemId:i.a}),o=e.demandItemFacet(a.e,r,{suppressGetItems:!1});return null==o?void 0:o.driveId}}(e,{endpoint:r.endpoint})}},3304:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"o",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p});var a=n(2),i=new a.e("addToOneDrive"),r=new a.e("createFolder"),o=new a.e("createLink"),s=new a.e("delete"),c=new a.e("download"),d=new a.e("invite"),l=new a.e("move"),u=new a.e("officeLens"),f=new a.e("rename"),p=new a.e("upload")},3305:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n("react-lib"),i=n(16),r=n(51),o=n(4),s=n(562),c=Object(r.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.k,n);return i?a.createElement(s.e,{itemKey:i.itemKey}):null}),d=Object(i.r)()(Object(i.a)()(c))},3306:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("thumbnailToken",{endpoint:i.e,driveId:i.t})},3419:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("thumbnailAccessToken")},3420:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasThumbnailAuthTokenFacet")},3421:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("userByEmail",{email:i.e,endpoint:i.e})},3422:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("passwordProtectedErrorFacet")},3423:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("currentUserKey",{endpoint:i.e})},3492:function(e,t,n){"use strict";n.d(t,"e",function(){return D}),n.d(t,"t",function(){return I});var a,i=n(0),r=n(1828),o=n(51),s=n(25),c=n(4),d=n(16),l=n(35),u=n(1449),f=n(120),p=n(1330),m=n(71),_=n(251),h=n(13),b=n(72),g=n(2725);!function(e){e[e.none=0]="none",e[e.open=1]="open",e[e.editInOfficeOnline=2]="editInOfficeOnline",e[e.viewInOfficeOnline=3]="viewInOfficeOnline",e[e.download=4]="download",e[e.downloadAsZip=7]="downloadAsZip",e[e.openInOneNoteClient=6]="openInOneNoteClient",e[e.openInOfficeClient=10]="openInOfficeClient",e[e.signInDownload=11]="signInDownload",e[e.play=15]="play",e[e.showAccessDenied=50]="showAccessDenied"}(a||(a={}));var v=n(2417),y=_.n.isFeatureEnabled({ODC:"UseClientConstructedWACUrl"}),S=h.t.isActivated("625E4237-E29D-466D-B5EB-E72582BE416E","03/18/2022","Enable wac ST localStroage, remove once WopiHelper is supported in WebFE"),D=Object(o.e)(function(e,t){var n=t.itemKey,o=e.demandItem({openUrl:c.A,appFacet:p.e,isMalwareDetected:c.O},n),s=o.openUrl,d=o.appFacet,_=o.isMalwareDetected,h=e.dispatch,D=e.demandItemFacet(b.e,n),I=Object(g.r)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]}),x=e.demandItemFacet(c.p,n),C=((null==x?void 0:x.extension)||"").toUpperCase(),O=function(e,t){var n=-1!==v.s.indexOf(e);return!(!t||!v.d[t]||n)}(C&&"."===C[0]?C.substring(1):C,null==d?void 0:d.toUpperCase()),w=function(e,t,n){if(e){var i=!1;return t&&v.c.indexOf(t)>-1&&(i=n),i?a.editInOfficeOnline:a.viewInOfficeOnline}}(O,null==d?void 0:d.toUpperCase(),I),E=w===a.editInOfficeOnline?"edit":"view",A=!_&&!!d&&!!s&&O,L=e.demandItemFacet(u.e,n);return Object(i.__assign)({isAvailable:A,onExecute:s?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var e,t,a,o,c,d,l,p,_;return Object(i.__generator)(this,function(i){if(e=(new Date).getTime().toString(),t=r.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s),!S)try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return a=h(Object(f.e)(function(e){return u.e.evaluate(L)(e,{itemKey:n,action:E,forceInSameWindow:!1})})),o=a.forceInSameWindow,c=a.action,d=new m.t(t),l=d.getHost(),p=-1!==l.indexOf("my.microsoftpersonalcontent.com"),(y||p)&&(_=new m.t("https://".concat("onedrive.live.com","/").concat(c,".aspx")),(null==D?void 0:D.itemId)&&(_.setQueryParameter("resid",null==D?void 0:D.itemId),(null==D?void 0:D.driveId)&&_.setQueryParameter("cid",null==D?void 0:D.driveId),t=_.toString(),t=r.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",t))),o?window.location.href=t:window.open(t),[2]})})}:void 0},Object(l.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(s.e),I=Object(d.r)()(Object(d.a)()(D))},3495:function(e,t,n){"use strict";n.d(t,"e",function(){return b}),n.d(t,"t",function(){return g});var a=n(0),i=n(98),r=n(1399),o=n(51),s=n(25),c=n(16),d=n(35),l=n(4),u=new(n(5).e)("openInOfficeClientAction",{}),f=n(1330),p=n(72),m=n(2725),_=new i.e,h=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},b=Object(o.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:p.e,appMap:f.e,fileName:l.p,openUrl:l.A,canonicalUrl:l.i,isMalwareDetected:l.O},n),o=i.key,s=i.appMap,c=i.fileName,b=i.openUrl,g=i.canonicalUrl,y=i.isMalwareDetected,S=!1,D=h,I=Object(m.r)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var x=!y&&!!s&&!!b&&(_.isMac||_.isWindows||_.isIOS||_.isWinPhone||_.isAndroid),C=e.demandItemFacet(u,n),O=u.evaluate(C)(e,{itemKey:n,isAvailable:x,protocolCallback:v}),w=O.protocolCallback,E=O.isAvailable;S=x&&E,o&&S&&(D=function(e){var t=this,n=e.key,i=e.openUrl,o=e.canonicalUrl,s=e.canEdit,c=e.appMap,d=e.fileName,l=e.isNew,u=e.defaultLocation,f=e.protocolCallback;return function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(a){return n?(e=!!s,t=function(){i&&window.open(i)},Object(r.e)({app:c||"",itemUrl:o||"",extension:d&&d.extension||"",shouldEdit:e,isNew:Boolean(l),defaultLocation:u||"",platformDetection:_,onNavigate:f,onFailureCallback:t}),[2]):[2]})})}}({key:o,openUrl:b,canonicalUrl:g,canEdit:I,appMap:s,fileName:c,protocolCallback:w}))}return Object(a.__assign)({isAvailable:S,onExecute:D},Object(d.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(s.e),g=Object(c.r)()(Object(c.a)()(b));function v(e){window.location.href=e}},3535:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("specialFolder")},3536:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(23),i=n(372),r=n(72),o=new a.e("driveItemUnauthenticatedThumbnail",{driveItemKey:r.e.subKeyPart,width:i.e,height:i.e})},3783:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3305),i=n(265),r={key:"OpenFileLocation",name:i.i,title:i.i,action:a.t,iconProps:{iconName:"FabricFolder"}}},3787:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("hasPdfFacet")},3788:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(13),i=function(){return a.e.isActivated("8B2678E4-71A6-4034-A604-01CE2E306BA6","07/28/2022","Use getItemThumbnailOperation to get thumbnail blob for each item")}},3789:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(50),i=n(2),r=n("react-lib"),o=n(265),s=n(745),c={action:r.createElement(a.t,null,r.createElement(s.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:o.c,iconProps:{iconName:"FabricFolderLink"},key:new i.e("RemoveShortcutFromSWM").id,name:o.s}},3891:function(e,t,n){"use strict";n.d(t,"e",function(){return j});var a,i=n("react-lib"),r=n(50),o=n(0),s=n(173),c=n(207),d=n(1853),l=n(904),u=n(1198),f=n(4),p=n(51),m=n(40),_=n(140),h=n(21),b=n(25),g=n(16),v=n(1492),y=n(35),S=n(225),D=n(13),I=Object(p.t)(function(e,t){var n=t.itemKeys,a=t.removeFromSharedListWizard,r=t.removeItemsFromSharedList,s=void 0===r?u.t:r,c=Object(m.e)(e)||"",d=e.demandItemFacet(S.e,c);if(0===n.length)return null;for(var l=d&&n.length<=200,f=a,p=0,g=n;p<g.length;p++){var I=g[p],x=e.demandItemFacet(v.e,I),C=D.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");v.e.evaluate(x)(e,{itemKey:I,isAvailable:!C}).isAvailable||(l=!1)}var O=e.dispatch,w=function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(o.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:c},t=Object(_.e)(n,function(){return e}),[4,O(s({items:t}))];case 1:return a.sent(),[2]}})})},E=Object(h.o)(function(e){return i.createElement(f,Object(o.__assign)({},e,{onItemRemoved:w,itemKeys:n}))});return i.createElement(b.e,Object(o.__assign)({isAvailable:l,onExecute:E},Object(y.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),x=Object(g.r)()(I),C=n(4201),O=n(3790),w=n(17),E=n(42),A=n(449),L=n(97),k=n(8),M=n(685),P=((a={})[E.a.started]=function(e){return Object(w.formatToArray)(Object(w.getLocalizedCountValue)(O.r,O.t,e)||"",e)},a[E.a.completed]=function(e){return Object(w.formatToArray)(Object(w.getLocalizedCountValue)(O.e,O.t,e)||"",e)},a[E.a.failed]=function(e){return Object(w.formatToArray)(Object(w.getLocalizedCountValue)(O.n,O.a,e)||"",e)},a[E.a.canceled]=function(e){return Object(w.formatToArray)(Object(w.getLocalizedCountValue)(O.n,O.a,e)||"",e)},a),T=Object(k.t)(function(){return function(e){e(Object(M.e)(u.e,A.e)(U))}});function U(e,t){var n,a=Object(L.a)(e,t),i=a.phase,r=a.count;return n=P[i](r),Object(o.__assign)({},n&&"item"!==t.format?{title:n}:{})}var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,a=t.reject,r=t.onItemRemoved,l=t.itemKeys,u=function(){return Object(o.__awaiter)(e,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return n(),[4,r()];case 1:return e.sent(),[2]}})})},f=function(){return Object(o.__awaiter)(e,void 0,void 0,function(){return Object(o.__generator)(this,function(e){return a(new s.e),[2]})})};return i.createElement(c.e,null,function(e){var t=e.itemCache,n=H(t,l),a=n.title,r=n.prompt;return i.createElement(d.ConfirmationDialog,{onCancel:f,onConfirm:u,yesText:O.i,noText:C.o,defaultToYes:!0,title:a,prompt:r})})},t}(i.PureComponent),H=function(e,t){if(t.length>1)return{title:C.r,prompt:C.i};if(1===t.length){var n=e.demandItemFacet(f._,t[0]);return{title:n?C.a:C.t,prompt:n?C.n:C.e}}return{title:"",prompt:""}},R=Object(l.e)({operationTypeFacet:u.n,progressKeyFacet:u.e,initializeBatch:function(){return T}}),N=Object(p.e)(function(){return{removeFromSharedListWizard:F,removeItemsFromSharedList:R}})(x),B=n(265),j={key:new(n(2).e)("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:B.l,action:i.createElement(r.t,null,i.createElement(N,null)),iconProps:{iconName:"Cancel"}}},3948:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(179),r=n(228),o=n(2916),s=n(983),c=n(74),d=n(180),l=Object(s.e)({key:i.c,name:r.d,fieldName:"",isCollapsible:!1,minWidth:c.e.regularMin,maxWidth:c.e.displayNameMax,sortProps:void 0,isResizable:!0,data:{facets:Object(a.__assign)({},d.e.pack("path"))}},[o.e])},3951:function(e,t,n){"use strict";function a(e){return"."===e[0]}n.d(t,"e",function(){return a})},3952:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=n(251).n.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},3953:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(23),i=n(19),r=new a.e("driveItemByPath",{endpoint:i.e,driveId:i.t,path:i.e})},3954:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("restricted")},3955:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("tags")},3956:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("isPhotoStreamItem")},3957:function(e,t,n){"use strict";n.d(t,"e",function(){return I}),n.d(t,"t",function(){return x});var a=n(0),i=n(4),r=n(115),o=n(72),s=n(3137),c=n(3306),d=n(3419),l=n(3420),u=n(2849),f=n(446),p=n(182),m=n(363),_=n(489),h=n(13),b=n(1022),g=n(3536),v=n(168),y=n(3788),S=h.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail"),D=h.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl");function I(e,t){var n=t.itemKey,h=t.desiredSize,S=t.fitMode,I=t.requestOptions,C=e.demandItemFacet(o.e,n);if(!C)return{};var O=e.demandItemFacet(l.e,n)?function(e,t){var n=t.itemKey,a=t.desiredSize,i=t.fitMode,r=x(e.demandItemFacet(s.e,n));if(r&&r.large){var o=e.demandItemFacet(u.e,n),c=o&&(o["@microsoft.graph.downloadUrl"]||o["@content.downloadUrl"]),d=Object(b.e)(e,{itemKey:n});return{url:E(d&&c||r.large.url,a,i,d),width:0,height:0}}}(e,{itemKey:n,driveItem:C,desiredSize:h,fitMode:S}):function(e,t){var n,o,s=t.itemKey,l=t.driveItem,u=t.desiredSize;if(!D){var h=!!e.demandItemFacet(i._,s),b=!!e.demandItemFacet(r.i,s);if(h||b)return}if(!Object(y.e)()&&!(null===(n=t.requestOptions)||void 0===n?void 0:n.allowsHeaders))return function(e,t){var n=t.driveItem,a=t.desiredSize,i=Math.ceil(a.width),r=Math.ceil(a.height),o=g.e.serialize({driveItemKey:{driveId:n.driveId,itemId:n.itemId,endpoint:n.endpoint},width:i,height:r}),s=e.demandItemFacet(v.h,o);return s?{url:s.url,height:i,width:r}:void 0}(e,{driveItem:l,desiredSize:u});var S,I,x=e.demandItemFacet(i.f,s,{suppressGetItems:!0})||"",C=new p.e(l.endpoint).authority;if(D)I=l.endpoint.indexOf("/_api/v2.")>-1,S="".concat(C,I?"/_api/v2.1":"/v1.0");else{I=l.endpoint.indexOf("/v2.")>-1;var O=Object(f.a)(e,l.endpoint);S="".concat(C,I&&!O?"/_api/v2.1":"/v1.0")}var w=c.e.serialize({endpoint:S,driveId:l.driveId}),E=e.demandItemFacet(d.e,w);if(E){var A=Object(m.t)({endpoint:S,driveId:l.driveId,itemId:l.itemId}),L=Math.ceil(u.width),k=Math.ceil(u.height),M="".concat(A,"/thumbnails/0/c").concat(L,"x").concat(k,"/content"),P={prefer:"noredirect,closestavailablesize",cb:x};if(I||!D){var T=Object(a.__assign)(Object(a.__assign)({},P),{access_token:{uriValue:E}});return{url:"".concat(M,"?").concat(Object(_.e)(T)),width:L,height:k}}if(null===(o=t.requestOptions)||void 0===o?void 0:o.allowsHeaders){var U={Authorization:"bearer ".concat(E)};return{url:"".concat(M,"?").concat(Object(_.e)(P)),width:L,height:k,headers:U}}}}(e,{itemKey:n,driveItem:C,desiredSize:h,requestOptions:I});return O?{thumbnail:O}:{}}function x(e){return e&&(t=e)&&"number"==typeof t.length?e[0]:e;var t}var C=/width=[0-9]*/,O=/height=[0-9]*/,w=/cropmode=[a-z]*/;function E(e,t,n,a){if(a)return e;if(!S){var i="cover"===n?"center":"none";w.test(e)?e=e.replace(w,"cropmode=".concat(i)):e+="".concat(e.indexOf("?")>-1?"&":"?","cropmode=").concat(i)}var r="number"==typeof t.width?Math.ceil(t.width):t.width,o="number"==typeof t.height?Math.ceil(t.height):t.height,s="".concat(r||"");C.test(e)?e=e.replace(C,"width=".concat(s)):e+="".concat(e.indexOf("?")>-1?"&":"?","width=").concat(s);var c="".concat(o||"");return O.test(e)?e=e.replace(O,"height=".concat(c)):e+="".concat(e.indexOf("?")>-1?"&":"?","height=").concat(c),e}},3958:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return i}),function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={})),function(e){e[e.Mail=0]="Mail",e[e.CalendarEvent=1]="CalendarEvent",e[e.Teams=2]="Teams"}(i||(i={}))},3959:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("moveCopyProgress",{commands:a.t,description:a.t})},4197:function(e,t,n){"use strict";n.r(t),n.d(t,"recentContextMenuControlHandler",function(){return f});var a=n(311),i=n(250),r=n(965),o=n(3783),s=n(329),c=n(3253),d=n(3301),l={name:"-",key:"divider_1",itemType:s.e.Divider},u=[d.e?a.e:c.t,o.e,l,i.n,i.t,r.e];function f(e,t){return{commands:u}}},4199:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("coverImage")},4202:function(e,t,n){"use strict";n.r(t),n.d(t,"sharedWithMeContextMenuControlHandler",function(){return b});var a=n(0),i=n(311),r=n(250),o=n(457),s=n(965),c=n(1213),d=n(3789),l=n(3891),u=n(329),f=n(13),p=n(3253),m=n(3301),_=!f.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),h={name:"-",key:"divider_1",itemType:u.e.Divider};function b(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([m.e?i.e:p.t,r.n,r.t],_?[h]:[],!0),[c.e],!1),_?[o.e]:[],!0),[d.e,l.e,s.e],!1)}}},4410:function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"t",function(){return _});var a,i=n(0),r=n(109);!function(e){e[e.MalwareDetected=0]="MalwareDetected",e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut",e[e.DLPBlocked=2]="DLPBlocked",e[e.MissingMetaData=3]="MissingMetaData",e[e.DLPWarning=4]="DLPWarning",e[e.AwaitingApproval=5]="AwaitingApproval",e[e.Trending=6]="Trending",e[e.New=7]="New",e[e.NeedsRepublishing=8]="NeedsRepublishing"}(a||(a={}));var o=n(1291),s=n(54),c=n(445),d=n(825),l=n(2694),u=6e3,f="/_layouts/15/userphoto.aspx?size=S&accountname=",p="v2.1",m=function(){function e(e,t){this._eTagMap={},this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,a=void 0===n?function(e){return Object(o.getUserPhotoUrl)(e)}:n,i=t.caller,r=void 0===i?"hovercard":i,s=t.useSharePointApi,c=void 0!==s&&s;this._getProfileImageUrl=a,this._caller=r,this._useSharePointApi=c}return e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,a=void 0===n?p:n,i=t.skipToken,o=void 0===i?"":i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=o?";$skiptoken=".concat(o):"",l=e.queryType?"_".concat(e.queryType):"",u="GetItemAnalytics".concat(a).concat(l,"_WithGuestUser"),f=this._getBaseUrl(e);if(!f)return r.n.resolve();var m="".concat(f,"/analytics/allTime?$expand=activities"),_="".concat(m).concat("($filter=access%20ne%20null)").concat(d);return this._getAnalytics(u,_,!1,e,c)},e.prototype.getAnalyticsSections=function(e,t){if(void 0===t&&(t={}),this._useSharePointApi)return r.n.reject(void 0);var n=t.headers,a=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return r.n.resolve();var o="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),s="".concat(o,"&").concat("$expand=insights($expand=keyPoints)"),c=this._useSharePointApi?"".concat(i,"/driveItem?").concat(s):"".concat(i,"?").concat(s);return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",c,!0,e,a)},e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",a=this._getBaseUrl(e);if(!a)return r.n.resolve();var i=t.apiVersion,o=void 0===i?p:i,s=t.headers,c=void 0===s?{Caller:this._caller}:s,d=e.queryType?"_".concat(e.queryType):"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint".concat(o).concat(d),u="".concat(a,"/driveItem?").concat(n);return this._getAnalytics(l,u,!0,e,c)}var f="GetItemAnalyticsSections".concat(o).concat(d,"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle"),m="$select=*".concat(",id,reactions").concat(",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention"),_="".concat(m,"&").concat(n).concat(",insights($expand=keyPoints)"),h="".concat(a,"?").concat(_);return this._getAnalytics(f,h,!0,e,c)},e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.n.resolve();var a="".concat(t,"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)");return this._getAnalytics("GetLastSevenDaysItemAnalytics",a,!1,e,n)},e.prototype.getItemAnalyticsByInterval=function(e,t,n,a){var i=p,r=t.toISOString(),o=n.toISOString(),s=this._getBaseUrl(e)||"",c=this._getAnalyticsByIntervalPath(s,i,r,o,a);return this._getAnalyticsByInterval("GetDailyItemAnalytics",c,e.getAccessToken&&e.getAccessToken(),i)},e.prototype._getAnalytics=function(e,t,n,a,r,o){var s=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:a.getAccessToken&&a.getAccessToken(),headers:r,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){return"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1,e.eTag&&(s._eTagMap[a.itemId]=e.eTag),n?_(e,s._getProfileImageUrl):function(e,t){var n=e.activities,a=e.access,r=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:b(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:a&&a.actionCount,viewerCount:a&&a.actorCount,lastActivityDateTime:r}}(e,s._getProfileImageUrl)})},e.prototype.updateItemKeyPoints=function(e,t){var n=this,a="".concat(this._getBaseUrl(e),"/insights/keyPoints");return this._dataRequestor.send({path:a,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,qosExtraData:{Caller:this._caller},parseResponse:function(t){return n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"",JSON.parse(t.responseText)}}).then(function(e){return e.value})},e.prototype._getAnalyticsByInterval=function(e,t,n,a){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:u,qosExtraData:{Caller:this._caller}}).then(function(e){var t;return"v2.1"===a?(e=e)&&e.value&&(t=e.value.map(g)):t=(e=e).Items,t})},e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?"".concat(e.graphItemUrl):null},e.prototype._getAnalyticsByIntervalPath=function(e,t,n,a,i){var r;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";return r=this._useSharePointApi?"interval='".concat(i,"',startDateTime='").concat(n,"',endDateTime='").concat(a,"'"):"v2.1"===t?"startDateTime=".concat(n,"&endDateTime=").concat(a,"&interval=").concat(i):"startDateTime='".concat(n,"'&endDateTime='").concat(a,"'&interval='").concat(i,"'"),this._useSharePointApi?"".concat(e,"/oneDrive.getActivitiesByInterval(").concat(r,")"):"".concat(e,"/").concat(o,"?").concat(r)},e.prototype.getFilesAnalytics=function(e,t,n){var a=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:"".concat(t,"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '").concat(e.join("' or sharepointIds/listItemUniqueId eq '"),"'"),postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return a._parseFilesAnalyticsResponse(e)}):r.n.resolve()},e.prototype.getRecommendedActions=function(e){var t="".concat(this._getBaseUrl(e)).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))");return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype.getShareWith=function(e){var t="".concat(this._getBaseUrl(e)).concat("/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'");return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:u,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})},e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(c.t)(t,function(e){if("notSupported"===e)return{resultType:s.e.ExpectedFailure}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)},e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),a=e.value.map(function(e){var n=e.analytics,a=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},a),{analytics:{lastSevenDays:h(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:a})},e}();function _(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,r=n&&n.endDateTime,o=b(n&&n.activities,t),s=function(e){var t,n,i,r=[];return e.malware&&r.push({status:a.MalwareDetected}),e.publication&&e.publication.level.indexOf("checkout")>-1&&r.push({status:a.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user}),e.dataLossPrevention&&(e.dataLossPrevention.block?r.push({status:a.DLPBlocked}):e.dataLossPrevention.notify&&r.push({status:a.DLPWarning})),e.metadataMissing&&r.push({status:a.MissingMetaData}),e.awaitingApproval&&r.push({status:a.AwaitingApproval}),e.trending&&r.push({status:a.Trending}),e.createdDateTime&&(t=new Date(e.createdDateTime),n=(new Date).getTime(),i=t&&t.valueOf(),!isNaN(i)&&n-i<1728e5&&r.push({status:a.New,createdRelativeTime:Object(d.n)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})),r}(e),c=function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}}(e),u=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:u&&u.commentCount,likeCount:u&&u.likeCount,lifeCycleStatus:s,keyPointsData:c,lastActivityDateTime:r,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function h(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),a=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email;return n.activityDateTime=Object(d.n)(Object(l.t)(n.activityDateTime)),n.actor.user.image=t&&t(n.actor.user.email)||"".concat(f).concat(a),n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:a})}function b(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),a=n.actor&&n.actor.user&&n.actor.user.email,r=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(a):"".concat(f).concat(a),userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(d.n)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:r}),activityType:n.access?"Access":"Edit"})})}function g(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},4826:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(833);function i(e){var t=e.replace(".",""),n=Object.keys(a.e);for(var i in n)if(a.e.hasOwnProperty(n[i])){var r=n[i];if(a.e[r].indexOf(t)>-1)return r}}},5056:function(e,t,n){"use strict";n.r(t),n.d(t,"graphAddon",function(){return Fs});var a=n(0),i=n(8),r=n(1549),o=n(1634),s=n(269),c=n(1541),d=n(225),l=n(363),u=n(446),f=n(154),p=n(247),m=n(7),_=n(23),h=n(19),b=new _.e("driveItemPage",{endpoint:h.e,setItemKey:h.e,token:h.e}),g=n(268),v=n(292),y=n(299),S=n(47),D=n(197),I=n(54),x=n(182),C=n(3122),O=n(72),w=n(4),E=n(990),A=n(1328),L=n(218),k=n(2),M=new k.e("sharedBy"),P=n(3421);function T(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,r=e.setItemKey,o=e.driveItemResponse,s=e.endpoint,c=e.getDriveItemFacets,d=void 0===c?C.e:c,l=e.shouldInvalidateItemSetOnChildItemRename,u=void 0===l?void 0:l;return function(e){var c,l,f,_,h,b,v,y=new g.e({publisher:T}),S=E.e.serialize({driveItemKey:n}),D=void 0;if(r){var I=Object(p.e)().forFacet(w.d).thenInvalidate(r,m.e).forFacet(w.k).thenInvalidate(r,m.e);u&&!u(s)||(I=I.forFacet(w.u).thenInvalidate(r,m.e)),D=I.pack()}y.merge(e(d({itemKey:t,driveItemKey:n,driveItem:o,endpoint:s,parentFolderItemKey:i,setItemKey:r})).itemResolver),y.resolveItems({items:(c={},c[t]=Object(a.__assign)(Object(a.__assign)({},w.e.pack({itemKey:S})),D),c)});var x=null!==(l=o.lastModifiedBy)&&void 0!==l?l:null===(f=o.remoteItem)||void 0===f?void 0:f.lastModifiedBy;if(x&&(null==(F=x.user)?void 0:F.email)){var C=P.e.serialize({email:F.email,endpoint:s}),O=U({itemKey:t,personFacet:w.E,userKey:C,user:F}).itemResolver;y.merge(O)}var L=null!==(_=o.createdBy)&&void 0!==_?_:null===(h=o.remoteItem)||void 0===h?void 0:h.createdBy;if(L&&(null==(F=L.user)?void 0:F.email)){var k=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:A.a,userKey:k,user:F}).itemResolver,y.merge(O)}if(null===(b=o.remoteItem)||void 0===b?void 0:b.shared){var F,H=null!==(v=o.remoteItem.shared.sharedBy)&&void 0!==v?v:o.remoteItem.shared.owner;if(null==(F=null==H?void 0:H.user)?void 0:F.email){var R=P.e.serialize({email:F.email,endpoint:s});O=U({itemKey:t,personFacet:M,userKey:R,user:F}).itemResolver,y.merge(O)}}return{itemResolver:y}}}function U(e){var t,n,i=e.itemKey,r=e.personFacet,o=e.userKey,s=e.user,c=new g.e({publisher:U});return c.resolveItems({items:Object(a.__assign)((t={},t[o]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(s.displayName)),L.e.pack(s.email)),L.i.pack(s.id)),t),r&&(n={},n[i]=Object(a.__assign)({},r.pack({itemKey:o,displayValue:s.displayName})),n))}),{itemResolver:c}}var F=n(2607),H=new _.e("driveItem",{endpoint:h.e,driveId:h.t,canonicalUrl:h.e});function R(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,r=void 0===i?C.e:i;return function(i){var o,s,c,d=t.remoteItem,l=d&&d.parentReference,u=t.parentReference,f=u||l,p=f&&f.driveId,m=f&&f.id,_="personal"===(f&&f.driveType),h=!!t.root;d?(c=d.id,l&&(p=l.driveId)):c=_&&t.root?F.a:t.id;var b={endpoint:n,driveId:p,itemId:c},g=O.e.serialize(b),v=t&&(t.webDavUrl||t.webUrl),y=_&&f&&f.path===F.e?F.a:m||void 0,S=f&&y?O.e.serialize({endpoint:n,driveId:f.driveId||p,itemId:y}):void 0,D=[],I="";if(!_&&v){var C=new x.e(v);D.push.apply(D,C.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)})),D.unshift(C.authority),I=D.join("/")}f&&!h&&!y&&I&&(S=H.serialize({endpoint:n,driveId:f.driveId,canonicalUrl:I}));var E=i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:g,driveItemKey:b,parentFolderItemKey:S}))).itemResolver;if(E.resolveItems({items:Object(a.__assign)({},S&&(o={},o[S]=Object(a.__assign)({},I?w.A.pack(I):{}),o))}),d&&l){var A=O.e.serialize({endpoint:n,driveId:u&&u.driveId,itemId:t.id}),L=O.e.serialize({endpoint:n,driveId:l.driveId,itemId:d.id});E.mapKeys({mappings:(s={},s[A]=L,s)}),E.merge(i(r({itemKey:L,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:E,actualDriveItemKey:b,actualItemKey:g}}}var N=n(120),B=n(46),j=n(1540),V=n(115),z=n(958),G=n(3137),K=n(2849),W=n(3136),q=n(229),Q=n(721),Y=n(1325),J=n(340),X=n(168),Z=n(989),$=n(1367),ee=n(993),te=n(1330),ne=n(4826),ae=n(978),ie=n(3535),re=n(3420),oe=n(2602),se=n(4199),ce=n(3787),de=n(729),le=n(3955),ue=n(3956),fe=n(393),pe=n(3954);function me(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,r=e.endpoint,o=e.parentFolderItemKey,s=e.shouldReturnShareFacets,c=void 0===s||s,l=e.setItemKey,u=i.coverImage,f=i.file,_=i.fileSystemInfo,h=i.name,b=i.parentReference,v=i.lenses,y=i.remoteItem,S=i.root,D=i.size,I=i.thumbnails,x=i.image,C=i.video,E=i.eTag,A=i.photo,L=i.restricted,k=i.tags,M=i.specialFolder,P=i.photoStreamItemSource;return function(e){var s,T,U,F,H,R,N,j,_e,he,be=i.lastModifiedDateTime,ge=void 0===be?_&&_.lastModifiedDateTime:be,ve=i.createdDateTime||_&&_.createdDateTime,ye=(new Date).getTime(),Se=ve?new Date(ve).getTime():void 0,De=Se?ye-Se<1728e5:void 0,Ie=b&&b.driveId,xe=b&&b.driveType,Ce="personal"===xe,Oe=_&&_.lastAccessedDateTime,we=(null==A?void 0:A.takenDateTime)||(null==A?void 0:A.alternateTakenDateTime),Ee=i.package||(null==y?void 0:y.package),Ae=I,Le=!(null==Ae?void 0:Ae.length)||!Ae[0].needsAuth,ke=x,Me=C,Pe=i.shared||(null==y?void 0:y.shared),Te={itemId:i.id,driveId:Ie,endpoint:r},Ue=_&&_.systemPath,Fe=void 0;y&&(Fe={itemId:y.id,driveId:y.parentReference&&y.parentReference.driveId||"",endpoint:r},he=O.e.serialize({itemId:y.id,driveId:null!==(R=null===(H=y.parentReference)||void 0===H?void 0:H.driveId)&&void 0!==R?R:Ie,endpoint:r}));var He,Re=n||Te,Ne=O.e.serialize(Re),Be=i.webDavUrl,je=Be&&decodeURIComponent(Be);He="business"!==xe&&"documentLibrary"!==xe&&"personal"!==xe||!S?h||"":J.n;var Ve,ze=i.bundle||(null==y?void 0:y.bundle),Ge=i.folder||(null==y?void 0:y.folder)||ze;if(Ge){var Ke=d.e.matches(l);Ve=y?Ke?2:12:Pe?5:2}var We=(null===(N=null==Ge?void 0:Ge.folderView)||void 0===N?void 0:N.sortBy)||"",qe="descending"===(null===(j=null==Ge?void 0:Ge.folderView)||void 0===j?void 0:j.sortOrder),Qe=We&&{columnKey:Object(fe.l)(We),isAscending:!qe},Ye=null!=D?D:null==y?void 0:y.size,Je=null==Ge?void 0:Ge.childCount,Xe=function(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}(He,!!Ge),Ze=Xe.extension||(null==Ee?void 0:Ee.type),$e=Ze&&Object(ne.e)(Ze),et=i.sharepointIds,tt=i.localItem,nt=i.webUrl,at=new g.e({publisher:me});return at.resolveItems({items:(s={},s[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O.e.pack(Re)),w.u.pack(He)),ee.n.pack(Ue)),w.c.pack(ge?new Date(ge).getTime():void 0)),w.s.pack(Se)),X.c.pack(we?new Date(we).getTime():void 0)),w.S.pack(De)),V.i.pack(Ee&&"oneNote"===Ee.type?{}:void 0)),Object(p.e)().forFacet(X.h).thenInvalidate(Ne,G.e).pack()),K.e.pack(i)),m.t.pack({itemKey:z.e.serialize({driveItemKey:Re,sortBy:We,isAscending:!qe})})),w.n.pack({itemKey:Q.e.serialize({driveItemKey:Re})})),w.k.pack(o?{itemKey:o}:void 0)),Z.e.pack(xe)),w.p.pack(Xe)),oe.e.pack(ze)),se.e.pack(u)),ee.t.pack(f&&f.mimeType)),W.e.pack(Fe)),te.t.pack(v&&v.length>0?v:void 0)),le.e.pack(k)),ue.e.pack(!!P)),w._.pack(Ge?{}:void 0)),Oe?Object(a.__assign)({},w.o.pack(new Date(Oe).getTime())):{}),Ae?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},G.e.pack(Ae)),re.e.pack(Le)),ce.e.pack(Object(de.i)(Xe.extension))):{}),E?w.f.pack(E):{}),ke&&ke.width&&ke.height?X.d.pack({width:ke.width,height:ke.height}):{}),ke&&!Me?X.m.pack({}):{}),Me?X.g.pack({}):{}),Ce?Object(a.__assign)({},$.e.pack(i.vault)):{}),c?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.D.pack(!!Pe)),Y.e.pack(Pe)),Ve?V.e.pack(Ve):{}):{}),s)}),(null===(_e=i.vault)||void 0===_e?void 0:_e.root)&&at.mapKeys({mappings:(T={},T[O.e.serialize({endpoint:r,driveId:Ie,itemId:"vault"})]=t,T)}),at.resolveItems({items:(U={},U[t]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},void 0!==Ye?w.m.pack(Ye):{}),nt?w.A.pack(nt):{}),Qe?m.s.pack(Qe):{}),je||ze?w.i.pack(je):{}),tt?ee.e.pack(tt):{}),"number"==typeof Je?B.e.pack(Je):{}),$e?te.e.pack($e):{}),L?pe.e.pack(L):{}),et?ae.e.pack(et):{}),M?ie.e.pack(M.name):{}),U)}),at.resolveItems({items:(F={},F[t]=Object(a.__assign)({},q.e.pack(he?{itemKey:he}:void 0)),F)}),{itemResolver:at}}}function _e(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var r=t.parentReference,o=r&&r.driveId,s=r&&r.id,c=t.id;t.root&&(c=F.a);var d={endpoint:n,driveId:o,itemId:c},l=O.e.serialize(d),u=r&&r.path===F.e?F.a:s||void 0,f=r&&u?O.e.serialize({endpoint:n,driveId:r.driveId,itemId:u}):void 0;return{itemResolver:i(T(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:l,driveItemKey:d,getDriveItemFacets:me,parentFolderItemKey:f}))).itemResolver,actualDriveItemKey:d,actualItemKey:l}}}var he=n(13),be=n(2851),ge=!he.e.isActivated("2517C3C6-AAA1-43DA-BBB6-F27E6C7497D1","06/13/2022","Fallback children response to value of `[]` when `@odata.null` is asserted"),ve=!he.e.isActivated("241308BC-D957-4B3D-97F4-07ACD4C725B5","09/08/2022","Fixes issues with endpoint resolution for migrated content");function ye(e){return function(t){var n,i,r,o,s,c,d,l,u,_=e.itemKey,h=e.parentItemKey,C=e.itemSetKeyFacet,O=e.filterChildItems,w=e.onProcessResponse,E=e.groupChildItems,A=e.response,L=e.skip,k=void 0===L?0:L,M=e.enableRandomAccess,P=void 0!==M&&M,T=e.disableRemoteItem,U=e.totalChildCount,F=e.getDriveItemFacets,H=C.deserialize(_),V=H.driveItemKey.endpoint,z=new g.e({publisher:ye}),G=t(Object(D.e)({name:"remoteItemsMissingParentRef"}));ge&&!A.value&&A["@odata.null"]&&(A.value=[]);var K,W="number"==typeof A["@odata.count"]?A["@odata.count"]:U||A.value.length,q=A["@odata.nextLink"],Q=!!q,Y=t(Object(N.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(m.e,_),prevChildKeys:e.demandItemFacet(m.e,_)}})),J=Y.childItemsFacetResolved,X=Y.prevChildKeys,Z=X&&X.itemKeys,$=0,ee=0,te=0;P&&(J&&Z?K=Z.slice(0):"number"==typeof W&&(K=new Array(W+(Q&&W<=A.value.length?1:0)))),K||(K=new Array(A.value.length+(Q?1:0)));for(var ne=k,ae=0,ie=0,re=A.value;ie<re.length;ie++){var oe=re[ie],se=O&&O(oe),ce=oe.remoteItem,de=!(oe.remoteItem&&oe.remoteItem.parentReference&&oe.remoteItem.parentReference.driveId),le=ce&&de;if(le&&ae++,se||le)K.splice(ne,1),W--;else{var ue=t(Object(f.e)({graphEndpoint:S.y,graphRecentEndpoint:S.I,processDriveItemSet:S.P,allowDisableRemoteItemInPlace:S.i,convergenceConfiguration:be.e,getIsExternalItem:S.g})),fe=ue.graphEndpoint,pe=ue.graphRecentEndpoint,me=ue.processDriveItemSet,he=ue.allowDisableRemoteItemInPlace,Se=ue.convergenceConfiguration,De=ue.getIsExternalItem,Ie=he&&T,xe=Ie?_e:R,Ce=V.indexOf("/_api/v2.0")>-1||V.indexOf("/_api/v2.1")>-1,Oe=fe||pe;if(Ce){var we=null===(s=oe.parentReference)||void 0===s?void 0:s.driveId,Ee=ve&&we&&(null==Se?void 0:Se.isMigratedContent(we))?(null===(d=null===(c=oe.parentReference)||void 0===c?void 0:c.sharepointIds)||void 0===d?void 0:d.siteUrl)||(null===(l=oe.sharepointIds)||void 0===l?void 0:l.siteUrl):oe.webDavUrl||!Ie&&oe.remoteItem&&oe.remoteItem.webDavUrl||oe.webUrl;if(Ee){var Ae=new x.e(decodeURIComponent(Ee)).authority;V=ve||Oe?"".concat(Ae,"/_api/v2.0"):"".concat(Ae).concat(new x.e(V).path)}}var Le=t(xe({shouldInvalidateItemSetOnChildItemRename:me&&me.shouldInvalidateItemSetOnChildItemRename,setItemKey:_,driveItemResponse:oe,endpoint:V,getDriveItemFacets:F})),ke=Le.itemResolver,Me=Le.actualItemKey,Pe=Le.actualDriveItemKey,Te=oe.thumbnails,Ue=oe.remoteItem;if($++,(Te||!Ie&&Ue&&Ue.thumbnails)&&ee++,De&&(null===(u=null==Ue?void 0:Ue.sharepointIds)||void 0===u?void 0:u.tenantId)&&De({tenantId:Ue.sharepointIds.tenantId})&&te++,K[ne]=Me,z.merge(ke),w){var Fe=w({itemKey:_,driveItemKey:Pe,item:oe});Fe&&z.merge(Fe.itemResolver)}var He=t(Object(f.e)({processDriveItemFromSharePoint:S.M})).processDriveItemFromSharePoint;if(He&&(Ce||Oe)){var Re=t(He.process({itemKey:Me,driveItem:oe})).itemResolver;z.merge(Re)}ne++}}if(t(G(Object(a.__assign)({resultType:ae<1?I.e.Success:I.e.Failure},ae>0?{extraData:{count:ae}}:{}))),Q){var Ne=b.serialize({setItemKey:_,endpoint:V,token:q});z.merge(Object(v.t)({itemKey:Ne}).itemResolver),K[ne]=Ne}if(E){var Be=E(H);Be&&z.merge(Be.itemResolver)}else z.resolveItems({items:(n={},n[_]=Object(a.__assign)({},m.e.pack({itemKeys:K})),n)});return z.resolveItems({items:(i={},i[_]=Object(a.__assign)({},j.e.pack({childCount:$,childCount_withThumbnail:ee,childCount_external:te})),i)}),W!==U&&z.resolveItems({items:(r={},r[h]=Object(a.__assign)({},B.e.pack(W)),r)}),z.resolveItems({items:(o={},o[_]=Object(a.__assign)(Object(a.__assign)({},m.r.pack({itemKey:h})),Object(p.e)().forFacet(m.e).thenInvalidate(y.e).pack()),o)}),{itemResolver:z}}}var Se=n(1200),De=n(162);function Ie(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d.driveItemKey),u=d.driveItemKey.endpoint;return function(n){var i,d;De.t(Se.e.processData.start);var _=n(ye(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?_e:R)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),De.t(Se.e.processData.end),{itemResolver:_}}}var xe=n(361),Ce=he.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Oe(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=e.scenarioInfo,_=i.deserialize(n),h=_.driveItemKey,b=h.endpoint,g=h.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,h,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:t=Object(l.n)(_.driveItemKey),S.label=1;case 1:return S.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(_),driveUrl:t,driveId:g,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:b,headers:e.additionalHeaders,expectedErrors:d,timeout:Ce?void 0:6e4,scenarioInfo:m}))];case 2:return i=S.sent(),f=Object(a.__spreadArray)([],i.value,!0),h=c&&c(f)||i.value,v=o&&o(h)||h,[4,n(Ie(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:v})})))];case 3:return[2,{itemResolver:S.sent().itemResolver}];case 4:throw y=S.sent(),new xe.e(Object(a.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var we=n(139),Ee=n(93),Ae=n(634),Le=n(949),ke=n(345);function Me(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var Pe=n(2280),Te=new Map([["code",Ee.e.text],["csv",Ee.e.excel],["docx",Ee.e.word],["dotx",Ee.e.word],["one",Ee.e.onenote],["onepkg",Ee.e.onenote],["onetoc",Ee.e.onenote],["pdf",Ee.e.pdf],["photo",Ee.e.media],["potx",Ee.e.powerpoint],["ppsx",Ee.e.powerpoint],["pptx",Ee.e.powerpoint],["rtf",Ee.e.text],["txt",Ee.e.text],["video",Ee.e.media],["xlsx",Ee.e.excel],["xltx",Ee.e.excel],["zip",Ee.e.zip]]);var Ue=n(179);function Fe(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function He(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Re(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Ne(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function Be(e,t,n,i){return function(e,r){return Object(a.__spreadArray)([],e,!0).sort(function(e,a){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=a.folder||(null===(s=a.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=a.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:i(e,a,t)})}(e)}var je=new _.e("SharedByPersonKeyFacet",{displayName:h.e,email:h.e,id:h.e}),Ve=new _.e("dateSharedGroupKeyFacet",{relativeTime:h.e,sharedDateTime:h.e}),ze=new _.e("relativeTimeGroupKeyFacet",{relativeTime:h.e}),Ge=n(4492),Ke=n(537),We=n(17),qe=n(57),Qe=n(4490),Ye=(Qe.T,Qe.l,Qe.F,Qe.H,Qe.U,Qe.i,Qe.p,Qe.L,Qe.C,Qe.M,Qe.P,Qe.k,Qe.v,Qe.E,Qe.y,Qe.g,Qe.I,Qe._,Qe.x,Qe.D,Qe.S,Qe.h,Qe.A,Qe.w,Qe.O,Qe.b,[Qe.r,Qe.a,Qe.c,Qe.e,Qe.d,Qe.s,Qe.o,Qe.t,Qe.m,Qe.f,Qe.u,Qe.n]),Je=he.t.isActivated("1E74BB9A-47A2-40F6-89FA-C628928BEC2F","04/12/2022","Enable grouping of items that are missing the email or display name of the person who shared an item");function Xe(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.endpoint,i=n(Object(f.e)({getUserOneDriveEndpoint:S.v,graphEndpoint:S.y})),r=i.getUserOneDriveEndpoint,(o=i.graphEndpoint)&&t!==o&&r?[4,n(r({endpoint:t}))]:[3,2];case 1:s=a.sent(),t=s,a.label=2;case 2:return[2,t]}})})}}var Ze=n(2726),$e=Object(i.i)()(function e(t){var n=this,i=d.e.deserialize(t.itemKey),r=i.filters,o=i.sortBy,s=i.isAscending;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,c,l,p,_,h,b,v,y,D;return Object(a.__generator)(this,function(I){switch(I.label){case 0:return n=function(e){if(d.e.matches(e)){var t=d.e.deserialize(e).groupBy;if(t===fe.a[fe.c])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!je.matches(i))return e;var r=je.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return je.serialize(e)})}(Object.keys(t)),d=[],l=0,u=c;l<u.length;l++){var f=u[l];if(je.matches(f)){var p=je.deserialize(f);s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),B.r.pack(!0)),m.e.pack({itemKeys:t[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),qe.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,i,r,o,s,c=e.driveItemKey,d=e.item;if(d&&c){var l=d.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.displayName)||(Je?"":(null===(r=null==u?void 0:u.user)||void 0===r?void 0:r.email)||Ge.s),p=Object(a.__assign)(Object(a.__assign)({},null!==(o=null==u?void 0:u.user)&&void 0!==o?o:{}),{displayName:f}),m=O.e.serialize(c);if(!Je||p.email||p.id){var _=je.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});s=_,t.hasOwnProperty(s)||(t[_]=[]),t[_].push(m)}}},groupChildItems:n}}(e);if(t===fe.a[fe.e])return function(e){var t={},n=function(i){for(var r,o,s=new g.e({publisher:n}),c=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ve.matches(i))return e;var r=Ve.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Ve.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(Ve.matches(o)){var s=Ve.deserialize(o).relativeTime,c=ze.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),d=[],l=0,u=Object.keys(c);l<u.length;l++){var f=u[l];if(ze.matches(f)){var p=ze.deserialize(f).relativeTime;s.resolveItems({items:(r={},r[f]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p)),B.r.pack(!0)),m.e.pack({itemKeys:c[f]})),r)}),d.push(f)}}return s.resolveItems({items:(o={},o[e]=Object(a.__assign)(Object(a.__assign)({},m.e.pack({itemKeys:d})),qe.e.pack(!0)),o)}),{itemResolver:s}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=O.e.serialize(a);if(o){var c=function(e,t){if(!e)return Ge.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ke.today;if(n.setDate(n.getDate()-1),e>=n)return Ke.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return Ge.i;if(n.setDate(n.getDate()-7),e>n)return Ge.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return Ge.e;if(n.setDate(n.getDate()-7),e>n)return Ge.o;if(n.setDate(n.getDate()-7),e>n)return Ge.r;if(e>=a)return Ge.a;var i=t.getFullYear()===e.getFullYear(),r=Ye[e.getMonth()];return i?r:We.format(Ke.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=Ve.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),c=n.onProcessResponse,l=n.groupChildItems,p=d.e.deserialize(t.itemKey),_=p.driveItemKey.endpoint,h=i(Object(f.e)({graphSharedWithMeEndpoint:S.C})).graphSharedWithMeEndpoint,_=h||_,he.e.isActivated("C8633E26-C16D-4D6D-ABE5-BE1A2C3C256A","02/23/2022","Use OneDrive endpoint for Shared with me")?[3,3]:h&&h!==p.driveItemKey.endpoint?(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:h})}),[3,3]):[3,1];case 1:return[4,i(Xe({endpoint:_}))];case 2:(b=I.sent())!==p.driveItemKey.endpoint&&(p=Object(a.__assign)(Object(a.__assign)({},p),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},p.driveItemKey),{endpoint:b})})),I.label=3;case 3:return(v=i(Object(u.i)(p.driveItemKey.endpoint)))&&!o&&(o=fe.i,s=!0),y=d.e.serialize(p),[4,i(Oe(Object(a.__assign)(Object(a.__assign)({},t),{qosName:"sharedWithMe",itemKey:y,itemSetKeyFacet:d.e,parentItemKeyFacet:we.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint;return v?"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl"):!he.e.isActivated("211F049A-DF94-41B3-99C3-E71620C63E23","05/31/2022","Remove me from request Url")&&b?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(Ae.t)(n,!0),Object(Le.n)(a)),r=Te.get(i);return!!r&&Object(Ee.t)(t.filters,r)}(e.name,t)}(e,Object(ke.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Pe.e.today:return n;case Pe.e.yesterday:return Me(n,1);case Pe.e.last7Days:return Me(n,7);case Pe.e.last30Days:return Me(n,30);case Pe.e.last3Months:return Me(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(Pe.e).indexOf(n[0])?Pe.e.none:Pe.e[n[0]]));return a&&i&&r})}(e,r)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=fe.a[fe.e],r=fe.a[fe.c],o=fe.a[Ue.a],s=fe.a[Ue.n],c=fe.a[fe.o],d=fe.a[Ue.s];switch(t){case i:return Be(e,n,a,He);case r:return Be(e,n,a,Ne);case o:case s:case d:return Be(e,n,a,Re);case c:return Be(e,n,a,Fe);default:return e}}(e,o,s,!0)},onProcessResponse:c,groupChildItems:l,mapItemSetKey:function(){var n,a=new g.e({publisher:e});return a.mapKeys({mappings:(n={},n[y]=t.itemKey,n)}),{itemResolver:a}},scenarioInfo:{scenario:Ze.e.PopulateSharedWithMe,scenarioType:Ze.t.ActiveUserOperation}})))];case 4:return D=I.sent().itemResolver,i(D.execute()),[2]}})})}}),et=n(213),tt=n(404),nt=n(1633),at=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:d.e,facets:[d.e,m.e]})),e(c.e),e(Object(s.a)(d.e,tt.e)($e)),e(nt.e)}}),it=new _.e("sharedByMeRootItem",{endpoint:h.e}),rt=new _.e("sharedByMeItemSet",{driveItemKey:O.e.subKeyPart}),ot=n(367),st=n(685),ct=n(103),dt=n(264),lt=n(1006);function ut(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=i&&i.name;return{engagement:{objectType:"SharedByMe",datasource:"Graph",extraData:Object(a.__assign)({},"ItemsView.Load"===r?Object(lt.e)(e,{itemsScopeItemKey:n}):{})}}}function ft(e,t){return{engagement:{currentPage:"SharedByMe"}}}var pt=Object(i.t)(function(){return function(e){e(Object(st.e)(it,ct.e)(ut)),e(Object(st.e)(rt,ct.e)(ut)),e(Object(st.e)(it,dt.e)(ft))}}),mt=Object(ot.e)(it,function(e){return function(){return{defaultChildItemSet:{itemKey:rt.serialize({driveItemKey:e})},displayName:J.r,icon:void 0}}},pt),_t=!he.e.isActivated("519F99F6-DD95-455D-8604-464641B5540D","06/13/2022","Do NOT request thumbnails from SBY API"),ht=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return t=e.itemKey,i=rt.deserialize(t).driveItemKey.endpoint,r=n(Object(u.i)(i)),[4,n(Oe(Object(a.__assign)(Object(a.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:rt,parentItemKeyFacet:it,disableRemoteItem:!1,getUrl:function(e){var t="".concat(i,"/drive/shared"),n=_t&&r?"":"$expand=thumbnails";return"".concat(t,"?").concat(n,"&").concat("$select=*,fileSystemInfo,folder,reactions,bundle,webDavUrl,package")}})))];case 1:return o=s.sent().itemResolver,n(o.execute()),[2]}})})}}),bt=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:it,facets:[it,w.u,w.m,w._,w.A,w.i,w.c,m.t,w.k,ee.n]})),e(Object(et.t)({keyFacet:rt,facets:[rt,m.e]})),e(mt),e(Object(s.a)(rt,tt.e)(ht)),e(pt)}}),gt=n(968),vt=n(320),yt=n(1002),St=n(241);function Dt(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(vt.e,i);if(n&&r){for(var o=[],s=0,c=n;s<c.length;s++){var d=c[s];if(d.key===St.l.key)o.push("photo");else if(d.key===St.u.key)o.push("video");else if(d.key===St.a.key)o.push("folder");else if(d.key===St.n.key)o.push("file");else if(d.key===St.d.key)o.push("onenote");else if(d.key===St.s.key)o.push("!photo");else if(d.key===St.c.key)o.push("!video");else if(d.key===St.r.key)o.push("!folder");else if(d.key===St.o.key)o.push("!onenote");else{var l=Object(yt.e)(d);l&&o.push(l)}}return{itemKey:vt.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{filters:o}))}}return{}}var It,xt=n(1539),Ct=n(147),Ot=n(552),wt=n(543),Et=new _.e("recentGroup",{recentItemSet:vt.e.subKeyPart,relativeTime:Object(wt.e)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})}),At=864e5;function Lt(e,t){return e.toDateString()===t.toDateString()}!function(e){e.today="today",e.yesterday="testerday",e.thisWeek="thisWeek",e.lastWeek="lastWeek",e.twoWeeksAgo="twoWeeksAgo",e.threeWeeksAgo="threeWeeksAgo",e.thisMonth="thisMonth",e.lastMonth="lastMonth",e.twoMonthsAgo="twoMonthsAgo",e.older="older"}(It||(It={}));var kt=n(1209),Mt=n(3951),Pt=n(1040),Tt=!he.t.isActivated("670094E2-09D8-4B36-90FB-B7EF6BA067C9","04/06/2022","Add support for `photo` and `video` filters for the picker");function Ut(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," or ").concat(t,")"):t||e})}function Ft(e){return e.reduce(function(e,t){return e&&t?"(".concat(e," and ").concat(t,")"):t||e})}function Ht(e){return function(t){for(var n=void 0,a=void 0,i=0;i<e.length;i++){var r=e[i],o=!1,s=r;if(Object(kt.e)(r)&&(s=Object(kt.t)(r),o=!0),"."===s[0])if(t.name){var c=new RegExp("".concat(s.toLocaleLowerCase(),"$")),d=t.name.toLocaleLowerCase().split(c),l=2===d.length&&""===d[1]||!1;o?n=void 0!==n?n&&!l:l:a=a||l}else n=!1,a=!1;else if("folder"===s){var u=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!u:u:a=a||u}else if("onenote"===s){var f=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!f:f:a=a||f}else if("photo"===s&&Tt){var p=void 0!==t.photo||void 0!==t.image;o?n=void 0!==n?n&&!p:p:a=a||p}else if("video"===s&&Tt){var m=!!t.video;o?n=void 0!==n?n&&!m:m:a=a||m}}return void 0===a?void 0!==n&&n:(void 0===n||n)&&!a}}var Rt=n(4491),Nt=!he.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated."),Bt=!he.e.isActivated("667B27A0-823E-489C-B1CF-3AA1F1E5C454","04/09/2022","Enable the Older grouping for list items in Recent pivot"),jt=!he.e.isActivated("213A4632-291F-4C56-A70F-D16FF269A867","04/07/2022","Enforce maxmimum filter complexity for Graph Recent API"),Vt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},zt=Object(i.i)()(function(e){var t=this,n=vt.e.deserialize(e.itemKey),i=n.filters,r=void 0===i?[]:i,o=n.groupBy,s=void 0===o?"":o,c=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.photo,Ee.e.video],fileTypeIconMap:Ot.e}),d=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.photo],fileTypeIconMap:Ot.e}),p=Object(ke.e)({extFilters:Object(ke.t)(r),allowedMediaTypes:[Ee.e.video],fileTypeIconMap:Ot.e});return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,_,h,b,v,y,D,I,x,C,E,A,L,k,M,P,T,U,F,H,R,N,j,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne;return Object(a.__generator)(this,function(ae){switch(ae.label){case 0:return t=i(Object(f.e)({graphRecentEndpoint:S.I,enableOverflowRecentGroup:S.u,convergenceConfiguration:be.e,enableRecentVroom21Takeover:S.p})),o=t.graphRecentEndpoint,_=t.enableOverflowRecentGroup,h=void 0===_?Bt:_,b=t.convergenceConfiguration,v=t.enableRecentVroom21Takeover,y=n,o?(y=Object(a.__assign)(Object(a.__assign)({},y),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},y.driveItemKey),{endpoint:o})}),[3,3]):[3,1];case 1:return[4,i(Xe({endpoint:y.driveItemKey.endpoint}))];case 2:(D=ae.sent())!==y.driveItemKey.endpoint&&(y=Object(a.__assign)(Object(a.__assign)({},y),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},y.driveItemKey),{endpoint:D})})),ae.label=3;case 3:return I=vt.e.serialize(y),x=Et.serialize({recentItemSet:y,relativeTime:"today"}),C=Et.serialize({recentItemSet:y,relativeTime:"yesterday"}),E=Et.serialize({recentItemSet:y,relativeTime:"thisWeek"}),A=Et.serialize({recentItemSet:y,relativeTime:"lastWeek"}),L=Et.serialize({recentItemSet:y,relativeTime:"twoWeeksAgo"}),k=Et.serialize({recentItemSet:y,relativeTime:"threeWeeksAgo"}),M=Et.serialize({recentItemSet:y,relativeTime:"lastMonth"}),P=Et.serialize({recentItemSet:y,relativeTime:"twoMonthsAgo"}),T=Et.serialize({recentItemSet:y,relativeTime:"older"}),U=[],F=[],H=[],R=[],N=[],j=[],V=[],z=[],G=[],K="",W="date"===s,q=function(e){var t,n=e.driveItemKey,i=e.item,r=new g.e({publisher:q});if(i&&n){var o=i.remoteItem,s=o&&o.fileSystemInfo,c=s&&s.lastAccessedDateTime,d=O.e.serialize(n);if(W&&c){var l=new Date(c);switch(function(e){var t=new Date;return function(e,t){return Lt(t,e)}(e,t)?It.today:function(e,t){return Lt(new Date(t.getTime()-At),e)}(e,t)?It.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*At;return e.getTime()>n}(e,t)?It.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+7)*At;return e.getTime()>n}(e,t)?It.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n}(e,t)?It.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n}(e,t)?It.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(e,t)?It.thisMonth:function(e,t){return t.getMonth()-e.getMonth()==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(e,t)?It.lastMonth:function(e,t){var n=t.getFullYear(),a=e.getFullYear(),i=t.getMonth(),r=e.getMonth();return n===a&&i-r==2||n-a==1&&i-r==-10}(e,t)?It.twoMonthsAgo:It.older}(l)){case It.today:U.push(d);break;case It.yesterday:F.push(d);break;case It.thisWeek:H.push(d);break;case It.lastWeek:R.push(d);break;case It.twoWeeksAgo:N.push(d);break;case It.threeWeeksAgo:j.push(d);break;case It.lastMonth:V.push(d);break;case It.twoMonthsAgo:z.push(d),K=Ye[l.getMonth()];break;case It.older:default:G.push(d)}}return r.resolveItems({items:(t={},t[d]=Object(a.__assign)({},w._.pack(void 0)),t)}),{itemResolver:r}}},Q=!c&&W?function(t){var n,i,r=new g.e({publisher:Q});r.resolveItems({items:(n={},n[x]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.r)),B.r.pack(!0)),m.e.pack({itemKeys:U})),n[C]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.s)),B.r.pack(!0)),m.e.pack({itemKeys:F})),n[E]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.a)),B.r.pack(!0)),m.e.pack({itemKeys:H})),n[A]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.t)),B.r.pack(!0)),m.e.pack({itemKeys:R})),n[L]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.o)),B.r.pack(!0)),m.e.pack({itemKeys:N})),n[k]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.i)),B.r.pack(!0)),m.e.pack({itemKeys:j})),n[M]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.e)),B.r.pack(!0)),m.e.pack({itemKeys:V})),n[P]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(K)),B.r.pack(!0)),m.e.pack({itemKeys:z})),n[T]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(Rt.n)),B.r.pack(!0)),m.e.pack({itemKeys:G})),n)});var o=[];return U.length>0&&o.push(x),F.length>0&&o.push(C),H.length>0&&o.push(E),R.length>0&&o.push(A),N.length>0&&o.push(L),j.length>0&&o.push(k),V.length>0&&o.push(M),z.length>0&&o.push(P),G.length>0&&h&&o.push(T),r.resolveItems({items:(i={},i[e.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:o})),i)}),{itemResolver:r}}:void 0,Y=i(Object(u.i)(y.driveItemKey.endpoint)),J=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],X=Nt&&(null==b?void 0:b.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1",Z=he.e.isActivated("ec806106-9a41-4826-810d-712db11fef90","22/7/2022","Use RecentExcludeMediaApp in Prefer Header"),$=Z?"RecentOnlyMediaApp":"RecentExcludeMediaApp",[4,i(Oe(Object(a.__assign)(Object(a.__assign)({},e),{qosName:c?"recentMedia":Y?"ODC-recent":"recent",itemKey:I,itemSetKeyFacet:vt.e,parentItemKeyFacet:Ct.e,getUrl:function(e){var t="".concat(Object(l.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"}),"/recent?"),n=he.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if(Y)t="".concat(e.driveItemKey.endpoint,"/drive/view.recent?");else{if(d&&!n){var i="$filter=(remoteItem/image ne null)",o="$expand=thumbnails";return"".concat(t).concat(i,"&").concat(o)}if(p&&!n)return i="$filter=(remoteItem/image eq null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o);if(c)return i="$filter=(remoteItem/image ne null or remoteItem/video ne null)",o="$expand=thumbnails","".concat(t).concat(i,"&").concat(o)}return"".concat(t).concat(function(e){if(!e||0===e.length||jt&&e.length>8)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(kt.e)(r)&&(s=Object(kt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]||!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ut(t):0===t.length?Ft(n):Ft(Object(a.__spreadArray)([Ut(t)],n,!0))):""}(r))},getDriveItemFacets:Gt,expectedErrors:J,preprocessResponse:function(e){return X.indexOf("2.1")<0&&!v&&(d?e=Vt(e,"image"):p&&(e=Vt(e,"video|^application"))),(t=e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,a=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||a?n?a?n>a?-1:1:-1:1:0}))?t.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t}):t;var t},additionalHeaders:c?{Prefer:"".concat(X,",").concat($,",NoPreAuthThumbnailUrls")}:{Prefer:"".concat(X,";ODC,returnparentresource,returnowner")},onProcessResponse:q,groupChildItems:Q,scenarioInfo:{scenario:Ze.e.PopulateRecentFiles,scenarioType:Ze.t.ActiveUserOperation}})))];case 4:return ee=ae.sent().itemResolver,c&&ee.resolveItems({items:(te={},te[e.itemKey]=Object(a.__assign)({},B.s.pack({})),te)}),ee.mapKeys({mappings:(ne={},ne[I]=e.itemKey,ne)}),i(ee.execute()),[2]}})})}});function Gt(e){return function(t){var n,i=new g.e({publisher:Gt});i.merge(t(Object(C.e)(e)).itemResolver);var r=e.driveItem,o=r.thumbnails,s=r.remoteItem,c=o||s&&s.thumbnails;return i.resolveItems({items:(n={},n[e.itemKey]=Object(a.__assign)({},c?Object(a.__assign)({},re.e.pack(!1)):{}),n)}),{itemResolver:i}}}var Kt=n(1632),Wt=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:vt.e,facets:[vt.e,m.e]})),e(xt.e),e(Object(s.a)(vt.e,tt.e)(zt)),e(Object(st.e)(vt.e,gt.e)(Dt)),e(Kt.e)}}),qt=n(108),Qt=he.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated.");function Yt(){return function(e){return!e(Object(f.e)({isWinApp:S.E})).isWinApp&&!Qt}}var Jt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=O.e.deserialize(n);return function(r){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,o,s,c,d,p,m,_,h,b,g,v,y,D,I;return Object(a.__generator)(this,function(x){switch(x.label){case 0:return t=i,r(Object(N.e)(function(e){return e.demandItemFacet(w.d,n)}))?[2]:i.driveId&&"me"!==i.driveId?[3,2]:[4,r(Xe({endpoint:i.endpoint}))];case 1:(o=x.sent())!==i.endpoint&&(t=Object(a.__assign)(Object(a.__assign)({},i),{endpoint:o})),x.label=2;case 2:return s=Object(l.n)(t),c=i.driveId,d=r(Object(f.e)({disableRemoteItemInPlace:S.i})).disableRemoteItemInPlace,p=d?_e:R,[4,r(Object(u.i)(t.endpoint))];case 3:return m=x.sent(),_=r(Yt())&&m,[4,r(Object(u.n)({url:"".concat(Object(l.t)(t),"?$expand=thumbnails"),driveUrl:s,driveId:c,qosName:"getItem",useMultiPartIfSupported:_,endpoint:t.endpoint}))];case 4:return h=x.sent(),b=r(p({driveItemResponse:h,endpoint:t.endpoint})),g=b.itemResolver,v=b.actualItemKey,g.resolveItems({items:(y={},y[e.itemKey]=Object(a.__assign)({},qt.i.pack(O.e)),y)}),g.mapKeys({mappings:(D={},D[v]=n,D)}),i.driveId&&"me"!==i.driveId||g.mapKeys({mappings:(I={},I[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{driveId:""})),I[n]=O.e.serialize(t),I)}),r(g.execute()),[2]}})})}}),Xt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=b.deserialize(i),o=r.setItemKey,s=r.endpoint,c=r.token,d=_.e.get(o).deserialize(o),h=d.extFilters,y=d.driveItemKey,D=Object(l.n)(y),I=z.e.matches(o);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,d,l,_,x,E,A,L,k,M,P,T,U,H,R,N,B,j,V,z,G,K;return Object(a.__generator)(this,function(W){switch(W.label){case 0:return[4,t(Object(u.i)(s))];case 1:return n=W.sent(),r=t(Yt())&&n,[4,t(Object(u.t)({endpoint:s,url:c,driveUrl:D,driveId:y.driveId,useMultiPartIfSupported:r,qosName:"getChildrenPage"}))];case 2:for(d=W.sent(),l=h&&h.length>0?Ht(h):void 0,_=new g.e({publisher:e}),x=[],E=0,A=d.value;E<A.length;E++)L=A[E],l&&l(L)||(k=L&&(L.parentReference||L.remoteItem&&L.remoteItem.parentReference),M=k&&k.driveId,P=O.e.serialize({itemId:L.id,driveId:M,endpoint:s}),T=null==k?void 0:k.id,U=(null==k?void 0:k.path)===F.e?F.a:T||void 0,H=k?O.e.serialize({itemId:U,driveId:M,endpoint:s}):void 0,R=t(Object(f.e)({allowDisableRemoteItemInPlace:S.i,processDriveItemFromSharePoint:S.M})),N=R.allowDisableRemoteItemInPlace,B=R.processDriveItemFromSharePoint,j=I&&N?me:C.e,x.push(P),_.merge(t(j({itemKey:P,driveItem:L,endpoint:s,parentFolderItemKey:H})).itemResolver),_.resolveItems({items:(K={},K[P]=Object(a.__assign)({},Object(p.e)().forFacet(w.u).thenInvalidate(i,m.e).forFacet(w.d).thenInvalidate(i,m.e).pack()),K)}),B&&(V=t(B.process({itemKey:P,driveItem:L})).itemResolver,_.merge(V)));return(z=d["@odata.nextLink"])&&(G=b.serialize({setItemKey:o,endpoint:s,token:z}),_.merge(Object(v.t)({itemKey:G}).itemResolver),x.push(G)),_.merge(Object(v.e)({itemKey:i,itemSetKey:o,childItemKeys:x}).itemResolver),t(_.execute()),[2]}})})}}),Zt=n(445),$t=n(159),en=n(3422),tn=!he.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error");function nn(e,t){var n=Object(k.t)({},{});return e instanceof Zt.e&&(n=Object(Zt.t)(e,function(n){var i,r;switch(n){case 404:return $t.p.pack({});case"sharingPasswordRequired":if(tn)return Object(a.__assign)(Object(a.__assign)({},en.e.pack({fixItUrl:null===(r=null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.error)||void 0===r?void 0:r.fixItUrl})),$t.e.pack({}));case 401:return $t.e.pack({});case 0:return $t.g.pack({domain:new x.e(t).domain})}})||Object(k.t)({},{})),n}var an,rn=n(3952),on=new k.e("enableListViewDataPrefetchConfiguration"),sn=(new k.e("enableQuotaPrefetchConfiguration"),new k.e("prefetchCacheConfiguration")),cn=((an={})[fe.r]="name",an[fe.s]="lastModifiedDateTime",an[fe.d]="size",an[fe.n]="photo/takenDateTime",an),dn=!he.e.isActivated("03493AC3-19D5-41B4-819C-AA79F8EF0A6B","07/14/2022","Add special Folder to the select query"),ln="HonorNonIndexedQueriesWarningMayFailRandomly",un=he.e.isActivated("E4E006D3-AD74-4A5E-AD82-20E4FDF57586","12/01/2022","Add A2OD prefer header in request to get shortcut remoteitem")?ln:"".concat(ln,", ").concat("Include-Feature=AddToOneDrive"),fn="Migration=EnableRedirect;FailOnMigratedFiles",pn=!he.e.isActivated("0EE393E4-FFA7-42F0-A80F-087B337FC123","04/01/2022","Restrict `loadAndProcessPagedDriveItemSet` to throw 1 error. Throw child error with preference if both child and parent response throw."),mn=!he.e.isActivated("E0D4E3B7-F0E1-41FE-BDB6-DCFF1C62CA43","04/01/2022","Process parent item error, and add handling for `sharingPasswordRequired` error"),_n=!he.e.isActivated("FC3A83FA-3DF5-4FF4-8DD8-A0B87B3136CC","06/07/2022","Check if the parent item is resolved or not using resolvedAsKeyFacetFacet"),hn=!he.e.isActivated("3601D612-C2B7-4B43-9EE4-DD98BBE9A680","09/12/2022","Allows processing of user migrated error in ODC prefetch");function bn(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,p,m,_,h,b,v,y,S,D,I,x,C,w,E,A,L,M,P,T,U,F,H,R,j,V,G,K,W,q,Q,Y,J,X,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe;return Object(a.__generator)(this,function(pe){switch(pe.label){case 0:return t=e.itemKey,i=e.top,r=e.skip,o=e.disableRemoteItemInPlace,s=z.e.deserialize(t),c=s.driveItemKey,d=s.extFilters,p=s.sortBy,m=s.isAscending,_=s,h=c,c.driveId&&"me"!==c.driveId?[3,2]:[4,n(Xe({endpoint:c.endpoint}))];case 1:(b=pe.sent())!==c.endpoint&&(h=Object(a.__assign)(Object(a.__assign)({},c),{endpoint:b}),_=Object(a.__assign)(Object(a.__assign)({},s),{driveItemKey:h})),pe.label=2;case 2:return v=O.e.serialize(h),y=Object(l.n)(h),S=h.driveId||"",[4,n(Object(N.e)(function(e){return{isParentItemResolved:_n?e.demandItemFacet(qt.i,v)===O.e:e.isItemFacetResolved(O.e,v),totalChildCount:e.isItemFacetResolved(B.e,v)?e.demandItemFacet(B.e,v):void 0,driveType:e.isItemFacetResolved(Z.e,v)?e.demandItemFacet(Z.e,v):void 0}}))];case 3:return D=pe.sent(),I=D.isParentItemResolved,x=D.totalChildCount,C=D.driveType,w=n(Object(u.i)(h.endpoint)),E=n(Yt())&&w,A=n(Object(f.e)({convergenceConfiguration:be.e,enableListViewDataPrefetchConfiguration:on,prefetchCache:sn})),L=A.convergenceConfiguration,M=A.enableListViewDataPrefetchConfiguration,P=A.prefetchCache,T=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}],U=L&&L.canHandleUserMigration,F=null==L?void 0:L.isMigratedContent,H=S&&F&&F(S),R=Promise.resolve(void 0),I||(me={driveItem:h}.driveItem,ge=_e=Object(l.t)(me),!he.e.isActivated("B3F7A11A-91E8-4B9E-A526-6FD1CBD81747","03/24/2022","add sharepointIds to api")&&_e&&(ge=_e+"?$select=*,sharepointIds"),j=ge,V="getItem",G=function(){return n(Object(u.n)({url:j,driveUrl:y,driveId:S,useMultiPartIfSupported:E,qosName:V,endpoint:h.endpoint,headers:w&&U?{Prefer:fn}:void 0,expectedErrors:w?T:void 0,scenarioInfo:{scenario:Ze.e.BrowseFiles,scenarioType:Ze.t.ActiveUserOperation}}))},M&&P?(J=P.getData({url:j,qosName:V}),R=J?J.catch(function(e){if(hn&&e instanceof Zt.e&&"userContentMigrated"===e.code)throw e;return G()}):G()):R=G()),K=function(e){var t=e.driveItem,n=e.skip,i=e.totalChildCount,r=e.isConsumerEndpoint,o=e.isMigratedContent,s=e.enableDefaultSortOrderFromBackend,c=e.sortBy,d=e.isAscending,u=e.extFilters,f=e.top,p=Object(l.t)(t),m=n?"&skiptoken=".concat(n+1,"/").concat(i,"&skip=").concat(n):"",_=s?"&orderby=folder,".concat(o?"name":"savedSortFieldValue"):"",h=c&&void 0!==d?function(e,t){return"&orderby=folder,".concat(cn[e]," ").concat(t?"asc":"desc")}(c,d):_,b=function(e){if(!e||0===e.length)return"";e.unshift("folder");for(var t=[],n=[],i=0,r=Object(Pt.e)(e);i<r.length;i++){var o=r[i],s=!1,c=o;if(Object(kt.e)(o)&&(c=Object(kt.t)(o),s=!0),s)return"";if(Object(Mt.e)(c))return"";if(!Tt)return"";if("media"===c)t.push("photo ne null"),t.push("video ne null");else if("photo"===c)t.push("photo ne null");else if("video"===c)t.push("video ne null");else{if("folder"!==c)return"";t.push("folder ne null")}}return t.length>0||n.length>0?"&$filter=".concat(0===n.length?Ut(t):0===t.length?Ft(n):Ft(Object(a.__spreadArray)([Ut(t)],n,!0))):""}(u),g=he.e.isActivated("B3F7A11A-91E8-4B9E-A526-6FD1CBD81747","03/24/2022","add sharepointIds to api")?"":",sharepointIds",v=dn?",specialFolder":"",y="thumbnails".concat(r?",lenses,tags":"");return"".concat(p,"/children?$top=").concat(f).concat(m).concat(h,"&$expand=").concat(y,"&select=*,ocr,webDavUrl").concat(g,",isRestricted,commentSettings").concat(v).concat(b)}({driveItem:c,skip:r,totalChildCount:x,isConsumerEndpoint:w,isMigratedContent:!!H,enableDefaultSortOrderFromBackend:rn.e,sortBy:p,isAscending:m,extFilters:d,top:i}),W="getChildren.folder",q=H?{Prefer:"".concat(un)}:void 0,Q=function(){return n(Object(u.n)({url:K,driveUrl:y,driveId:S,qosName:W,useMultiPartIfSupported:E,endpoint:h.endpoint,headers:w&&U?{Prefer:fn}:q,expectedErrors:T,scenarioInfo:{scenario:Ze.e.BrowseFiles,scenarioType:Ze.t.ActiveUserOperation}}))},M&&P?(J=P.getData({url:K,qosName:W}),Y=J?J.catch(function(e){if(hn&&e instanceof Zt.e&&"userContentMigrated"===e.code)throw e;return Q()}):Q()):Y=Q(),X=!1,De.e(Se.e.dataFetch.start)||(De.t(Se.e.dataFetch.start),X=!0),pn?[4,R.catch(function(t){te=mn?n(function(e,t){var n=e.error;return function(i){var r,o=nn(n,t),s=Object(k.n)({accessDeniedError:$t.e,passwordProtectedError:en.e},o),c=s.accessDeniedError,d=s.passwordProtectedError,l=new xe.e({facets:o,innerError:new xe.e(n)});if(c&&d){var u=new g.e;u.updateItems({items:(r={},r[e.itemKey]=Object(a.__assign)({},qt.t.pack(l)),r)}),i(u.execute())}return l}}(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint)):t})]:[3,6];case 4:return $=pe.sent(),[4,Y.catch(function(t){ne=n(gn(Object(a.__assign)(Object(a.__assign)({},e),{error:t,parentItemError:te}),h.endpoint))})];case 5:if(ee=pe.sent(),ne)throw ne;if(ee=ee,te)throw te;return[3,8];case 6:return ae=[Y.catch(function(t){throw n(gn(Object(a.__assign)(Object(a.__assign)({},e),{error:t}),h.endpoint))}),R],[4,Promise.all(ae)];case 7:ce=pe.sent(),ee=ce[0],$=ce[1],pe.label=8;case 8:return X&&De.t(Se.e.dataFetch.end),$&&($.folder&&(x=$.folder.childCount),$.parentReference&&$.parentReference.driveType&&(C=$.parentReference.driveType)),ie=n(Object(u.r)(h.endpoint,C)),(re=new g.e({publisher:bn})).mapKeys({mappings:(de={},de[z.e.serialize(_)]=e.itemKey,de[v]=O.e.serialize(s.driveItemKey),de)}),s.driveItemKey.driveId&&"me"!==s.driveItemKey.driveId||((null===(fe=null==$?void 0:$.parentReference)||void 0===fe?void 0:fe.driveId)&&re.mapKeys({mappings:(le={},le[z.e.serialize(Object(a.__assign)(Object(a.__assign)({},_),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},_.driveItemKey),{driveId:$.parentReference.driveId})}))]=e.itemKey,le)}),re.mapKeys({mappings:(ue={},ue[O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:"me"}))]=O.e.serialize(Object(a.__assign)(Object(a.__assign)({},s.driveItemKey),{driveId:""})),ue)})),se=(oe=re).merge,[4,n(Ie({itemKey:t,itemSetKeyFacet:z.e,parentItemKeyFacet:O.e,parentItemResponse:$,childItemsResponse:ee,disableRemoteItem:o,filterChildItems:d&&d.length>0?Ht(d):void 0,skip:r,enableRandomAccess:ie,totalChildCount:x,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new g.e({publisher:bn});return n&&i.resolveItems({items:(t={},t[O.e.serialize(n)]=Object(a.__assign)({},qt.i.pack(O.e)),t)}),{itemResolver:i}}}))];case 9:return se.apply(oe,[pe.sent().itemResolver]),[2,re]}var me,_e,ge})})}}function gn(e,t){var n=e.error,i=e.parentItemError;return function(r){var o,s=nn(n,t),c=Object(k.n)({itemNotFoundError:$t.p,accessDeniedError:$t.e,networkBlockedError:$t.g},s),d=c.itemNotFoundError,l=c.accessDeniedError,u=c.networkBlockedError,f=Object(k.n)({passwordProtectedError:en.e},i instanceof xe.e?i.facets:Object(k.t)({},{})).passwordProtectedError,p=new xe.e({facets:Object(a.__assign)(Object(a.__assign)({},s),f?en.e.pack(f):{}),innerError:new xe.e(n)});if(d||l||u){var _=new g.e;_.updateItems({items:(o={},o[e.itemKey]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},m.e.pack(void 0)),m.o.pack(void 0)),qt.t.pack(p)),o)}),r(_.execute())}return p}}var vn=Object(i.i)()(function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return t=n(Object(f.e)({pageSize:S.r})).pageSize,[4,n(bn(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||F.t})))];case 1:return i=r.sent(),De.t(Se.e.resolveData.start),n(i.execute()),De.t(Se.e.resolveData.end),[2]}})})}}),yn=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(et.t)({keyFacet:z.e,facets:[z.e,m.e]})),e(Object(s.a)(z.e,tt.e)(vn)),[2]})})}}),Sn=n(40),Dn=n(131),In=n(348),xn=n(466);function Cn(e,t){var n=t.folderItemKey,i=t.itemSet;if(n&&i){var r=e.demandItemFacet(K.e,n),o=function(e,t){return!("photo"===(null==e?void 0:e.folderType))&&t===fe.t}(null==r?void 0:r.folder,i.sortBy)?"":i.sortBy;return Object(a.__assign)(Object(a.__assign)({},i),{sortBy:o})}return i}function On(e,t){var n,i,r=Object(Sn.e)(e),o={},s=e.demandItemFacet(z.e,t.itemKey),c=e.demandItemFacet(O.e,t.itemKey),d=e.demandItemFacet(q.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(W.e,t.itemKey,{suppressGetItems:!0});if(he.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey)return i={driveItemKey:l,sortBy:"",isAscending:!0},f=z.e.serialize(i),Object(a.__assign)(Object(a.__assign)({},wn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:In.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}else if(d&&t.itemKey){var u=e.demandItemFacet(O.e,d.itemKey);if(u){i={driveItemKey:u,sortBy:"",isAscending:!0};var f=z.e.serialize(i);return Object(a.__assign)(Object(a.__assign)({},wn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:In.e.serialize({localItemKey:t.itemKey,remoteItemKey:f})})}}if(s){var p=c||s.driveItemKey;i=Cn(e,{folderItemKey:O.e.serialize(p),itemSet:s}),n=wn(0,{itemSetKey:z.e.serialize(i||s),parentItemKey:O.e.serialize(s.driveItemKey),stageItem:t.stageItem}),o={itemKey:t.itemKey}}else i=function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var r=e.demandItemFacet(z.e,i),o=e.demandItemFacet(O.e,n);if(r&&o){if(!he.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(w._,n))return;var s=o.endpoint,c=o.driveId,d=o.itemId;return Object(a.__assign)(Object(a.__assign)({},r),{driveItemKey:{endpoint:s,driveId:c,itemId:d}})}}}(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),o=(f=(i=Cn(e,{folderItemKey:t.itemKey,itemSet:i}))?z.e.serialize(i):void 0)?{itemKey:f}:{},n=i&&f&&wn(0,{itemSetKey:f,parentItemKey:O.e.serialize(i.driveItemKey),stageItem:t.stageItem});var m=Object(xn.e)(e),_=m?e.demandItemFacet(O.e,m.localItemKey):void 0;if(m&&(i||o||c)){var h=_&&_.driveId,b=s&&s.driveItemKey&&s.driveItemKey.driveId||c&&c.driveId,g=i?z.e.serialize(i):s?z.e.serialize(s):c?O.e.serialize(c):void 0;if(h!==b&&g)return Object(a.__assign)({itemKey:In.e.serialize({localItemKey:m.localItemKey,remoteItemKey:g})},n?{stageItem:n}:{})}return Object(a.__assign)(Object(a.__assign)({},o),n?{stageItem:n}:{})}function wn(e,t){var n=this,i=t.parentItemKey,r=t.itemSetKey,o=t.stageItem;if(i)return o?Object(Dn.t)(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return Object(a.__awaiter)(n,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return e(Object(et.e)({items:(n={},n[r]=Object(a.__assign)({},m.r.pack({itemKey:i})),n)})),[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:return c.sent(),[2]}})})}}):void 0}var En=n(253),An=n(372),Ln=new _.e("driveItemVirtualizedPage",{endpoint:h.e,setItemKey:h.e,skip:An.e,top:An.e}),kn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ln.deserialize(n),r=i.setItemKey,o=i.top,s=i.skip;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return[4,n(bn(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:r,disableRemoteItemInPlace:!1,skip:s,top:o})))];case 1:return(t=c.sent()).resolveItems({items:(i={},i[r]=Object(a.__assign)({},Object(p.e)().forFacet(m.e).thenInvalidate(e.itemKey,m.e).pack()),i)}),n(t.execute()),[2]}})})}}),Mn=n(1397),Pn=n(724);function Tn(e,t){var n=t.handlers,i=t.itemKey,r=e.demandItemFacet(z.e,i),o=e.demandItemFacet(Pn.e,i);if(n&&(r||o)){for(var s=[],c=0,d=n;c<d.length;c++){var l=d[c];if(l.key===St.l.key)s.push("photo");else if(l.key===St.u.key)s.push("video");else if(l.key===St.a.key)s.push("folder");else if(l.key===St.n.key)s.push("file");else if(l.key===St.d.key)s.push("onenote");else if(l.key===St.s.key)s.push("!photo");else if(l.key===St.c.key)s.push("!video");else if(l.key===St.r.key)s.push("!folder");else if(l.key===St.o.key)s.push("!onenote");else{var u=Object(yt.e)(l);u&&s.push(u)}}if(r)return{itemKey:z.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{extFilters:s}))}}return{}}var Un=n(1357),Fn=n(1429),Hn=n(1210);function Rn(e,t){return{validator:Hn.e}}var Nn=n(263);function Bn(e,t){var n,a,i=t.itemKey,r=Object(Nn.e)(e,{itemKey:i}),o=e.demandItemFacet(O.e,r),s=e.demandItemFacet(z.e,i),c=e.demandItemFacet(Pn.e,i);if(!o&&!s&&!c)return{};var d=null!==(a=null!==(n=null==c?void 0:c.driveItemKey)&&void 0!==n?n:null==s?void 0:s.driveItemKey)&&void 0!==a?a:o,l=null==d?void 0:d.endpoint,u=null==d?void 0:d.driveId,f=l&&u?e.demandItemFacet(O.e,O.e.serialize({endpoint:l,driveId:u,itemId:"root"})):void 0;return{isAvailable:!0,query:null==c?void 0:c.searchTerm,getSearchItemKey:function(e){var t;if(d)return Pn.e.serialize({driveItemKey:d,searchTerm:e||"",scope:null!==(t=null==c?void 0:c.scope)&&void 0!==t?t:(null==f?void 0:f.itemId)===(null==o?void 0:o.itemId)?"drive":"folder"})}}}var jn=n(1394),Vn=n(847),zn=n(1008),Gn=n(1197),Kn=n(875),Wn=n(782),qn=n(651),Qn=n(456),Yn=n(459),Jn=n(2725);function Xn(e,t){var n=t.itemKey;return e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(Jn.e,n)}}var Zn=n(59);function $n(e,t){var n=t.itemKey,a=Object(Zn.e)(e);return e.demandItemFacet(it,a)&&!e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(Jn.a,n),validator:Hn.e}}var ea=n("react-lib"),ta=n(51),na=n(4489),aa=n(185);function ia(e,t){var n=t.itemKey,a=e.demandItemFacet(Jn.t,n),i=e.demandItemFacet(W.e,n);return{isAvailable:a&&!i,deleteWizard:ra}}Object(aa.n)([{rawString:".informationContainer_9d9ce1da{background-color:#f3f2f1;border-radius:8px;box-sizing:border-box;display:flex;gap:8px;padding:8px 12px;width:100%}.informationContainer_9d9ce1da .infoIcon_9d9ce1da{color:#616161;font-family:FabricMDL2Icons;font-size:16px}.informationContainer_9d9ce1da .informationText_9d9ce1da{color:#242424;font-size:12px;line-height:16px;margin:0}"}]);var ra=Object(ta.t)(function(e,t){var n,i=t.itemKeys,r=t.defaultRender,o=Object(a.__rest)(t,["itemKeys","defaultRender"]),s=e.demandItemFacet(w.d,i[0]);if(1===i.length){var c=e.demandItemFacet(w.u,i[0]);n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?na.o:na.e,confirmText:s?We.format(na.r,c):na.t})}})}else i.length>0&&(n=Object(a.__assign)(Object(a.__assign)({},o),{getDeleteWizardStrings:function(e){return Object(a.__assign)(Object(a.__assign)({},o.getDeleteWizardStrings(e)),{confirmTitle:s?na.o:na.e,confirmText:s?na.i:na.n})}}));var d=!1;he.e.isActivated("940C7189-6004-4F43-BF51-0CC7401767E7","02/25/2022","Enable Photo story delete prompt when deleting an item used in photo story")||(d=i.some(function(t){return e.demandItemFacet(ue.e,t)}));var l=n||o;return r?ea.createElement(r,Object(a.__assign)({itemKeys:i},l),d&&ea.createElement("div",{className:"informationContainer_9d9ce1da"},ea.createElement("div",{className:"infoIcon_9d9ce1da"},""),ea.createElement("p",{className:"informationText_9d9ce1da"},na.a))):null});function oa(e,t){var n=t.itemKey;return e.demandItemFacet(oe.e,n)?{isAvailable:!1}:{isAvailable:e.demandItemFacet(Jn.i,n)}}function sa(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(w._,n))return{};var i=e.demandItemFacet(O.e,n),r=i?Object(l.t)(i):void 0,o=i?Object(l.n)(i):void 0,s=null==i?void 0:i.driveId,c=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(Jn.n,n),getDownloadData:r&&o?function(){return function(e){var t=this,n=e.itemUrl,i=e.driveUrl,r=e.driveId,o=e.endpoint;return function(s){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,s(Object(u.t)({url:e.itemUrl,driveUrl:i,driveId:r,method:"GET",qosName:"getItemDownloadUrl",endpoint:o}))];case 1:if(t=a.sent(),c=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"],!c)throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:c}];case 2:throw(d=a.sent())instanceof Zt.e?(l=Object(Zt.t)(d,function(e,t){switch(e){case"unauthenticated":case 401:return $t.a.pack({});case"itemNotFound":case 404:return $t.c.pack({});case"accessDenied":case 403:return $t.e.pack({});default:return $t.v.pack({})}}),new xe.e({innerError:d,facets:l})):d;case 3:return[2]}})})}}({itemUrl:r,driveUrl:o,driveId:s,endpoint:c})}:void 0}}function ca(e,t){var n=t.itemKey,i=e.demandItemFacet(O.e,n);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(t=e.driveItem)?(i=Object(l.t)(t)+"/invite",r=Object(l.n)(t),o=t.driveId,[4,n(Object(u.n)({url:i,driveUrl:r,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,driveId:o,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))]):[3,2];case 1:if(!(s=a.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:s.value[0].link.webUrl,scope:s.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:i})}}}function da(e,t){var n=t.itemKey,i=t.link,r=t.recipients,o=e.demandItemFacet(O.e,n);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,r,o,s,c,d,l,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(i=e.link,r=e.recipients,!(t=e.driveItem)||!i)throw new Error("Unable to obtain default share URL");return o=t.endpoint,s=t.driveId,d=btoa(i),c="u!"+d.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-"),l=r.map(function(e){return{email:e}}),f={recipients:l,roles:["read"]},p=o.replace("v1.0","beta"),m=p+"/shares/"+c+"/permission/grant",[4,n(Object(u.n)({url:m,driveId:s,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:f}))];case 1:return[2,{recipients:a.sent().value[0].grantedToIdentities.map(function(e){return{email:e.user.email}})}]}})})}}({driveItem:o,link:i,recipients:r})}}}var la=n(1242),ua=n(1557),fa=n(3957),pa=n(841),ma=n(2768),_a=n(3303),ha=!he.t.isActivated("9E25FA89-BCCC-4B1B-A51A-07D2E059CA43","06/16/2022","Enable shortcut tags in engagement extra data");function ba(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(z.e,r),c=(null==s?void 0:s.driveItemKey)||e.demandItemFacet(O.e,r),d=c&&Object(_a.e)(e,{driveItemKey:c}),l=e.demandItemFacet(In.e,r),u=void 0,f=void 0;if(ha)if(l)e.demandItemFacet(z.e,l.remoteItemKey)?u=!0:f=!0;else{var p=e.demandItemFacet(qe.n,n);f=!!e.demandItemFacet(In.e,p&&p.itemKey)}var m,_=c||{},h=_.driveId,b=void 0===h?"me":h,g=_.itemId,v=void 0===g?"root":g;return"me"===b&&"root"===v?m="MyFiles":(s||"root"===v)&&(m="Folder"),{engagement:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),m?{objectType:m}:{}),{extraData:Object(a.__assign)({itemGraphId:v,itemGraphDriveId:b,isOwner:!!d,isShortcut:u,isInsideAShortcut:f},"ItemsView.Load"===o?Object(lt.e)(e,{itemsScopeItemKey:n}):{})})}}function ga(e,t){var n=t.currentItemKey,a=e.demandItemFacet(z.e,n),i=(null==a?void 0:a.driveItemKey)||e.demandItemFacet(O.e,n)||{},r=i.driveId,o=void 0===r?"me":r,s=i.itemId;return{engagement:{currentPage:"me"===o&&"root"===(void 0===s?"root":s)?"MyFiles":"Folder"}}}var va=Object(i.t)(function(){return function(e){e(Object(st.e)(O.e,ct.e)(ba)),e(Object(st.e)(z.e,ct.e)(ba)),e(Object(st.e)(O.e,dt.e)(ga))}}),ya=Object(i.t)(function(){return function(e){var t=e(Object(f.e)({useBatchedDeleteConfiguration:S.N})).useBatchedDeleteConfiguration;e(Object(et.t)({keyFacet:O.e,facets:[O.e,w.u,w.m,w._,q.e,W.e,w.A,w.c,m.t,w.k,w.i,w.f,ee.n]})),e(Object(et.t)({keyFacet:b,facets:[b,m.e,m.a]})),e(yn),e(Object(s.a)(O.e,tt.e)(Jt)),e(Object(s.a)(Ln,tt.e)(kn)),e(Object(s.a)(b,tt.e)(Xt)),e(Object(st.e)(O.e,En.e)(On)),e(Object(st.e)(z.e,En.e)(On)),e(va),e(Object(st.e)(z.e,ma.e)(Bn)),e(Object(st.e)(z.e,gt.e)(Tn)),e(Object(s.a)(O.e,jn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(20).then(n.bind(null,4978))];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})}))),e(t?Object(s.a)(O.e,Vn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(493).then(n.bind(null,4979))];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.a)(O.e,Vn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(21).then(n.bind(null,4208))];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,zn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(23).then(n.bind(null,4980))];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})}))),e(Object(s.a)(O.e,Gn.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(24).then(n.bind(null,5169))];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Un.t)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(22).then(n.bind(null,4981))];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})}))),e(Object(s.a)(O.e,Mn.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(17).then(n.bind(null,4982))];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})}))),e(Object(st.e)(O.e,Kn.e)(Xn)),e(Object(st.e)(O.e,Fn.e)(Rn)),e(Object(st.e)(O.e,Wn.e)($n)),e(Object(st.e)(O.e,qn.t)(ia)),e(Object(st.e)(O.e,Qn.e)(oa)),e(Object(st.e)(O.e,la.e)(ca)),e(Object(st.e)(O.e,ua.e)(da)),e(Object(st.e)(O.e,Yn.t)(sa)),e(Object(st.e)(O.e,pa.e)(fa.e))}}),Sa=n(3304),Da=n(3302),Ia=he.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),xa=Object(i.i)()(function e(t){var n=this;return function(i){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=t.itemKey,r=Da.e.deserialize(n),o=r.endpoint,s=Object(l.n)(r),[4,i(Ca({url:Object(l.e)(r),driveUrl:s,qosName:"commands",endpoint:o}))];case 1:return c=f.sent(),(d=new g.e({publisher:e})).resolveItems({items:(u={},u[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},Sa.e.pack(c.addToOneDrive)),Sa.t.pack(c.createFolder)),Sa.n.pack(c.createLink)),Sa.a.pack(c.delete)),Sa.i.pack(c.download)),Sa.r.pack(c.invite)),Sa.o.pack(c.move)),Sa.s.pack(c.officeLens)),Sa.c.pack(c.rename)),Sa.d.pack(c.upload)),u)}),i(d.execute()),[2]}})})}});function Ca(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(a.__generator)(this,function(a){return t=e.endpoint,i=n(Object(u.i)(t)),[2,{addToOneDrive:{roles:Ia||i?["write"]:["owner","write","read"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Oa=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:Da.e,facets:[Sa.e,Sa.t,Sa.n,Sa.a,Sa.i,Sa.r,Sa.o,Sa.s,Sa.c,Sa.d]})),e(Object(s.a)(Da.e,tt.e)(xa))}});function wa(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,r=e.childItemsResponse,o=e.disableRemoteItem,s=e.parentItemResponse,c=e.mapItemSetKey,d=n.deserialize(t),l=i.serialize(d),u=d.driveItemKey.endpoint;return function(n){var i,d;De.t(Se.e.processData.start);var _=n(ye(Object(a.__assign)(Object(a.__assign)({},e),{response:r,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(c){var h=c().itemResolver;_.merge(h)}var b=n(Object(f.e)({allowDisableRemoteItemInPlace:S.i})).allowDisableRemoteItemInPlace;if(s){var g=n((b&&o?_e:R)({setItemKey:t,driveItemResponse:s,endpoint:u})),v=g.itemResolver,y=g.actualItemKey;_.mapKeys({mappings:(i={},i[y]=l,i)}),_.merge(v)}return _.resolveItems({items:(d={},d[l]=Object(a.__assign)({},Object(p.e)().forFacet(m.t).thenInvalidate(e.itemKey,m.e).pack()),d)}),De.t(Se.e.processData.end),{itemResolver:_}}}var Ea=he.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Aa(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,r=e.getUrl,o=e.sortChildItems,s=e.qosName,c=e.preprocessResponse,d=e.expectedErrors,f=e.disableRemoteItem,p=void 0!==f&&f,m=i.deserialize(n),_=m.driveItemKey,h=_.endpoint,b=_.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,i,f,_,g,v;return Object(a.__generator)(this,function(y){switch(y.label){case 0:t=Object(l.n)(m.driveItemKey),y.label=1;case 1:return y.trys.push([1,4,,5]),[4,n(Object(u.n)({url:r(m),driveUrl:t,driveId:b,qosName:"getChildren".concat(s?".".concat(s):""),endpoint:h,headers:e.additionalHeaders,expectedErrors:d,timeout:Ea?void 0:6e4,scenarioInfo:{scenario:Ze.e.Search,scenarioType:Ze.t.ActiveUserOperation}}))];case 2:return i=y.sent(),f=Object(a.__spreadArray)([],i.value,!0),_=c&&c(f)||i.value,g=o&&o(_)||_,[4,n(wa(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:p,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:y.sent().itemResolver}];case 4:throw v=y.sent(),new xe.e(Object(a.__assign)({code:"UnknownError"},v instanceof Error?{innerError:v}:{message:JSON.stringify(v)}));case 5:return[2]}})})}}var La=n(856),ka=Object(i.i)()(function(e){var t=this,n=Pn.e.deserialize(e.itemKey);return function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,r,o,s,c,d,l,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return t=i(Object(f.e)({graphSearchEndpoint:S.x,convergenceConfiguration:be.e,consumerDirectEndpoint:S.h})),r=t.graphSearchEndpoint,o=t.convergenceConfiguration,s=t.consumerDirectEndpoint,c=null==o?void 0:o.isUserMigrated,d=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}],l=n,r?(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:r})}),[3,3]):[3,1];case 1:return l.driveItemKey.driveId&&"me"!==l.driveItemKey.driveId?[3,3]:[4,i(Xe({endpoint:l.driveItemKey.endpoint}))];case 2:(p=b.sent())!==l.driveItemKey.endpoint&&(l=Object(a.__assign)(Object(a.__assign)({},l),{driveItemKey:Object(a.__assign)(Object(a.__assign)({},l.driveItemKey),{endpoint:p})})),b.label=3;case 3:return m=Pn.e.serialize(l),[4,i(Aa(Object(a.__assign)(Object(a.__assign)({},e),{itemKey:m,qosName:"search".concat(c?".migratedUser":""),itemSetKeyFacet:Pn.e,parentItemKeyFacet:La.e,getUrl:function(e){var t=e.driveItemKey,n=i(Object(u.i)(t.endpoint));return function(e,t,n,i){var r,o=e.searchTerm,s=e.extFilters,c=e.dateFilter,d=e.scope,l=e.driveItemKey;o&&(r=encodeURIComponent(o).replace(/'/g,"''"));var u=function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i],o=!1,s=r;Object(kt.e)(r)&&(s=Object(kt.t)(r),o=!0),"folder"===s?!o&&t.push("folder ne null"):"onenote"===s?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==s[0]?"audio"===s?!o&&t.push("audio ne null"):"document"===s?!o&&t.push("file ne null and video eq null and image eq null and audio eq null and folder eq null"):"media"===s&&!o&&t.push("image ne null or video ne null"):!o&&t.push("(endsWith(name, '".concat(s.toLowerCase(),"') or endsWith(remoteItem/name, '").concat(s.toLowerCase(),"'))"))}return t.length>0||n.length>0?"&$filter=( ".concat(0===n.length?Ut(t):0===t.length?Ft(n):Ft(Object(a.__spreadArray)([Ut(t)],n,!0))," )"):""}(s),f=function(e,t){return""!==e?"".concat(e).concat(t?" and ".concat(t):""):t?"&$filter=".concat(t):""}(u,(null==c?void 0:c.beginDate)?"( createdDateTime ge ".concat(c.beginDate," )"):"");if(t||i){var p=l;return n&&(p=Object(a.__assign)(Object(a.__assign)({},l),{endpoint:t?l.endpoint:n})),"".concat(Ma(d,p),"/oneDrive.search(q=@s)?@s='").concat(r,"'").concat(f,"&$expand=thumbnails&select=*,webDavUrl")}return"".concat(Ma(d,l),"/search(q=@s)?@s='").concat(r,"'&$expand=thumbnails&select=*,webDavUrl")}(l,n,s,c)},expectedErrors:d})))];case 4:return(_=b.sent().itemResolver).mapKeys({mappings:(h={},h[m]=e.itemKey,h)}),i(_.execute()),[2]}})})}});function Ma(e,t){return"drive"===e?Object(l.n)(t):Object(l.t)(t)}var Pa=Object(i.i)()(function(e){var t=this,n=La.e.deserialize(e.itemKey),i=n.searchTerm,r=n.driveItemKey,o=n.scope;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(a.__generator)(this,function(c){return t=We.format(J.i,i),n(Object(et.e)({items:(s={},s[e.itemKey]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(t)),m.t.pack(Object(a.__assign)(Object(a.__assign)({itemKey:Pn.e.serialize({driveItemKey:r,searchTerm:i,scope:o})},w._.pack({})),w.k.pack(void 0)))),s)})),[2]})})}}),Ta=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:La.e,facets:[w.u,m.t]})),e(Object(s.a)(La.e,tt.e)(Pa)),e(Object(et.t)({keyFacet:Pn.e,facets:[m.e]})),e(Object(s.a)(Pn.e,tt.e)(ka)),e(Object(st.e)(Pn.e,ma.e)(Bn))}}),Ua=n(4410),Fa=n(3958),Ha=n(761),Ra=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Q.e.deserialize(n).driveItemKey,r=i.endpoint,o=i.driveId;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,c,d,p,m,_,h,b=this;return Object(a.__generator)(this,function(g){return t={Caller:"HoverCard"},s=e(Object(f.e)({enableCookiesForAnalyticsRequests:S.c})).enableCookiesForAnalyticsRequests,c=void 0!==s&&s,d="GetItemAnalytics_addon-graph",p=Object(a.__awaiter)(b,void 0,void 0,function(){var s,f,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:return[4,e(Object(u.n)({url:(g=Object(l.t)(i),v=Na(g),y="$select=*".concat(",id,reactions").concat(",trending"),S="".concat(y,"&").concat("$expand=analytics($expand=allTime($expand=activities))").concat(",insights($expand=keyPoints)"),D="".concat(v,"?").concat(S),D),qosName:"".concat(d,"_GetAnalyticsSections"),endpoint:r,driveId:o,timeout:6e3,headers:t,driveUrl:Na(Object(l.n)(i)),allowCookies:c}))];case 1:return s=b.sent(),f=Object(Ua.t)(s),(p=f.createdBy)&&(m=P.e.serialize({email:p.email,endpoint:r}),e(Object(et.e)({items:(_={},_[m]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},w.u.pack(p.displayName)),L.e.pack(p.email)),L.a.pack(p.image)),L.i.pack(p.id)),_[n]=Object(a.__assign)({},A.a.pack({itemKey:m,displayValue:p.displayName})),_)}))),e(Object(et.e)({items:(h={},h[n]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},A.f.pack(f.viewCount)),A.p.pack(f.viewerCount)),A.o.pack(f.isTrending)),A.e.pack(f.activities)),A.d.pack(f.likeCount)),A.t.pack(f.commentCount)),A.c.pack(f.lifeCycleStatus)),A.s.pack(f.keyPointsData)),A.r.pack(f.incompleteData)),A.i.pack(f.createdDateTime)),h)})),[2]}var g,v,y,S,D})}),m=[p],_=Object(a.__awaiter)(b,void 0,void 0,function(){var o,s,f,p;return Object(a.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(u.n)({url:(_=Object(l.t)(i),h=Na(_),"".concat(h).concat("?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))")),qosName:"".concat(d,"_GetRecommendedActionsAndConversations"),endpoint:r,timeout:6e3,headers:t,driveUrl:Na(Object(l.n)(i)),allowCookies:c}))];case 1:return o=m.sent(),s=function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;return t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction)),n}(o),f=function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),a={},i=[];return n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;a.hasOwnProperty(t)||(a[t]=!0,i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Fa.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants}))}),i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}(o),e(Object(et.e)({items:(p={},p[n]=Object(a.__assign)(Object(a.__assign)({},A.l.pack(s)),A.n.pack(f)),p)})),[2]}var _,h})}),m.push(_),e(Object(et.e)({items:(h={},h[n]=Object(a.__assign)({},A.u.pack([])),h)})),[2,Object(Ha.e)(m)]})})}});function Na(e){return e.replace("2.0","2.1")}var Ba=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:Q.e,facets:[A.f]})),e(Object(s.a)(Q.e,tt.e)(Ra))}}),ja=n(2979),Va=n(1577),za=n(323),Ga=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=E.e.deserialize(e.itemKey).driveItemKey,a=n.endpoint,i=n.driveId,r=E.e.deserialize(t.itemKey).driveItemKey,o=r.endpoint,s=r.driveId;return!!i&&!!s&&i===s&&a===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,c,d,f,m,_,h,b,v,y,S,D,I,x,C,A,L,k,M,P,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(n=Object.keys(i),r=n[0],o=E.e.deserialize(r),s=o.driveItemKey,c=s.endpoint,d=s.driveId,!c)throw new Error("No endpoint to determine activity items.");return f=n.map(function(e){return E.e.deserialize(e).driveItemKey.itemId}),m=Object(l.n)({endpoint:(z=c,z.replace("2.1","2.0")),driveId:d}),_="".concat(m,"/ExtendedActivitiesForItems"),h={driveItems:f,badgeOnly:!0},[4,t(Object(u.t)({url:_,method:"POST",body:h,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:c,driveId:d}))];case 1:if((b=V.sent()).value){for(v=function(e){for(var t={},n=0,a=e;n<a.length;n++){var i=a[n],r=i.driveItemId;r&&(t[r]||(t[r]=[])).push(i)}return t}(b.value),y=0,S=0,D=0,I=0,x=new g.e({publisher:e}),C=0,A=n;C<A.length;C++)L=A[C],y++,k=E.e.deserialize(L),M=k.driveItemKey.itemId,P=M&&v[M],T=O.e.serialize(k.driveItemKey),U=void 0,P&&(F=new ja.e,H=F.processResponse({item:{name:M||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:_},response:{value:P,"@odata.nextLink":""}}).activities,R=Ka(H),(N=Wa(H))&&(D++,S++,R||(I++,B=qa(N,L).itemResolver,x.merge(B),U=N))),x.resolveItems({items:(j={},j[L]=Object(a.__assign)({},Va.e.pack(U)),j[T]=Object(a.__assign)({},Object(p.e)().forFacet(w.e).thenInvalidate(L,Va.e).pack()),j)});t(x.execute()),t(Object(za.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:y,activityFieldEligibleItemCount:S,activityFieldActiveItemCount:D,activityFieldBadgedItemCount:I,activityFieldBadgedPercent:y?Math.round(I/y*100):0},isIntentional:!1}))}return[2]}var z})})}});function Ka(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function Wa(e){var t=e[0],n={};if(t)for(var i=0,r=t.actors;i<r.length;i++)(l=r[i]).id&&(n[l.id]=!0);for(var o=Object(a.__assign)(Object(a.__assign)({},t),{actors:Object(a.__spreadArray)([],t.actors||[],!0)}),s=1;s<e.length;s++)for(var c=0,d=e[s].actors;c<d.length;c++){var l;"string"!=typeof(l=d[c]).id||n[l.id]||(o.actors.push(l),n[l.id]=!0)}return o||t}function qa(e,t){var n=new g.e({publisher:qa}),i=E.e.deserialize(t).driveItemKey,r=function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],r=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],t,!0),n,!0),i,!0);return r&&o.push(r),o}(e);if(r.length>0){var o=Qa(r,i).itemResolver;n.merge(o)}return{itemResolver:n}}function Qa(e,t){for(var n=new g.e({publisher:Qa}),a=0,i=e;a<i.length;a++){var r=Ya(i[a],t).itemResolver;n.merge(r)}return{itemResolver:n}}function Ya(e,t){var n=new g.e({publisher:Ya}),a=U({itemKey:O.e.serialize(t),userKey:P.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;return n.merge(a),{itemResolver:n}}var Ja=Object(i.t)(function(){return function(e){e(Object(s.a)(E.e,tt.e)(Ga)),e(Object(s.a)(E.e,tt.e)(Ga))}}),Xa=new _.e("sharesItem",{endpoint:h.e,shareId:h.e}),Za=n(327),$a=Object(i.i)({maxParallelOperationCount:8})(function e(t){var n=this,i=t.itemKey,r=Xa.deserialize(i),o=r.endpoint;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,s,c,d,p,_,h,b,v,y,D,I,x,w,E,A;return Object(a.__generator)(this,function(L){switch(L.label){case 0:return n=t(Object(f.e)({graphEndpoint:S.y,graphRecentEndpoint:S.I})),s=n.graphEndpoint,c=n.graphRecentEndpoint,[4,t(Object(u.t)({url:"".concat(Object(l.a)(r),"?$expand=thumbnails&select=*,webDavUrl"),qosName:"getSharesItem",endpoint:o,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:return d=L.sent(),p=new g.e({publisher:e}),_=d&&d.parentReference,h=_&&_.driveId,b={endpoint:o,driveId:h,itemId:d.id},v=O.e.serialize(b),y=_&&_.id?O.e.serialize({endpoint:o,driveId:h,itemId:_.id}):void 0,p.merge(t(Object(C.e)({itemKey:v,driveItem:d,endpoint:o,parentFolderItemKey:y})).itemResolver),D=t(Object(f.e)({processDriveItemFromSharePoint:S.M})).processDriveItemFromSharePoint,I=o.indexOf("/_api/v2.0")>-1||o.indexOf("/_api/v2.1")>-1,x=s||c,D&&(I||x)&&(w=t(D.process({itemKey:v,driveItem:d})).itemResolver,p.merge(w)),p.resolveItems({items:(E={},E[v]=Object(a.__assign)(Object(a.__assign)({},Za.n.pack(O.e)),m.t.pack({itemKey:z.e.serialize({driveItemKey:b,sortBy:"",isAscending:!0})})),E)}),p.mapKeys({mappings:(A={},A[v]=i,A)}),t(p.execute()),[2]}})})}}),ei=Object(i.t)(function(){return function(e){e(Object(s.a)(Xa,tt.e)($a))}}),ti=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(ya),e(Oa),e(Ba),e(o.e),e(r.e),e(Wt),e(at),e(bt),e(Ta),e(Ja),e(ei),[2]})})}}),ni=n(43),ai=n(506),ii=n(82),ri=Object(i.t)(function(){return function(e){e(Object(st.e)(O.e,ai.e)(e(Object(ni.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(ii.c)())];case 1:return t.sent(),[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e(13)]).then(n.bind(null,4872))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})}))))}}),oi=n(415),si=n(496),ci=n(828),di=n(716),li=n(74),ui=n(228),fi=n(658),pi=n(30),mi=n(198),_i=n(291),hi=n(180),bi=Object(li.i)({key:new k.e("dateAccessedColumn").id,name:ui.e,fieldName:"",minWidth:li.e.regularMin,maxWidth:li.e.regularMax,isCollapsable:!0,data:{facets:Object(a.__assign)({},hi.e.pack("dateAccessed"))}},fi.e)(function(e,t){var n=e.demandItemFacet(w.o,t,{suppressGetItems:!0}),a=n&&new Date(n).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(pi.O,mi.e),r=i&&i.language||window.navigator.language;return r?{text:Object(_i.n)(new Date(a),r)}:{dateValue:a}},function(e,t){return"".concat(e.demandItemFacet(w.o,t))}),gi=n(2995),vi=Object(a.__assign)(Object(a.__assign)({},gi.e),{columnActionsMode:ci.t.disabled}),yi=Object(a.__assign)(Object(a.__assign)({},bi),{columnActionsMode:ci.t.disabled}),Si=he.e.isActivated("E4DF8572-56CE-4708-A3CB-DB9720F1B163","09/19/2022","Disable column header action on Recent ItemSet since no action avaible")?[di.t,gi.e,bi]:[di.t,vi,yi];function Di(e,t){return{columns:Si}}var Ii=n(274),xi=n(311),Ci=n(250),Oi=n(965),wi=n(3253),Ei=n(3783),Ai=[xi.e,Ei.e,Ci.n,Ci.t,Oi.e];function Li(e,t){var n=function(e,t){for(var n=[],a=0,i=t.defaultCommands;a<i.length;a++){var r=i[a];r.key===xi.e.key?n.push(wi.e):n.push(r)}return{overrideDefaultCommands:n}}(0,{defaultCommands:Ai}).overrideDefaultCommands;return{commands:n}}var ki=n(4197),Mi=n(451);function Pi(e,t){return{isAvailable:!1}}var Ti=n(1253),Ui=n(1025);function Fi(e,t){var n=e.demandItemFacet(vt.e,t.itemKey),i=!!e.demandItemFacet(B.s,t.itemKey)||(null==n?void 0:n.filters)&&Object(ke.e)({extFilters:Object(ke.t)(n.filters),allowedMediaTypes:[Ee.e.photo,Ee.e.video],fileTypeIconMap:Ot.e});return Object(a.__assign)({},i?{defaultLayout:Ui.t.layoutType,isLayoutResolved:!0}:{layouts:[Ti.t,Ti.e]})}var Hi=n(997),Ri=n(2994),Ni=n(3953),Bi=n(4200),ji=n(1203),Vi=n(1431),zi=Object(li.i)({key:Ue.t,name:ui.t,fieldName:"",minWidth:li.e.regularMin,maxWidth:li.e.regularMax,isCollapsable:!0,sortProps:li.t,data:{facets:Object(a.__assign)({},hi.e.pack("dateTaken"))}},Vi.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return"".concat(e.demandItemFacet(X.c,t,{suppressGetItems:!0}))}),Gi=n(1061),Ki=n(1230),Wi=n(574),qi=n(3948),Qi=he.e.isActivated("22B8A337-05E5-4246-A042-4589C0F3DF7A","11/30/2022","add location column"),Yi=Object(a.__assign)(Object(a.__assign)({},qi.e),{name:Bi.e});Object(a.__spreadArray)(Object(a.__spreadArray)([di.e,Wi.t,ji.e,Ki.e],Qi?[]:[Yi],!0),[Gi.e],!1),Object(a.__spreadArray)(Object(a.__spreadArray)([di.e,Wi.t,ji.e,zi,Ki.e],Qi?[]:[Yi],!0),[Gi.e],!1);var Ji=he.e.isActivated("F0E9D1A9-2D93-4FEB-8870-CA6A2A2438B0","08/22/2022","Use the new item path field control handler for fetching paths for files or folders");function Xi(e,t){var n,a,i=t.itemKey,r=e.demandItemFacet(w.k,i),o=e.demandItemFacet(w.L,i),s=e.demandItemFacet(Ni.e,null==r?void 0:r.itemKey);if(o&&!Ji){var c=We.format(Bi.n,o);return s?{displayPathSegments:Zi("/".concat(c).concat(s.path)),openUrl:""}:r&&(u=e.demandItemFacet(w.u,null==r?void 0:r.itemKey))?{displayPathSegments:[c.concat(u)],openUrl:""}:{displayPathSegments:[c],openUrl:""}}var d=Object(Sn.e)(e),l=e.demandItemFacet(Pn.e,d);if(!Qi&&l)if(Object(Jn.o)(e,i)){var u;if(r&&(u=e.demandItemFacet(w.u,null==r?void 0:r.itemKey)))return{displayPathSegments:[u],openUrl:"",action:void 0}}else{var f=e.demandItemFacet(Y.e,i),p=null===(a=null===(n=null==f?void 0:f.owner)||void 0===n?void 0:n.user)||void 0===a?void 0:a.displayName;if(p)return{displayPathSegments:[We.format(Bi.t,p)],openUrl:"",action:void 0}}return{}}function Zi(e){for(var t=[],n=0,a=new x.e(e).segments.slice(1);n<a.length;n++){var i=a[n];t.push(i)}return t}var $i=Object(i.t)(function(){return function(e){e(Object(st.e)(O.e,Ri.e)(Xi)),e(Object(st.e)(Ni.e,Ri.e)(Xi))}}),er=Object(i.t)(function(){return function(e){e(Wt),e($i),e(Object(st.e)(vt.e,Hi.e)(Fi)),e(Object(st.e)(vt.e,si.e)(Fi)),e(Object(st.e)(vt.e,oi.e)(Di)),e(Object(st.e)(Ct.e,Ii.e)(Li)),e(Object(st.e)(Ct.e,Mi.e)(ki.recentContextMenuControlHandler)),e(Object(st.e)(Et,En.e)(Pi))}}),tr=n(4202),nr=n(457),ar=n(1213),ir=n(3891),rr=n(3789),or=n(3301),sr=!he.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","","");function cr(e,t){return{commands:Object(a.__spreadArray)(Object(a.__spreadArray)([or.e?xi.e:wi.e,Ci.n,Ci.t,ar.e],sr?[nr.e]:[],!0),[rr.e,ir.e,Oi.e],!1)}}var dr,lr=n(303),ur=((dr={})[Ue.a]=!0,dr[Ue.n]=!0,dr[Ue.s]=!0,dr[fe.c]=!0,dr[fe.e]=!0,dr[fe.o]=!0,dr);function fr(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,i=t.handler,r=i.columnKey,o=i.isAscending;if(!ur[r])return{};var s=e.demandItemFacet(d.e,n);if(!s)return{};var c=fe.a[r];if(!c)return{};var l=s.driveItemKey.endpoint,f=s.sortBy;return Object(u.a)(e,l)&&!f&&r===Ue.n&&o?{newItemSetKey:n}:{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},s),{sortBy:c,isAscending:o}))}}}}var pr,mr=n(606);function _r(e,t){var n=t.itemKey,i=e.demandItemFacet(d.e,n),r=i&&i.driveItemKey.endpoint,o=r&&i&&wn(0,{itemSetKey:d.e.serialize(i),parentItemKey:we.e.serialize({endpoint:r}),stageItem:t.stageItem});return Object(a.__assign)({},o?{stageItem:o}:{})}var hr=((pr={})[fe.c]=!0,pr[fe.e]=!0,pr);function br(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!hr[i])return{};var r=e.demandItemFacet(d.e,n);if(!r)return{};var o=fe.a[i];return o?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},r),{groupBy:o}))}:{}}function gr(e,t){var n=t.itemSetKey,i=e.demandItemFacet(d.e,n);return i?{newItemSetKey:d.e.serialize(Object(a.__assign)(Object(a.__assign)({},i),{groupBy:void 0}))}:{}}var vr=n(1499),yr=he.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),Sr=Object(li.i)({name:vr.t,key:fe.e,fieldName:"",minWidth:li.e.regularMin,maxWidth:li.e.regularMax,isCollapsable:!0,sortProps:li.t},fi.e)(function(e,t){var n=e.demandItemFacet(Y.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(pi.O,mi.e),r=!yr&&(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(_i.n)(new Date(a),r)}:{dateValue:a}}),Dr=n(862),Ir=new _.e("topCollaboratorSetKeyFacet",{endpoint:h.e}),xr=n(1818),Cr=n(521),Or=n(1787),wr=n(4493);Object(aa.n)([{rawString:".topCollaPlaceHolder_f0c2bf25{display:flex;min-width:13px;height:21px}[dir=ltr] .topCollaPlaceHolder_f0c2bf25{padding-right:10px}[dir=rtl] .topCollaPlaceHolder_f0c2bf25{padding-left:10px}.topCollaboratorIcon_f0c2bf25{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_f0c2bf25{font-weight:700}.topCollaboratorTooltip_f0c2bf25{padding:0 2px}.userWithTopCollaborator_f0c2bf25{display:flex}.userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{min-width:13px}[dir=ltr] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-right:7px}[dir=rtl] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-left:7px}[dir=ltr] .columnHeader_f0c2bf25{margin-left:20px}[dir=rtl] .columnHeader_f0c2bf25{margin-right:20px}"}]);var Er=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=ea.createElement(Cr.e,{className:"topCollaboratorIcon_f0c2bf25",iconName:"TeamFavorite"}),i=ea.createElement("span",{className:"topCollaboratorUserName_f0c2bf25"},t),r=ea.createElement("div",{className:"topCollaboratorTooltip_f0c2bf25"},We.formatToArray(wr.e,i));return ea.createElement("div",{className:"topCollaPlaceHolder_f0c2bf25"},n?null:t?ea.createElement(Or.e,{content:r},a):a)},t}(xr.e),Ar=Object(li.i)({name:vr.n,key:fe.c,fieldName:"",minWidth:li.e.regularMin,maxWidth:li.e.regularMax,isCollapsable:!0,sortProps:li.a,headerClassName:"columnHeader_f0c2bf25"},Dr.e)(function(e,t){var n,a=e.demandItem({shareByPerson:M},t).shareByPerson,i=e.demandItem({sharedBy:Y.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&P.e.matches(r)){var d=P.e.deserialize(r).email,l=e.demandItemFacet(m.e,Ir.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(L.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return ea.createElement("div",{className:"userWithTopCollaborator_f0c2bf25"},ea.createElement(Er,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(L.e,t))}),Lr=!he.e.isActivated("261491DC-B6D7-4FB8-85F3-EBAA7EA472B0","05/31/2022",'Enables the "Shared Date" column in ODC Shared with me');function kr(e,t){var n=t.itemSetKey,i=!1,r=e.demandItemFacet(d.e,n);if(r){var o=r.driveItemKey.endpoint;i=Object(u.a)(e,o)}return{columns:Object(a.__spreadArray)(Object(a.__spreadArray)([],i?Object(a.__spreadArray)([di.e,Wi.t],Lr?[Sr]:[],!0):[di.t,gi.e,Sr],!0),[Ar],!1)}}var Mr=new _.e("topCollaboratorItemKeyFacet",{id:h.e}),Pr=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(r){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,o,s,c,d,l,p,_,h,b,v,y,D,I,x,C;return Object(a.__generator)(this,function(O){switch(O.label){case 0:return n=new g.e({publisher:e}),o=r(Object(f.e)({graphEndpoint:S.y})).graphEndpoint,s=Ir.deserialize(i),c=o||s.endpoint,d="".concat(c,"/me/people/"),[4,r(Object(u.t)({url:d,qosName:"getTopCollaborator",endpoint:c}))];case 1:for(l=O.sent(),p=[],_=0,h=l.value;_<h.length;_++)b=h[_],v=b.id,y=b.displayName,D=b.userPrincipalName,I=Mr.serialize({id:v}),r(Object(et.e)({items:(x={},x[I]=Object(a.__assign)(Object(a.__assign)({},w.u.pack(y)),L.e.pack(D)),x)})),p.push(I);return n.resolveItems({items:(C={},C[t.itemKey]=Object(a.__assign)({},m.e.pack({itemKeys:p})),C)}),r(n.execute()),[2]}})})}});function Tr(e,t){return{isAvailable:!1}}function Ur(e,t){return{isAvailable:!1}}var Fr=Object(i.t)(function(){return function(e){e(at),e(Object(st.e)(we.e,Ii.e)(cr)),e(Object(st.e)(we.e,Mi.e)(tr.sharedWithMeContextMenuControlHandler)),e(Object(st.e)(d.e,lr.t)(fr)),e(Object(st.e)(d.e,En.e)(_r)),e(Object(st.e)(d.e,mr.e)(br)),e(Object(st.e)(d.e,mr.t)(gr)),e(Object(st.e)(d.e,oi.e)(kr)),e(Object(st.e)(je,En.e)(Tr)),e(Object(st.e)(ze,En.e)(Ur)),e(Object(s.a)(Ir,tt.e)(Pr))}}),Hr=n(1568),Rr=n(737),Nr=n(1216);function Br(e,t){var n=t.setItemKey,a=e.demandItemFacet(z.e,n);if(!n||!a)return{};var i=a.driveItemKey.endpoint,r=O.e.serialize(a.driveItemKey),o=e.demandItemFacet(Z.e,r),s=e.demandItemFacet(S.r,mi.e)||F.t,c=e.demandItemFacet(S.R,mi.e);return c&&c(i,o)?{totalItemCount:e.demandItemFacet(B.e,r),getPageKey:function(e,t){return Ln.serialize({setItemKey:n,endpoint:a.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:s}:{}}var jr=n(1199),Vr=he.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),zr=he.t.isActivated("52A76194-DB1E-4300-A64E-FB69963A684C","10/13/2022","Disable column header action since no action avaible"),Gr=Object(a.__assign)(Object(a.__assign)({},Ki.e),{columnActionsMode:ci.t.disabled}),Kr=zr?Ki.e:Gr,Wr=[di.e,Wi.e,ji.e,Gi.e,Kr],qr=[di.e,Wi.e,ji.e,jr.e,Gi.e,Kr],Qr=[di.e,Wi.e,ji.e,zi,Gi.e,Ki.e];function Yr(e,t){var n,a=t.itemSetKey;if(a){var i=Object(Nn.e)(e,{itemKey:a}),r=e.demandItemFacet(K.e,i);if("photo"===(null===(n=null==r?void 0:r.folder)||void 0===n?void 0:n.folderType))return{columns:Qr}}return!Vr&&e.demandItemFacet(S.a,mi.e)?{columns:Wr}:{columns:qr}}var Jr=n(26);function Xr(e,t){return n=z.e,{isAvailable:!0,sortHandler:function(e,t){var i=t.itemSetKey,r=t.handler,o=r.columnKey,s=r.isAscending,c=e.demandItemFacet(n,i);if(!c)return{};var d=O.e.serialize(Object(a.__assign)({},c.driveItemKey)),l=e.demandItemFacet(Z.e,d);if(!l||"business"===l||"documentLibrary"===l)return{};if(!c.sortBy){var u=e.demandItemFacet(m.s,d);if(rn.e&&u){if(o===(null==u?void 0:u.columnKey)&&(null==u?void 0:u.isAscending)===s)return{newItemSetKey:i}}else if(o===Wi.e.key&&!0===s)return{newItemSetKey:i}}var f=Object(Jr.e)(e,{customColumnKeysToFieldNamesConfiguration:S.n}).customColumnKeysToFieldNamesConfiguration,p=Object(a.__assign)(Object(a.__assign)({},fe.a),f),_=p?p[o]:void 0;return _?{newItemSetKey:n.serialize(Object(a.__assign)(Object(a.__assign)({},c),{sortBy:_,isAscending:s}))}:{}}};var n}var Zr=n(650);function $r(e,t){var n=Object(Zn.e)(e),a=e.demandItemFacet(Ct.e,n),i=e.demandItemFacet(we.e,n),r=e.demandItemFacet(it,n);return t.isMove?{isAvailable:!a&&!i&&!r}:{isAvailable:!a}}var eo=n(1635);function to(e,t){var n=t.itemKey;return e.demandItemFacet(W.e,n,{suppressGetItems:!0})?{renameDialogAs:no}:{}}function no(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?ea.createElement(t,Object(a.__assign)({},n),function(e){return ea.createElement(eo.e,Object(a.__assign)({},e))}):null}var ao=n(642),io=n(1566),ro=n(21),oo=n(580),so=n(3492),co={key:new k.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:te.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?ea.createElement(oo.e,{itemKey:n,action:Object(ro.i)(e,ea.createElement(so.e,{itemKey:n}))}):void 0}}},lo=n(3495),uo={key:new k.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,a=e.demandItem({openUrl:w.A,appMap:te.e},n),i=a.openUrl,r=a.appMap;return{action:i&&r?ea.createElement(oo.e,{itemKey:n,action:Object(ro.i)(e,ea.createElement(lo.e,{itemKey:n}))}):void 0}}};function fo(e,t){var n=t.handlers,i=void 0===n?[]:n,r=t.itemKey;return{isAvailable:!e.demandItemFacet(w.d,r),handlers:Object(a.__spreadArray)([io.e,co,uo],i,!0)}}var po=n(785),mo=n(1636),_o=n(769),ho=n(190),bo=n(239),go=n(932),vo=n(2011),yo=Object(Dn.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(a.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,r=e(Object(N.e)(function(e){return Object(vo.e)(e,{name:t})}))||{},o=r&&function(e,t){var n=t.queryType,i=t.layoutType,r=i&&function(e){return e===ho.e?go.e:e===bo.e?go.n:go.t}(i),o=function(e,t){return n=e,Object(a.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i}(e);return"number"==typeof n&&r&&(o[n]=r),o}(r,Object(a.__assign)({},n));e(Object(vo.n)({values:(i={},i[t]=o,i)}))}}),So=new k.e("defaultLayoutTypeMapConfiguration"),Do=new _.e("itemsScopeList",{driveId:h.e,itemsScopeItemKey:h.e});function Io(e,t){var n=Object(Jr.e)(e,{isLayoutResolvedEnabled:pi.x,isLocalStorageForLayoutEnabled:S.L,defaultLayoutTypeMapConfiguration:So}),i=n.isLayoutResolvedEnabled,r=n.isLocalStorageForLayoutEnabled,o=n.defaultLayoutTypeMapConfiguration;if(!i||!r)return{};var s,c,d,l,u=t.itemsScopeItemKey,f=Object(Sn.e)(e),p=e.demandItemFacet(z.e,f),m=void 0;if(f&&p&&u){var _=p.driveItemKey;if(_){var h=_.endpoint,b=_.driveId;if(!b||!h)return{};var g,v,y=Do.serialize({driveId:b,itemsScopeItemKey:u}),D=e.demandItemFacet(S.S,mi.e),I=D&&D(e,{itemSetKey:f}),x=I&&I.queryType||0;g="ItemsStore".concat((s={endpoint:h,driveId:b,queryType:x},c=s.endpoint,d=s.driveId,l="Graph.Files.FilesQueryType.".concat(c),d?"".concat(l,".").concat(d):l).toLocaleLowerCase());var C=Object(vo.e)(e,{name:g});m=Object(vo.t)(e,{name:g});var O=C&&C[x]||"";v=!O&&m&&o&&o[x]?o[x]:m?function(e){switch(e){case go.t:return ho.t;case go.e:return ho.e;default:return bo.e}}(O):void 0;var w=e.demandItemFacet(qe.c,y);return{preferredLayoutType:e.demandItemFacet(qe.s,y)||v,preferredLayoutVersion:w,setPreferredLayout:function(e){var t=e.layoutType;return function(n){var i,r;g&&b&&h&&n(yo({endpoint:h,driveId:b,itemsScopeItemKey:u,queryType:x,localStorageKey:g,layoutType:t})),n(Object(et.e)({items:(i={},i[y]=Object(a.__assign)({},qe.s.pack(e.layoutType)),i)})),n(Object(et.e)({items:(r={},r[y]=Object(a.__assign)({},qe.c.pack((w||0)+1)),r)}))}}}}}return{}}var xo=n(1243),Co=n(2010),Oo=new k.e("itemRestrictedSignal").id;function wo(e,t){var n=t.itemKey;if(e.demandItemFacet(pe.e,n)&&n){var i=Object(a.__spreadArray)([],t.signals||[],!0);return i.push(Eo),{signals:i}}return{}}var Eo={signal:ea.createElement(Co.t,null),title:J.e,key:Oo},Ao=n(591),Lo=n(422),ko=n(733),Mo=n(199),Po=n(270);Object(aa.n)([{rawString:".root_f578385e{display:inline-flex;position:relative;vertical-align:bottom;flex-direction:row;align-items:flex-end}.vaultCoverIsSmall_f578385e{width:72px;height:52px}.vaultCoverIsLarge_f578385e{width:112px;height:80px}.cover_f578385e{display:block;position:absolute;padding-bottom:12px;left:-3px;right:-3px;bottom:-4px}"}]);var To,Uo=n(448),Fo=Object(Uo.e)("/"),Ho="".concat(Fo,"office-ui-fabric-react-assets/foldericons"),Ro="".concat(Fo,"/assets/item-types/");!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(To||(To={}));var No,Bo,jo={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},Vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,r=t.vaultCoverType,o=void 0===r?"vaultclosed":r,s=(t.ref,t.children,t.isFluent),c=Object(a.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),d=jo[i][o];return"small"===i?e="vaultCoverIsSmall_f578385e":"large"===i&&(e="vaultCoverIsLarge_f578385e"),ea.createElement("div",Object(a.__assign)({},c,{className:"".concat("root_f578385e"," ").concat(e," ").concat(s?"isFluent":""),role:"none"}),ea.createElement(Cr.e,{"aria-hidden":!0,className:"ms-VaultCover ".concat("cover_f578385e"),iconName:d,role:"none"}))},t}(ea.Component);function zo(e,t){var n=t.itemKey,i=e.demandItemFacet($.e,n),r=e.demandItemFacet(q.e,n,{suppressGetItems:!0})||e.demandItemFacet(W.e,n,{suppressGetItems:!0});return Object(a.__assign)(Object(a.__assign)({},i&&i.root?{tileAs:Ko}:{}),{folderCoverControlHandler:function(t,n){var i={};r&&(i={folderCoverAs:Wo});var o=n.signalData;if(o&&o.signal)return i;var s=e.demandItem({specialFolder:ie.e},n.itemKey).specialFolder;if(!s)return i;var c=function(e){var t=null;return"desktop"===e?t=ea.createElement(Co.n,null):"documents"===e?t=ea.createElement(Co.a,null):"pictures"===e&&(t=ea.createElement(Co.l,null)),{signal:t,key:e||""}}(s);return c&&c.signal?Object(a.__assign)(Object(a.__assign)({},i),{signalData:c}):i}})}Bo={disableWarnings:!0},void 0===(No=he.e.isActivated("C242A965-ED0B-4653-9CCD-6FA000E87895","11/03/2022","Use getFabricAssetCdnUrl to get the CDN url instead of hardcoding it")?"https://res-1.cdn.office.net/files/fabric-cdn-prod_20211207.001/office-ui-fabric-react-assets/foldericons":Object(Uo.e)("/office-ui-fabric-react-assets/foldericons"))&&(No=Ho),Object(Po.r)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:ea.createElement("img",{src:"".concat(No,"/vault-sm.svg")}),vaultCoverSmallVaultOpen:ea.createElement("img",{src:"".concat(No,"/vault-sm-open.svg")})}},Bo),Object(Po.r)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:ea.createElement("img",{src:"".concat(No,"/vault-lg.svg")}),VaultCoverLargeVaultOpen:ea.createElement("img",{src:"".concat(No,"/vault-lg-open.svg")})}},Bo);var Go=Object(ta.t)(function(e,t){var n=t.itemKey,i=Object(a.__rest)(t,["itemKey"]),r=e.demandItemFacet($.e,n),o=r&&r.isLocked?To.vaultClosed:To.vaultOpen;return ea.createElement(Vo,Object(a.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),Ko=Object(ta.t)(function(e,t){var n=t.defaultRender,i=t.foreground,r=Object(a.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,s=i,c=e.demandItemFacet($.e,o);return c&&c.root&&(s=Object(Mo.a)(e,ea.createElement(Go,Object(a.__assign)({},r,{folderCoverSize:r.tileSize,itemKey:o})))),n?ea.createElement(n,Object(a.__assign)({},r,{foreground:s})):null});function Wo(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?ea.createElement(t,Object(a.__assign)({},n,{folderCoverType:"linked"})):null}var qo=n(931),Qo=n(169),Yo=n(333);Object(aa.n)([{rawString:".fileHandlerFileTypeIcon_86ad4959{width:inherit;height:inherit}"}]);var Jo=!he.e.isActivated("C8C7CD90-A7D5-45A9-9BBC-9041BF1AD06F","07/19/2022","Prevent Shared Folder icon from appearing at SWM/SBY roots");function Xo(e,t){var n=t.itemKey,a=e.demandItemFacet($.e,n);return a&&a.root?{iconAs:Zo}:{fileTypeIconAs:$o}}var Zo=Object(ta.t)(function(e,t){var n,i=t.itemKey,r=Object(a.__rest)(t,["itemKey"]),o=e.demandItemFacet($.e,i);if(o&&o.root){var s=e.demandItemFacet(w.u,i),c=o.isLocked?To.vaultClosed:To.vaultOpen,d={iconType:qo.e.Image,ariaLabel:s,imageProps:{src:(n=c,"".concat(Ro).concat("20").concat("","/").concat(n,".").concat("png")),imageFit:Qo.t.contain,className:"fileHandlerFileTypeIcon_86ad4959",role:"none"}};return ea.createElement(Cr.e,Object(a.__assign)({},r,d))}return null}),$o=Object(ta.t)(function(e,t){var n=t.defaultRender,i=Object(a.__rest)(t,["defaultRender"]),r=i.isFolder,o=i.itemKey,s=i.type,c=s;if(r&&void 0===s){var d=e.demandItemFacet(ie.e,o);void 0!==d&&("desktop"===d?c=Yo.e.desktopFolder:"documents"===d?c=Yo.e.documentsFolder:"pictures"===d&&(c=Yo.e.picturesFolder))}else if(Jo&&r&&s===Yo.e.sharedFolder){var l=Object(Zn.e)(e),u=e.demandItemFacet(we.e,l),f=e.demandItemFacet(it,l);(u||f)&&(c=Yo.e.folder)}return n?ea.createElement(n,Object(a.__assign)({},i,{type:c})):null}),es=n(1477),ts=n(1564),ns=n(652),as=n(98),is=n(3423),rs=new k.e("enableSyncConfigurationFacet"),os=new as.e;function ss(e,t){var n=function(e,t){var n=t.itemKey,a=t.platformDetection;if(!a.isWindows)return{syncState:"noSyncNotAllowedInExperience"};if(a.isMobile)return{syncState:"noSyncMobileDevice"};var i=e.demandItemFacet(O.e,n);return i?e.demandItemFacet(L.e,is.e.serialize(i))?{syncState:"syncNextGen"}:{syncState:"noSyncNotAllowedInExperience"}:{syncState:"noSyncItemIsNotLoaded"}}(e,{itemKey:t.itemKey,platformDetection:os}).syncState;if("syncNextGen"!==n)return{syncState:n};var a=Object(Jr.e)(e,{enableSync:rs}).enableSync;return{isAvailable:!!a&&a(),syncState:n,protocolCallback:function(e){window.location.href=e}}}var cs=n(1474),ds=Object(i.t)(function(){return function(e){e(Object(st.e)(O.e,ns.e)(ss)),e(Object(st.e)(O.e,cs.e)(e(Object(ni.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(14).then(n.bind(null,5090))];case 1:return[2,e.sent().driveItemSyncDialogControlHandler]}})})}))))}}),ls=n(538),us=n(137),fs=Object(us.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(494).then(n.bind(null,5227))];case 1:return[2,e.sent().EmptyFolderTitle]}})})});function ps(e,t){var n=t.itemKey,a=t.emptyFolderTitle,i=(e.demandItemFacet(z.e,n)||{}).driveItemKey,r=i&&O.e.serialize(i),o=e.demandItemFacet(ie.e,r);return o&&"documents"===o?{emptyFolderTitle:Object(Mo.a)(e,ea.createElement(fs,{titleFallback:a}))}:{}}var ms=Object(i.t)(function(){return function(e){e(ya),e(Object(st.e)(z.e,oi.e)(Yr)),e(Object(st.e)(z.e,xo.e)(e(Object(ni.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(12).then(n.bind(null,4983))];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})))),e(Object(st.e)(z.e,lr.t)(Xr)),e(Object(st.e)(O.e,Ao.e)(wo)),e(Object(st.e)(O.e,Rr.e)(Hr.e)),e(Object(st.e)(z.e,Nr.e)(Br)),ts.e||e(Object(st.e)(O.e,es.e)(to)),e(Object(st.e)(O.e,Zr.e)($r)),e(Object(st.e)(O.e,Lo.e)(Xo)),e(Object(st.e)(O.e,ko.e)(zo)),e(Object(st.e)(O.e,ao.e)(fo)),e(Object(st.e)(O.e,po.e)(mo.e)),e(Object(st.e)(z.e,_o.e)(Io)),e(ds),e(Object(st.e)(z.e,ls.e)(ps))}}),_s=new _.e("specialDriveItem",{endpoint:h.e,driveId:h.t,name:h.e}),hs=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=_s.deserialize(i),o=r.driveId,s=r.endpoint,c=Object(l.n)(r);return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,d,f,p,_,h,b,v,y;return Object(a.__generator)(this,function(S){switch(S.label){case 0:return[4,t(Object(u.t)({url:Object(l.i)(r),driveUrl:c,driveId:o,qosName:"getItem",endpoint:s}))];case 1:return n=S.sent(),d=new g.e({publisher:e}),f=n&&n.parentReference,p=f&&f.driveId,_={endpoint:s,driveId:p||o,itemId:n.id},h=O.e.serialize(_),b=f&&f.id?O.e.serialize({endpoint:s,driveId:p,itemId:f.id}):void 0,d.merge(t(Object(C.e)({itemKey:h,driveItem:n,endpoint:s,parentFolderItemKey:b})).itemResolver),d.resolveItems({items:(v={},v[h]=Object(a.__assign)(Object(a.__assign)({},Za.n.pack(O.e)),m.t.pack({itemKey:z.e.serialize({driveItemKey:_,sortBy:"",isAscending:!0})})),v)}),d.mapKeys({mappings:(y={},y[h]=i,y)}),t(d.execute()),[2]}})})}});function bs(e,t){var n=t.itemsScopeItemKey,i=t.engagement,r=t.itemKey,o=i&&i.name,s=e.demandItemFacet(_s,r);return{engagement:Object(a.__assign)(Object(a.__assign)({},(null==i?void 0:i.datasource)?{}:{datasource:"Graph"}),{objectType:"Folder",extraData:Object(a.__assign)({itemGraphId:null==s?void 0:s.driveId,specialGraphName:null==s?void 0:s.name},"ItemsView.Load"===o?Object(lt.e)(e,{itemsScopeItemKey:n}):{})})}}var gs=Object(i.t)(function(){return function(e){e(Object(st.e)(_s,ct.e)(bs))}}),vs=Object(i.t)(function(){return function(e){e(Object(s.a)(_s,tt.e)(hs)),e(gs)}}),ys=Object(i.t)(function(){return function(e){e(vs),e(Object(st.e)(_s,Lo.e)(Xo)),e(Object(st.e)(_s,ko.e)(zo))}}),Ss=n(3306),Ds=n(490),Is=n(3419),xs=Object(i.i)()(function e(t){var n=this,i=t.itemKey,r=Ss.e.deserialize(i),o=r.endpoint,s=r.driveId;return function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,c,d,u;return Object(a.__generator)(this,function(f){switch(f.label){case 0:return n=Object(l.n)({endpoint:o,driveId:s}),[4,t(Object(Ds.getSessionToken)({endpoint:o,driveUrl:n}))];case 1:return r=f.sent(),c=r&&r.accessToken,(d=new g.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(a.__assign)({},Is.e.pack(c)),u)}),t(d.execute()),[2]}})})}}),Cs=n(3536),Os=n(3788),ws=Object(i.t)(function(){return function(e){e(Object(s.a)(Ss.e,tt.e)(xs)),Object(Os.e)()||e(Object(s.a)(Cs.e,tt.e)(Object(i.a)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(19).then(n.bind(null,4984))];case 1:return[2,e.sent().itemThumbnailGetItemsOperationHandler]}})})})))}}),Es=n(653),As=n(251),Ls=!he.e.isActivated("6E019929-F335-47E2-9308-911B40E188A3","06/13/2022","Disable picker move/copy command for vault"),ks=As.n.isFeatureEnabled({ODC:"UseItemsScopeVroomMoveCopy"});function Ms(e,t){var n=e.demandItemFacet(be.e,mi.e);if((null==n?void 0:n.isUserMigrated)&&!ks)return{isAvailable:!1};for(var a=0,i=t.sourceItemKeys;a<i.length;a++){var r=i[a],o=e.demandItemFacet(O.e,r);if(!o)return{};var s=o.itemId;if((void 0===s?F.a:s)===F.a)return{};if(Ls){var c=e.demandItemFacet($.e,r);if(null==c?void 0:c.root)return{isAvailable:!1}}if(t.isMove&&!e.demandItemFacet(Jn.t,r))return{};if(e.demandItemFacet(W.e,r))return{}}var d=Object(Zn.e)(e),l=e.demandItemFacet(Ct.e,d),u=e.demandItemFacet(we.e,d),f=e.demandItemFacet(it,d);return t.isMove?{isAvailable:!l&&!u&&!f}:{isAvailable:!l}}var Ps=n(3959),Ts=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(Object(st.e)(O.e,Ps.e)(e(Object(ni.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e(25).then(n.bind(null,5096))];case 1:return[2,e.sent().driveItemMoveCopyProgressControlHandler]}})})})))),[2]})})}}),Us=Object(i.t)(function(){return function(e){e(Ts),e(Object(st.e)(O.e,Es.e)(Ms))}}),Fs=Object(i.t)(function(){return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return e(ti),e(ms),e(ws),e(ri),e(er),e(Fr),e(ys),e(Us),[2]})})}})}}]);